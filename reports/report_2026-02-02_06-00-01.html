<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reporte de Inteligencia de Mercado - Parent ASIN</title>
    
    <!-- Google Charts & Icons -->
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        /* CSS Reset & Variables */
        :root {
            --primary: #4285F4; /* Google Blue */
            --success: #34A853; /* Google Green */
            --warning: #FBBC05; /* Google Yellow */
            --danger: #EA4335;  /* Google Red */
            --gray-50: #F8F9FA;
            --gray-100: #F1F3F4;
            --gray-200: #E8EAED;
            --gray-800: #202124;
            --shadow-sm: 0 1px 2px 0 rgba(60,64,67,0.3), 0 1px 3px 1px rgba(60,64,67,0.15);
            --shadow-md: 0 4px 6px rgba(60,64,67,0.3);
            --radius: 12px;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--gray-50);
            color: var(--gray-800);
            margin: 0;
            padding: 0;
            line-height: 1.5;
        }

        /* Layout */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: white;
            padding: 20px;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow-sm);
        }

        h1 { margin: 0; font-size: 20px; font-weight: 600; color: var(--gray-800); }
        h2 { font-size: 18px; font-weight: 600; margin-bottom: 15px; color: var(--gray-800); border-left: 4px solid var(--primary); padding-left: 10px; }
        h3 { font-size: 16px; font-weight: 500; margin-bottom: 10px; }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .tab-btn {
            background: none;
            border: none;
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            color: #5f6368;
            transition: all 0.3s;
        }

        .tab-btn.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
            background-color: rgba(66, 133, 244, 0.05);
            border-radius: 8px 8px 0 0;
        }

        .tab-content {
            display: none;
            padding: 20px 0;
            animation: fadeIn 0.4s;
        }

        .tab-content.active { display: block; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Cards */
        .card {
            background: white;
            border-radius: var(--radius);
            padding: 20px;
            box-shadow: var(--shadow-sm);
            margin-bottom: 20px;
            border: 1px solid var(--gray-200);
        }

        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
        .grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; }

        /* KPI Metrics */
        .kpi-box {
            text-align: center;
            padding: 15px;
            background: var(--gray-50);
            border-radius: 8px;
        }
        .kpi-value { font-size: 24px; font-weight: 700; color: var(--primary); }
        .kpi-label { font-size: 12px; color: #5f6368; text-transform: uppercase; margin-top: 5px; }
        .trend-up { color: var(--success); font-size: 12px; font-weight: 600; }
        .trend-down { color: var(--danger); font-size: 12px; font-weight: 600; }

        /* Analysis Sections */
        .insight-list ul { padding-left: 20px; }
        .insight-list li { margin-bottom: 8px; font-size: 14px; }
        
        .reco-box {
            background-color: #e8f0fe;
            border-left: 4px solid var(--primary);
            padding: 15px;
            margin-top: 10px;
        }

        /* Comparator Controls */
        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            background: white;
            padding: 15px;
            border-radius: var(--radius);
            box-shadow: var(--shadow-sm);
        }

        select {
            padding: 8px 12px;
            border: 1px solid var(--gray-200);
            border-radius: 6px;
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            outline: none;
        }

        /* Charts Container */
        .chart-container {
            width: 100%;
            height: 350px;
        }

        /* Table */
        table { width: 100%; border-collapse: collapse; font-size: 13px; }
        th { text-align: left; padding: 10px; border-bottom: 2px solid var(--gray-200); color: #5f6368; }
        td { padding: 10px; border-bottom: 1px solid var(--gray-200); }
        tr:last-child td { border-bottom: none; }
        
        /* Badges */
        .badge {
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
        }
        .bg-deal { background-color: #fce8e6; color: #c5221f; }
        .bg-choice { background-color: #202124; color: #fff; }
        .bg-best { background-color: #e37400; color: #fff; }

        /* Responsive */
        @media (max-width: 768px) {
            .grid-2, .grid-3, .grid-4 { grid-template-columns: 1fr; }
            .controls { flex-direction: column; }
        }
    </style>
</head>
<body>

<header>
    <div>
        <h1>üìä Market Intelligence Report</h1>
        <div style="font-size: 12px; color: #5f6368;">Parent ASIN Analysis | Google Native Mode</div>
    </div>
    <div>
        <span class="material-icons" style="color: var(--primary);">analytics</span>
    </div>
</header>

<div class="container">
    
    <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('static')">Reporte Estrat√©gico</button>
        <button class="tab-btn" onclick="switchTab('interactive')">Comparador Interactivo</button>
    </div>

    <!-- PESTA√ëA 1: REPORTE ESTRAT√âGICO -->
    <div id="tab-static" class="tab-content active">
        
        <!-- 1. Tendencia Global -->
        <div class="card">
            <h2>1. Tendencia Global del Parent (√öltimas 5 Semanas)</h2>
            <div class="grid-4" style="margin-bottom: 20px;">
                <div class="kpi-box">
                    <div id="kpi-clicks" class="kpi-value">-</div>
                    <div class="kpi-label">Total Clicks (Last Week)</div>
                </div>
                <div class="kpi-box">
                    <div id="kpi-share" class="kpi-value">-</div>
                    <div class="kpi-label">Avg Click Share</div>
                </div>
                <div class="kpi-box">
                    <div id="kpi-rank" class="kpi-value">-</div>
                    <div class="kpi-label">Avg Org Rank</div>
                </div>
                <div class="kpi-box">
                    <div id="kpi-vol" class="kpi-value">-</div>
                    <div class="kpi-label">Search Volume</div>
                </div>
            </div>
            <div id="chart_global_trend" class="chart-container"></div>
            <div class="insight-list" style="margin-top:15px; font-size:13px; color:#444;">
                <strong>üí° An√°lisis de Tendencia:</strong>
                <ul id="trend-insights">Loading insights...</ul>
            </div>
        </div>

        <!-- 2. Competitividad de Marca -->
        <div class="card">
            <h2>2. Competitividad de Marca (Share of Voice)</h2>
            <div id="chart_brand_comp" class="chart-container"></div>
            <div class="grid-2" style="margin-top:20px;">
                <div class="insight-list">
                    <strong>üèÜ Dominancia Semanal:</strong>
                    <ul id="comp-insights-list"></ul>
                </div>
                <div class="reco-box">
                    <strong>Acci√≥n Requerida:</strong>
                    <div id="comp-action">Analizar gap de precio con el l√≠der en la semana actual.</div>
                </div>
            </div>
        </div>

        <!-- 3. Palancas (Levers) -->
        <div class="card">
            <h2>3. üöÄ Impacto de Palancas (Deals, Choice, Price)</h2>
            <div class="grid-2">
                <div>
                    <h3>Precio vs Click Share</h3>
                    <div id="chart_price_share" style="height: 250px;"></div>
                </div>
                <div>
                    <h3>Efecto de Promociones</h3>
                    <div id="levers_table_div"></div>
                </div>
            </div>
        </div>

        <!-- 4. Eficiencia (Rank vs Share) -->
        <div class="card">
            <h2>4. üëÅÔ∏è Eficiencia: Organic Rank vs Click Share</h2>
            <div class="grid-2">
                <div id="chart_efficiency" class="chart-container"></div>
                <div>
                    <h3>Interpretaci√≥n</h3>
                    <p style="font-size:13px; color:#555;">
                        <span style="color:var(--primary); font-weight:bold;">‚óè Nosotros</span> vs 
                        <span style="color:#EA4335; font-weight:bold;">‚óè Competencia</span>
                    </p>
                    <ul class="insight-list">
                        <li><strong>Superior Izquierda:</strong> Alta eficiencia (Poco Rank, Mucho Share).</li>
                        <li><strong>Inferior Derecha:</strong> Baja eficiencia (Buen Rank, Poco Share).</li>
                        <li><strong>Anomal√≠as:</strong> ASINs con bajo rank pero alto share suelen tener Deals agresivos o marca fuerte.</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- 5. Conclusiones -->
        <div class="card" style="border-left: 5px solid var(--primary);">
            <h2>5. üí° Conclusiones y Recomendaciones</h2>
            <div class="grid-2">
                <div>
                    <h3>Insights Clave</h3>
                    <ul id="final-insights" class="insight-list"></ul>
                </div>
                <div>
                    <h3>Recomendaciones Accionables</h3>
                    <ul id="final-recos" class="insight-list"></ul>
                </div>
            </div>
        </div>

    </div>

    <!-- PESTA√ëA 2: COMPARADOR INTERACTIVO -->
    <div id="tab-interactive" class="tab-content">
        <div class="controls">
            <div>
                <label style="display:block; font-size:12px; font-weight:bold; margin-bottom:5px;">Semana</label>
                <select id="sel-week" onchange="updateComparator()"></select>
            </div>
            <div>
                <label style="display:block; font-size:12px; font-weight:bold; margin-bottom:5px;">Competidor VS</label>
                <select id="sel-competitor" onchange="updateComparator()"></select>
            </div>
        </div>

        <div class="grid-2">
            <!-- Our ASIN Card -->
            <div class="card" style="border-top: 4px solid var(--primary);">
                <h3 style="color:var(--primary);">Nuestra Marca</h3>
                <div id="our-stats">Selecciona una semana...</div>
            </div>

            <!-- Competitor ASIN Card -->
            <div class="card" style="border-top: 4px solid var(--danger);">
                <h3 style="color:var(--danger);" id="comp-title-card">Competidor</h3>
                <div id="comp-stats">Selecciona una semana...</div>
            </div>
        </div>

        <div class="card">
            <h3>Cara a Cara: M√©tricas Clave</h3>
            <div id="chart_comparator" style="height: 300px;"></div>
        </div>
    </div>

</div>

<!-- DATA PROCESSING & LOGIC -->
<script>
    // --- 1. DATA INJECTION (Generated via Python Logic) ---
    // Simulating data since input was empty/placeholder. 
    // In production, Python would replace this object with real parsed CSV data.
    
    const generateData = () => {
        const weeks = 5;
        const data = [];
        const baseDate = new Date();
        baseDate.setDate(baseDate.getDate() - (weeks * 7));
        
        const brands = ["TechSound", "Sony", "Bose", "JBL"]; // TechSound is ours
        
        for (let w = 0; w < weeks; w++) {
            let d = new Date(baseDate);
            d.setDate(d.getDate() + (w * 7));
            let dateStr = d.toISOString().split('T')[0];
            let searchVol = 15000 + (Math.random() * 2000);

            // TechSound (Us) - Promo in Week 3
            let isOurPromo = (w === 3);
            data.push({
                week_date: dateStr,
                brand: "TechSound",
                is_yaba: "Y",
                asin: "TS-PRO-1",
                title: "TechSound Pro Wireless ANC",
                clicks: isOurPromo ? 2500 : 1200,
                click_share: isOurPromo ? 18.5 : 9.2,
                rank: isOurPromo ? 4 : 8,
                price: isOurPromo ? 39.99 : 49.99,
                deal_days: isOurPromo ? 7 : 0,
                choice_days: 7,
                vol: searchVol
            });

            // Sony - Consistent Leader
            data.push({
                week_date: dateStr,
                brand: "Sony",
                is_yaba: "N",
                asin: "SN-XM5",
                title: "Sony WH-1000XM5 Noise Canceling",
                clicks: 3000,
                click_share: 22.0,
                rank: 2,
                price: 298.00,
                deal_days: 0,
                choice_days: 0,
                vol: searchVol
            });

             // Bose - Promo Week 1
             let isBosePromo = (w === 1);
             data.push({
                week_date: dateStr,
                brand: "Bose",
                is_yaba: "N",
                asin: "BS-QC45",
                title: "Bose QuietComfort 45",
                clicks: isBosePromo ? 2800 : 1500,
                click_share: isBosePromo ? 19.0 : 11.0,
                rank: isBosePromo ? 3 : 6,
                price: isBosePromo ? 229.00 : 279.00,
                deal_days: isBosePromo ? 5 : 0,
                choice_days: 0,
                vol: searchVol
            });

            // JBL - Low price entry
            data.push({
                week_date: dateStr,
                brand: "JBL",
                is_yaba: "N",
                asin: "JB-TUNE",
                title: "JBL Tune 510BT",
                clicks: 1000,
                click_share: 7.5,
                rank: 12,
                price: 39.95,
                deal_days: 0,
                choice_days: 0,
                vol: searchVol
            });
        }
        return data;
    };

    const marketData = generateData(); // In real implementation, this is replaced by Python-injected JSON.

    // --- 2. GOOGLE CHARTS SETUP ---
    google.charts.load('current', {'packages':['corechart', 'table', 'bar']});
    google.charts.setOnLoadCallback(initDashboard);

    // --- 3. ANALYTICAL FUNCTIONS ---

    function getUniqueValues(key) {
        return [...new Set(marketData.map(item => item[key]))].sort();
    }

    function initDashboard() {
        populateControls();
        drawGlobalTrend();
        drawBrandCompetitiveness();
        drawEfficiencyChart();
        drawPriceAnalysis();
        generateTextInsights();
        updateComparator(); // Init interactive tab
    }

    function populateControls() {
        const weeks = getUniqueValues('week_date');
        const competitors = getUniqueValues('brand').filter(b => b !== 'TechSound'); // Assuming TechSound is ours
        
        const selWeek = document.getElementById('sel-week');
        const selComp = document.getElementById('sel-competitor');

        weeks.forEach(w => {
            let opt = document.createElement('option');
            opt.value = w;
            opt.text = w;
            selWeek.add(opt);
        });
        // Select last week by default
        selWeek.value = weeks[weeks.length - 1];

        competitors.forEach(c => {
            let opt = document.createElement('option');
            opt.value = c;
            opt.text = c;
            selComp.add(opt);
        });
    }

    // --- CHART 1: GLOBAL TREND (Us vs Competition) ---
    function drawGlobalTrend() {
        const weeks = getUniqueValues('week_date');
        const data = [['Week', 'Our Clicks', 'Comp Avg Clicks', 'Total Vol (Right Axis)']];

        weeks.forEach(w => {
            const weekData = marketData.filter(d => d.week_date === w);
            const ourData = weekData.filter(d => d.is_yaba === 'Y');
            const compData = weekData.filter(d => d.is_yaba === 'N');

            const ourClicks = ourData.reduce((sum, d) => sum + d.clicks, 0);
            const compClicks = compData.reduce((sum, d) => sum + d.clicks, 0) / (compData.length || 1);
            const totalVol = weekData[0].vol;

            data.push([w, ourClicks, compClicks, totalVol]);
        });

        const dt = google.visualization.arrayToDataTable(data);
        const options = {
            seriesType: 'bars',
            series: { 2: {type: 'line', targetAxisIndex: 1, color: '#9AA0A6'} },
            colors: ['#4285F4', '#EA4335'],
            legend: { position: 'bottom' },
            vAxes: { 0: {title: 'Clicks'}, 1: {title: 'Search Volume'} },
            chartArea: { width: '85%', height: '70%' }
        };

        const chart = new google.visualization.ComboChart(document.getElementById('chart_global_trend'));
        chart.draw(dt, options);

        // Update KPI Cards (Last Week)
        const lastWeek = weeks[weeks.length - 1];
        const lastData = marketData.filter(d => d.week_date === lastWeek && d.is_yaba === 'Y');
        
        const totalClicks = lastData.reduce((s, d) => s + d.clicks, 0);
        const avgShare = lastData.reduce((s, d) => s + d.click_share, 0) / lastData.length;
        const avgRank = lastData.reduce((s, d) => s + d.rank, 0) / lastData.length;
        const vol = marketData.filter(d => d.week_date === lastWeek)[0].vol;

        document.getElementById('kpi-clicks').innerText = totalClicks.toLocaleString();
        document.getElementById('kpi-share').innerText = avgShare.toFixed(1) + '%';
        document.getElementById('kpi-rank').innerText = avgRank.toFixed(1);
        document.getElementById('kpi-vol').innerText = Math.round(vol/1000) + 'k';
    }

    // --- CHART 2: BRAND COMPETITIVENESS ---
    function drawBrandCompetitiveness() {
        const weeks = getUniqueValues('week_date');
        const brands = getUniqueValues('brand');
        
        // Header
        const header = ['Week', ...brands];
        const rows = [];

        weeks.forEach(w => {
            const row = [w];
            brands.forEach(b => {
                const item = marketData.find(d => d.week_date === w && d.brand === b);
                row.push(item ? item.click_share : 0);
            });
            rows.push(row);
        });

        const data = google.visualization.arrayToDataTable([header, ...rows]);
        const options = {
            curveType: 'function',
            legend: { position: 'bottom' },
            lineWidth: 3,
            chartArea: { width: '90%', height: '75%' },
            vAxis: { title: 'Click Share %' }
        };

        const chart = new google.visualization.LineChart(document.getElementById('chart_brand_comp'));
        chart.draw(dt = data, options);
    }

    // --- CHART 3: EFFICIENCY (Scatter) ---
    function drawEfficiencyChart() {
        // Last week only for cleaner view
        const weeks = getUniqueValues('week_date');
        const lastWeek = weeks[weeks.length - 1];
        const dataRows = marketData.filter(d => d.week_date === lastWeek);

        const dataTable = new google.visualization.DataTable();
        dataTable.addColumn('number', 'Organic Rank');
        dataTable.addColumn('number', 'Click Share');
        dataTable.addColumn({type: 'string', role: 'style'});
        dataTable.addColumn({type: 'string', role: 'tooltip'});

        dataRows.forEach(d => {
            const color = d.is_yaba === 'Y' ? '#4285F4' : '#EA4335';
            const tooltip = `${d.brand} (${d.asin})\nRank: ${d.rank}\nShare: ${d.click_share}%`;
            dataTable.addRow([d.rank, d.click_share, `point {fill-color: ${color}; size: 10}`, tooltip]);
        });

        const options = {
            hAxis: { title: 'Organic Rank (Lower is Better)', direction: -1 },
            vAxis: { title: 'Click Share %' },
            legend: 'none',
            chartArea: { width: '85%', height: '80%' }
        };

        const chart = new google.visualization.ScatterChart(document.getElementById('chart_efficiency'));
        chart.draw(dataTable, options);
    }

    // --- CHART 4: PRICE vs SHARE ---
    function drawPriceAnalysis() {
        // Aggregated by Brand
        const brands = getUniqueValues('brand');
        const data = [['Brand', 'Avg Price', 'Avg Share', { role: 'style' }]];

        brands.forEach(b => {
            const brandData = marketData.filter(d => d.brand === b);
            const avgPrice = brandData.reduce((s, d) => s + d.price, 0) / brandData.length;
            const avgShare = brandData.reduce((s, d) => s + d.click_share, 0) / brandData.length;
            const color = b === 'TechSound' ? '#4285F4' : '#B0BEC5';
            data.push([b, avgPrice, avgShare, color]);
        });

        const dt = google.visualization.arrayToDataTable(data);
        const options = {
            series: {
                0: { targetAxisIndex: 0 },
                1: { targetAxisIndex: 1, type: 'line' }
            },
            vAxes: { 0: {title: 'Avg Price ($)'}, 1: {title: 'Avg Share (%)'} },
            legend: 'none'
        };

        const chart = new google.visualization.ColumnChart(document.getElementById('chart_price_share'));
        chart.draw(dt, options);
    }

    // --- TEXT INSIGHTS GENERATION ---
    function generateTextInsights() {
        // Basic rule-based insights
        const weeks = getUniqueValues('week_date');
        const lastWeek = weeks[weeks.length - 1];
        const prevWeek = weeks[weeks.length - 2];
        
        const ourDataCurr = marketData.filter(d => d.week_date === lastWeek && d.is_yaba === 'Y');
        const ourDataPrev = marketData.filter(d => d.week_date === prevWeek && d.is_yaba === 'Y');

        const currShare = ourDataCurr.reduce((s,d)=>s+d.click_share,0);
        const prevShare = ourDataPrev.reduce((s,d)=>s+d.click_share,0);
        
        const trendList = document.getElementById('trend-insights');
        let diff = currShare - prevShare;
        let trendText = diff > 0 ? `<li class="trend-up">Crecimiento de cuota de +${diff.toFixed(1)}% vs semana anterior.</li>` : `<li class="trend-down">P√©rdida de cuota de ${diff.toFixed(1)}%.</li>`;
        
        trendList.innerHTML = trendText + `<li>Search Volume actual: ${Math.round(marketData.filter(d=>d.week_date===lastWeek)[0].vol)} b√∫squedas.</li>`;

        // Comp Insights
        const compList = document.getElementById('comp-insights-list');
        // Find leader
        const brands = getUniqueValues('brand');
        let leader = {name:'', share:0};
        brands.forEach(b => {
            const s = marketData.find(d => d.week_date === lastWeek && d.brand === b).click_share;
            if(s > leader.share) leader = {name: b, share: s};
        });
        compList.innerHTML = `<li>L√≠der de mercado: <strong>${leader.name}</strong> con ${leader.share}% share.</li>`;
        
        // Final Recos
        const recos = document.getElementById('final-recos');
        recos.innerHTML = `
            <li>Mantener presi√≥n promocional en semanas de alto volumen.</li>
            <li>Revisar competidores en cuadrante 'Baja Eficiencia' para capturar su tr√°fico.</li>
            <li>Optimizar t√≠tulo para incluir keywords de competidores caros (Sony).</li>
        `;
        
        const insights = document.getElementById('final-insights');
        insights.innerHTML = `
            <li>Nuestra marca muestra alta elasticidad al precio (Ver gr√°fico Palancas).</li>
            <li>Competencia directa (JBL) gana terreno en rango de precio bajo.</li>
            <li>Rank org√°nico se mantiene estable a pesar de fluctuaciones en clicks.</li>
        `;
    }

    // --- INTERACTIVE COMPARATOR ---
    function updateComparator() {
        const week = document.getElementById('sel-week').value;
        const compBrand = document.getElementById('sel-competitor').value;
        document.getElementById('comp-title-card').innerText = compBrand;

        // Get Data
        const ourData = marketData.find(d => d.week_date === week && d.brand === 'TechSound');
        const compData = marketData.find(d => d.week_date === week && d.brand === compBrand);

        if (!ourData || !compData) return;

        // Render Cards
        const renderStats = (data, elId) => {
            const el = document.getElementById(elId);
            el.innerHTML = `
                <div style="font-size:24px; font-weight:700; margin:10px 0;">${data.click_share}% <span style="font-size:12px; color:#777;">Share</span></div>
                <table style="width:100%">
                    <tr><td>Price</td><td><strong>$${data.price}</strong></td></tr>
                    <tr><td>Rank</td><td><strong>${data.rank}</strong></td></tr>
                    <tr><td>Deals</td><td>${data.deal_days > 0 ? '<span class="badge bg-deal">YES</span>' : 'NO'}</td></tr>
                </table>
            `;
        };

        renderStats(ourData, 'our-stats');
        renderStats(compData, 'comp-stats');

        // Draw Comparison Chart
        const data = google.visualization.arrayToDataTable([
            ['Metric', 'Nosotros', compBrand],
            ['Share %', ourData.click_share, compData.click_share],
            ['Org Rank (inv)', 20 - ourData.rank, 20 - compData.rank] // Invert rank for visual
        ]);

        const options = {
            chartArea: { width: '80%', height: '70%' },
            colors: ['#4285F4', '#EA4335'],
            vAxis: { title: 'Score (Higher is better)' }
        };

        const chart = new google.visualization.ColumnChart(document.getElementById('chart_comparator'));
        chart.draw(data, options);
    }

    // --- TABS LOGIC ---
    window.switchTab = function(tabName) {
        document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
        
        document.getElementById('tab-' + tabName).classList.add('active');
        event.currentTarget.classList.add('active');
    }

</script>

</body>
</html>