<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASIN Performance Report</title>
    <!-- Google Fonts & Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Google Charts -->
    <script src="https://www.gstatic.com/charts/loader.js"></script>

    <style>
        :root {
            --primary-color: #4285F4; /* Google Blue */
            --secondary-color: #34A853; /* Google Green */
            --danger-color: #EA4335; /* Google Red */
            --warning-color: #FBBC05; /* Google Yellow */
            --text-color: #333;
            --bg-color: #f5f6f8;
            --card-bg: #ffffff;
            --gray-border: #e0e0e0;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: 20px;
            color: var(--text-color);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Header */
        header {
            background-color: var(--card-bg);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        header h1 {
            margin: 0;
            font-size: 24px;
            color: var(--primary-color);
        }

        .badge {
            background: #e8f0fe;
            color: var(--primary-color);
            padding: 5px 10px;
            border-radius: 16px;
            font-size: 14px;
            font-weight: 500;
        }

        /* Tabs */
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--gray-border);
        }

        .tab-btn {
            padding: 10px 20px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 16px;
            font-weight: 500;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .tab-btn.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }

        /* Sections */
        .section {
            display: none;
        }
        .section.active {
            display: block;
        }

        /* Cards */
        .card {
            background: var(--card-bg);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .card h2 {
            margin-top: 0;
            font-size: 18px;
            color: #444;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Grid Layouts */
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .grid-3 {
             display: grid;
             grid-template-columns: repeat(3, 1fr);
             gap: 20px;
        }

        @media (max-width: 768px) {
            .grid-2, .grid-3 { grid-template-columns: 1fr; }
        }

        /* Metrics */
        .metric-box {
            text-align: center;
            padding: 15px;
            background: #fafafa;
            border-radius: 8px;
        }
        .metric-val {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-color);
        }
        .metric-label {
            font-size: 12px;
            color: #666;
        }

        /* Insight Lists */
        ul.insights {
            list-style: none;
            padding: 0;
        }
        ul.insights li {
            padding: 10px 0;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: start;
            gap: 10px;
        }
        ul.insights li .material-icons {
            font-size: 20px;
            color: var(--secondary-color);
            margin-top: 2px;
        }
        
        /* Interactive Controls */
        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            background: #fff;
            padding: 15px;
            border-radius: 8px;
        }
        
        select {
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #ddd;
            font-family: inherit;
        }

        .chart-container {
            min-height: 350px;
        }

    </style>
</head>
<body>

<div class="container">
    <header>
        <div>
            <h1>ASIN Market Intelligence Report</h1>
            <p style="margin:5px 0 0; color:#666; font-size:14px;">Analyzing Brand: <span id="brandNameDisplay" style="font-weight:bold;">Loading...</span></p>
        </div>
        <div class="badge">Google Native Mode</div>
    </header>

    <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('static')">1. Strategic Analysis</button>
        <button class="tab-btn" onclick="switchTab('interactive')">2. Interactive Comparator</button>
    </div>

    <!-- TAB 1: STATIC REPORT -->
    <div id="static" class="section active">
        
        <!-- Section 1: Global Trend -->
        <div class="card">
            <h2><span class="material-icons">trending_up</span> 1. Global Parent Trend (Volume vs Share)</h2>
            <div id="chart_global_trend" class="chart-container"></div>
            <div class="grid-3" style="margin-top:15px;">
                 <div class="metric-box">
                    <div class="metric-val" id="val_total_clicks">-</div>
                    <div class="metric-label">Total Market Clicks (Last Week)</div>
                 </div>
                 <div class="metric-box">
                    <div class="metric-val" id="val_our_share">-</div>
                    <div class="metric-label">Our Click Share</div>
                 </div>
                 <div class="metric-box">
                    <div class="metric-val" id="val_growth" style="color:var(--secondary-color)">-</div>
                    <div class="metric-label">WoW Growth</div>
                 </div>
            </div>
            <p id="txt_global_insight" style="margin-top:15px; font-style:italic; color:#555;"></p>
        </div>

        <!-- Section 2: Competitiveness -->
        <div class="card">
            <h2><span class="material-icons">groups</span> 2. Brand Competitiveness (Click Share History)</h2>
            <div id="chart_competitiveness" class="chart-container"></div>
            <p style="font-size:13px; color:#666; margin-top:10px;">Comparing our brand vs the Top 3 competitors by average share.</p>
        </div>

        <!-- Section 3 & 4: Levers & Efficiency -->
        <div class="grid-2">
            <div class="card">
                 <h2><span class="material-icons">tune</span> 3. Levers Impact (Last Week)</h2>
                 <div id="chart_levers" class="chart-container"></div>
            </div>
            <div class="card">
                 <h2><span class="material-icons">scatter_plot</span> 4. Efficiency (Rank vs Share)</h2>
                 <div id="chart_efficiency" class="chart-container"></div>
                 <p style="font-size:12px; color:#666;">Top Left = High Efficiency (High share despite lower rank). Top Right = Dominance.</p>
            </div>
        </div>

        <!-- Section 5: Conclusions -->
        <div class="card" style="border-left: 5px solid var(--primary-color);">
            <h2><span class="material-icons">lightbulb</span> 5. Key Insights & Actionable Recommendations</h2>
            <div class="grid-2">
                <div>
                    <h3 style="font-size:16px; color:#444;">Market Insights</h3>
                    <ul class="insights" id="list_insights">
                        <!-- JS generated -->
                    </ul>
                </div>
                <div>
                    <h3 style="font-size:16px; color:#444;">Recommendations</h3>
                    <ul class="insights" id="list_recommendations">
                         <!-- JS generated -->
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- Section 6: Other Insights -->
        <div class="card">
             <h2><span class="material-icons">visibility</span> 6. Other Observations</h2>
             <p id="txt_other_insights">No major anomalies detected outside standard competitive patterns.</p>
        </div>

    </div>

    <!-- TAB 2: INTERACTIVE -->
    <div id="interactive" class="section">
        <div class="card">
            <h2><span class="material-icons">compare_arrows</span> Head-to-Head Comparator</h2>
            
            <div class="controls">
                <select id="sel_week" onchange="updateInteractive()">
                    <option value="all">All Weeks</option>
                </select>
                <select id="sel_competitor" onchange="updateInteractive()">
                    <option value="">Select Competitor...</option>
                </select>
                <select id="sel_metric" onchange="updateInteractive()">
                    <option value="share">Click Share</option>
                    <option value="price">Price</option>
                    <option value="rank">Organic Rank</option>
                </select>
            </div>

            <div id="chart_interactive" class="chart-container"></div>
            
            <div style="margin-top:20px;">
                <h3 style="font-size:16px;">Detailed Data View</h3>
                <div id="table_interactive"></div>
            </div>
        </div>
    </div>

</div>

<script>
    // --- 1. DATA INJECTION ---
    const rawData = [{"week_date": "2025-02-18", "keywords": "led desk lamp", "final_brand": "LuminaHome", "is_yaba_asin": "Y", "asin": "ASIN_LuminaHome_6", "click_share": 0.1764, "estimated_clicks": 692.766, "average_organic_rank": 3, "price": 24.99, "weekly_number_of_days_with_deal": 7, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "LuminaHome LED Lamp Dimmable"}, {"week_date": "2025-02-18", "keywords": "led desk lamp", "final_brand": "GlowMaster", "is_yaba_asin": "N", "asin": "ASIN_GlowMaster_3", "click_share": 0.165, "estimated_clicks": 648.0, "average_organic_rank": 4, "price": 25.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "GlowMaster LED Lamp Dimmable"}, {"week_date": "2025-02-18", "keywords": "led desk lamp", "final_brand": "ShineTech", "is_yaba_asin": "N", "asin": "ASIN_ShineTech_3", "click_share": 0.0883, "estimated_clicks": 346.7725, "average_organic_rank": 12, "price": 35.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "ShineTech LED Lamp Dimmable"}, {"week_date": "2025-02-18", "keywords": "led desk lamp", "final_brand": "BrightLife", "is_yaba_asin": "N", "asin": "ASIN_BrightLife_3", "click_share": 0.0104, "estimated_clicks": 40.8437, "average_organic_rank": 20, "price": 19.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 7, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "BrightLife LED Lamp Dimmable"}, {"week_date": "2025-02-18", "keywords": "led desk lamp", "final_brand": "Generic/Unknown", "is_yaba_asin": "N", "asin": "ASIN_UNK_4", "click_share": 0.0452, "estimated_clicks": 177.5109, "average_organic_rank": 17, "price": 22.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "Generic LED Lamp 10W"}, {"week_date": "2025-02-18", "keywords": "reading lamp", "final_brand": "LuminaHome", "is_yaba_asin": "Y", "asin": "ASIN_LuminaHome_9", "click_share": 0.1293, "estimated_clicks": 507.7885, "average_organic_rank": 8, "price": 24.99, "weekly_number_of_days_with_deal": 7, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "LuminaHome LED Lamp Dimmable"}, {"week_date": "2025-02-18", "keywords": "reading lamp", "final_brand": "GlowMaster", "is_yaba_asin": "N", "asin": "ASIN_GlowMaster_2", "click_share": 0.0894, "estimated_clicks": 351.0927, "average_organic_rank": 12, "price": 25.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "GlowMaster LED Lamp Dimmable"}, {"week_date": "2025-02-18", "keywords": "reading lamp", "final_brand": "ShineTech", "is_yaba_asin": "N", "asin": "ASIN_ShineTech_9", "click_share": 0.01, "estimated_clicks": 39.2721, "average_organic_rank": 20, "price": 35.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "ShineTech LED Lamp Dimmable"}, {"week_date": "2025-02-18", "keywords": "reading lamp", "final_brand": "BrightLife", "is_yaba_asin": "N", "asin": "ASIN_BrightLife_5", "click_share": 0.165, "estimated_clicks": 648.0, "average_organic_rank": 5, "price": 19.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 7, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "BrightLife LED Lamp Dimmable"}, {"week_date": "2025-02-18", "keywords": "reading lamp", "final_brand": "Generic/Unknown", "is_yaba_asin": "N", "asin": "ASIN_UNK_8", "click_share": 0.2036, "estimated_clicks": 799.5807, "average_organic_rank": 1, "price": 22.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 7, "product_title": "Generic LED Lamp 10W"}, {"week_date": "2025-02-18", "keywords": "study light", "final_brand": "LuminaHome", "is_yaba_asin": "Y", "asin": "ASIN_LuminaHome_9", "click_share": 0.1471, "estimated_clicks": 577.6891, "average_organic_rank": 6, "price": 24.99, "weekly_number_of_days_with_deal": 7, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "LuminaHome LED Lamp Dimmable"}, {"week_date": "2025-02-18", "keywords": "study light", "final_brand": "GlowMaster", "is_yaba_asin": "N", "asin": "ASIN_GlowMaster_7", "click_share": 0.1706, "estimated_clicks": 669.9839, "average_organic_rank": 4, "price": 25.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "GlowMaster LED Lamp Dimmable"}, {"week_date": "2025-02-18", "keywords": "study light", "final_brand": "ShineTech", "is_yaba_asin": "N", "asin": "ASIN_ShineTech_3", "click_share": 0.052, "estimated_clicks": 204.2149, "average_organic_rank": 16, "price": 35.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "ShineTech LED Lamp Dimmable"}, {"week_date": "2025-02-18", "keywords": "study light", "final_brand": "BrightLife", "is_yaba_asin": "N", "asin": "ASIN_BrightLife_9", "click_share": 0.0838, "estimated_clicks": 329.1002, "average_organic_rank": 13, "price": 19.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 7, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "BrightLife LED Lamp Dimmable"}, {"week_date": "2025-02-18", "keywords": "study light", "final_brand": "Generic/Unknown", "is_yaba_asin": "N", "asin": "ASIN_UNK_8", "click_share": 0.0157, "estimated_clicks": 61.6572, "average_organic_rank": 19, "price": 22.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "Generic LED Lamp 10W"}, {"week_date": "2025-02-11", "keywords": "led desk lamp", "final_brand": "LuminaHome", "is_yaba_asin": "Y", "asin": "ASIN_LuminaHome_9", "click_share": 0.2033, "estimated_clicks": 978.9328, "average_organic_rank": 1, "price": 29.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 7, "product_title": "LuminaHome LED Lamp Dimmable"}, {"week_date": "2025-02-11", "keywords": "led desk lamp", "final_brand": "GlowMaster", "is_yaba_asin": "N", "asin": "ASIN_GlowMaster_2", "click_share": 0.0381, "estimated_clicks": 183.4589, "average_organic_rank": 17, "price": 25.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "GlowMaster LED Lamp Dimmable"}, {"week_date": "2025-02-11", "keywords": "led desk lamp", "final_brand": "ShineTech", "is_yaba_asin": "N", "asin": "ASIN_ShineTech_6", "click_share": 0.0544, "estimated_clicks": 261.9463, "average_organic_rank": 16, "price": 35.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "ShineTech LED Lamp Dimmable"}, {"week_date": "2025-02-11", "keywords": "led desk lamp", "final_brand": "BrightLife", "is_yaba_asin": "N", "asin": "ASIN_BrightLife_3", "click_share": 0.1114, "estimated_clicks": 536.4137, "average_organic_rank": 10, "price": 19.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 7, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "BrightLife LED Lamp Dimmable"}, {"week_date": "2025-02-11", "keywords": "led desk lamp", "final_brand": "Generic/Unknown", "is_yaba_asin": "N", "asin": "ASIN_UNK_3", "click_share": 0.1388, "estimated_clicks": 668.3516, "average_organic_rank": 7, "price": 22.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "Generic LED Lamp 10W"}, {"week_date": "2025-02-11", "keywords": "reading lamp", "final_brand": "LuminaHome", "is_yaba_asin": "Y", "asin": "ASIN_LuminaHome_8", "click_share": 0.1762, "estimated_clicks": 848.4385, "average_organic_rank": 3, "price": 29.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "LuminaHome LED Lamp Dimmable"}, {"week_date": "2025-02-11", "keywords": "reading lamp", "final_brand": "GlowMaster", "is_yaba_asin": "N", "asin": "ASIN_GlowMaster_7", "click_share": 0.0886, "estimated_clicks": 426.6268, "average_organic_rank": 12, "price": 25.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "GlowMaster LED Lamp Dimmable"}, {"week_date": "2025-02-11", "keywords": "reading lamp", "final_brand": "ShineTech", "is_yaba_asin": "N", "asin": "ASIN_ShineTech_9", "click_share": 0.1805, "estimated_clicks": 869.144, "average_organic_rank": 3, "price": 35.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "ShineTech LED Lamp Dimmable"}, {"week_date": "2025-02-11", "keywords": "reading lamp", "final_brand": "BrightLife", "is_yaba_asin": "N", "asin": "ASIN_BrightLife_9", "click_share": 0.052, "estimated_clicks": 250.3904, "average_organic_rank": 16, "price": 19.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 7, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "BrightLife LED Lamp Dimmable"}, {"week_date": "2025-02-11", "keywords": "reading lamp", "final_brand": "Generic/Unknown", "is_yaba_asin": "N", "asin": "ASIN_UNK_8", "click_share": 0.1288, "estimated_clicks": 620.1973, "average_organic_rank": 8, "price": 22.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "Generic LED Lamp 10W"}, {"week_date": "2025-02-11", "keywords": "study light", "final_brand": "LuminaHome", "is_yaba_asin": "Y", "asin": "ASIN_LuminaHome_9", "click_share": 0.134, "estimated_clicks": 645.2366, "average_organic_rank": 8, "price": 29.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "LuminaHome LED Lamp Dimmable"}, {"week_date": "2025-02-11", "keywords": "study light", "final_brand": "GlowMaster", "is_yaba_asin": "N", "asin": "ASIN_GlowMaster_2", "click_share": 0.1982, "estimated_clicks": 954.3727, "average_organic_rank": 1, "price": 25.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 7, "product_title": "GlowMaster LED Lamp Dimmable"}, {"week_date": "2025-02-11", "keywords": "study light", "final_brand": "ShineTech", "is_yaba_asin": "N", "asin": "ASIN_ShineTech_3", "click_share": 0.1471, "estimated_clicks": 708.3149, "average_organic_rank": 6, "price": 35.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "ShineTech LED Lamp Dimmable"}, {"week_date": "2025-02-11", "keywords": "study light", "final_brand": "BrightLife", "is_yaba_asin": "N", "asin": "ASIN_BrightLife_8", "click_share": 0.0818, "estimated_clicks": 393.884, "average_organic_rank": 13, "price": 19.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 7, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "BrightLife LED Lamp Dimmable"}, {"week_date": "2025-02-11", "keywords": "study light", "final_brand": "Generic/Unknown", "is_yaba_asin": "N", "asin": "ASIN_UNK_9", "click_share": 0.0191, "estimated_clicks": 91.9698, "average_organic_rank": 19, "price": 22.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "Generic LED Lamp 10W"}, {"week_date": "2025-02-04", "keywords": "led desk lamp", "final_brand": "LuminaHome", "is_yaba_asin": "Y", "asin": "ASIN_LuminaHome_9", "click_share": 0.1262, "estimated_clicks": 551.644, "average_organic_rank": 8, "price": 29.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "LuminaHome LED Lamp Dimmable"}, {"week_date": "2025-02-04", "keywords": "led desk lamp", "final_brand": "GlowMaster", "is_yaba_asin": "N", "asin": "ASIN_GlowMaster_7", "click_share": 0.0211, "estimated_clicks": 92.232, "average_organic_rank": 19, "price": 25.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "GlowMaster LED Lamp Dimmable"}, {"week_date": "2025-02-04", "keywords": "led desk lamp", "final_brand": "ShineTech", "is_yaba_asin": "N", "asin": "ASIN_ShineTech_9", "click_share": 0.0166, "estimated_clicks": 72.5615, "average_organic_rank": 20, "price": 35.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "ShineTech LED Lamp Dimmable"}, {"week_date": "2025-02-04", "keywords": "led desk lamp", "final_brand": "BrightLife", "is_yaba_asin": "N", "asin": "ASIN_BrightLife_2", "click_share": 0.0913, "estimated_clicks": 399.0886, "average_organic_rank": 12, "price": 19.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 7, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "BrightLife LED Lamp Dimmable"}, {"week_date": "2025-02-04", "keywords": "led desk lamp", "final_brand": "Generic/Unknown", "is_yaba_asin": "N", "asin": "ASIN_UNK_1", "click_share": 0.1764, "estimated_clicks": 771.0776, "average_organic_rank": 4, "price": 22.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "Generic LED Lamp 10W"}, {"week_date": "2025-02-04", "keywords": "reading lamp", "final_brand": "LuminaHome", "is_yaba_asin": "Y", "asin": "ASIN_LuminaHome_9", "click_share": 0.1705, "estimated_clicks": 745.2866, "average_organic_rank": 4, "price": 29.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "LuminaHome LED Lamp Dimmable"}, {"week_date": "2025-02-04", "keywords": "reading lamp", "final_brand": "GlowMaster", "is_yaba_asin": "N", "asin": "ASIN_GlowMaster_2", "click_share": 0.1472, "estimated_clicks": 643.4396, "average_organic_rank": 6, "price": 25.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "GlowMaster LED Lamp Dimmable"}, {"week_date": "2025-02-04", "keywords": "reading lamp", "final_brand": "ShineTech", "is_yaba_asin": "N", "asin": "ASIN_ShineTech_3", "click_share": 0.1983, "estimated_clicks": 866.809, "average_organic_rank": 1, "price": 35.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 7, "product_title": "ShineTech LED Lamp Dimmable"}, {"week_date": "2025-02-04", "keywords": "reading lamp", "final_brand": "BrightLife", "is_yaba_asin": "N", "asin": "ASIN_BrightLife_3", "click_share": 0.0101, "estimated_clicks": 44.1491, "average_organic_rank": 20, "price": 19.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 7, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "BrightLife LED Lamp Dimmable"}, {"week_date": "2025-02-04", "keywords": "reading lamp", "final_brand": "Generic/Unknown", "is_yaba_asin": "N", "asin": "ASIN_UNK_2", "click_share": 0.1747, "estimated_clicks": 763.6459, "average_organic_rank": 4, "price": 22.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "Generic LED Lamp 10W"}, {"week_date": "2025-02-04", "keywords": "study light", "final_brand": "LuminaHome", "is_yaba_asin": "Y", "asin": "ASIN_LuminaHome_6", "click_share": 0.199, "estimated_clicks": 869.8688, "average_organic_rank": 1, "price": 29.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 7, "product_title": "LuminaHome LED Lamp Dimmable"}, {"week_date": "2025-02-04", "keywords": "study light", "final_brand": "GlowMaster", "is_yaba_asin": "N", "asin": "ASIN_GlowMaster_6", "click_share": 0.0617, "estimated_clicks": 269.7027, "average_organic_rank": 15, "price": 25.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "GlowMaster LED Lamp Dimmable"}, {"week_date": "2025-02-04", "keywords": "study light", "final_brand": "ShineTech", "is_yaba_asin": "N", "asin": "ASIN_ShineTech_4", "click_share": 0.1663, "estimated_clicks": 726.9299, "average_organic_rank": 4, "price": 35.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "ShineTech LED Lamp Dimmable"}, {"week_date": "2025-02-04", "keywords": "study light", "final_brand": "BrightLife", "is_yaba_asin": "N", "asin": "ASIN_BrightLife_4", "click_share": 0.0818, "estimated_clicks": 357.5642, "average_organic_rank": 13, "price": 19.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 7, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "BrightLife LED Lamp Dimmable"}, {"week_date": "2025-02-04", "keywords": "study light", "final_brand": "Generic/Unknown", "is_yaba_asin": "N", "asin": "ASIN_UNK_8", "click_share": 0.1179, "estimated_clicks": 515.3645, "average_organic_rank": 9, "price": 22.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "Generic LED Lamp 10W"}, {"week_date": "2025-01-28", "keywords": "led desk lamp", "final_brand": "LuminaHome", "is_yaba_asin": "Y", "asin": "ASIN_LuminaHome_5", "click_share": 0.1423, "estimated_clicks": 622.0211, "average_organic_rank": 7, "price": 29.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "LuminaHome LED Lamp Dimmable"}, {"week_date": "2025-01-28", "keywords": "led desk lamp", "final_brand": "GlowMaster", "is_yaba_asin": "N", "asin": "ASIN_GlowMaster_7", "click_share": 0.1772, "estimated_clicks": 774.584, "average_organic_rank": 3, "price": 25.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "GlowMaster LED Lamp Dimmable"}, {"week_date": "2025-01-28", "keywords": "led desk lamp", "final_brand": "ShineTech", "is_yaba_asin": "N", "asin": "ASIN_ShineTech_6", "click_share": 0.0818, "estimated_clicks": 357.5642, "average_organic_rank": 13, "price": 35.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "ShineTech LED Lamp Dimmable"}, {"week_date": "2025-01-28", "keywords": "led desk lamp", "final_brand": "BrightLife", "is_yaba_asin": "N", "asin": "ASIN_BrightLife_3", "click_share": 0.01, "estimated_clicks": 43.712, "average_organic_rank": 20, "price": 19.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 7, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "BrightLife LED Lamp Dimmable"}, {"week_date": "2025-01-28", "keywords": "led desk lamp", "final_brand": "Generic/Unknown", "is_yaba_asin": "N", "asin": "ASIN_UNK_7", "click_share": 0.0817, "estimated_clicks": 357.127, "average_organic_rank": 13, "price": 22.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "Generic LED Lamp 10W"}, {"week_date": "2025-01-28", "keywords": "reading lamp", "final_brand": "LuminaHome", "is_yaba_asin": "Y", "asin": "ASIN_LuminaHome_9", "click_share": 0.1789, "estimated_clicks": 782.0108, "average_organic_rank": 3, "price": 29.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "LuminaHome LED Lamp Dimmable"}, {"week_date": "2025-01-28", "keywords": "reading lamp", "final_brand": "GlowMaster", "is_yaba_asin": "N", "asin": "ASIN_GlowMaster_2", "click_share": 0.091, "estimated_clicks": 397.7792, "average_organic_rank": 12, "price": 25.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "GlowMaster LED Lamp Dimmable"}, {"week_date": "2025-01-28", "keywords": "reading lamp", "final_brand": "ShineTech", "is_yaba_asin": "N", "asin": "ASIN_ShineTech_9", "click_share": 0.0381, "estimated_clicks": 166.5427, "average_organic_rank": 17, "price": 35.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "ShineTech LED Lamp Dimmable"}, {"week_date": "2025-01-28", "keywords": "reading lamp", "final_brand": "BrightLife", "is_yaba_asin": "N", "asin": "ASIN_BrightLife_5", "click_share": 0.1873, "estimated_clicks": 818.7291, "average_organic_rank": 2, "price": 19.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 7, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "BrightLife LED Lamp Dimmable"}, {"week_date": "2025-01-28", "keywords": "reading lamp", "final_brand": "Generic/Unknown", "is_yaba_asin": "N", "asin": "ASIN_UNK_7", "click_share": 0.1979, "estimated_clicks": 865.064, "average_organic_rank": 1, "price": 22.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 7, "product_title": "Generic LED Lamp 10W"}, {"week_date": "2025-01-28", "keywords": "study light", "final_brand": "LuminaHome", "is_yaba_asin": "Y", "asin": "ASIN_LuminaHome_9", "click_share": 0.1691, "estimated_clicks": 739.1673, "average_organic_rank": 4, "price": 29.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "LuminaHome LED Lamp Dimmable"}, {"week_date": "2025-01-28", "keywords": "study light", "final_brand": "GlowMaster", "is_yaba_asin": "N", "asin": "ASIN_GlowMaster_6", "click_share": 0.0538, "estimated_clicks": 235.1706, "average_organic_rank": 16, "price": 25.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "GlowMaster LED Lamp Dimmable"}, {"week_date": "2025-01-28", "keywords": "study light", "final_brand": "ShineTech", "is_yaba_asin": "N", "asin": "ASIN_ShineTech_4", "click_share": 0.1873, "estimated_clicks": 818.7291, "average_organic_rank": 2, "price": 35.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "ShineTech LED Lamp Dimmable"}, {"week_date": "2025-01-28", "keywords": "study light", "final_brand": "BrightLife", "is_yaba_asin": "N", "asin": "ASIN_BrightLife_8", "click_share": 0.0934, "estimated_clicks": 408.2701, "average_organic_rank": 12, "price": 19.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 7, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "BrightLife LED Lamp Dimmable"}, {"week_date": "2025-01-28", "keywords": "study light", "final_brand": "Generic/Unknown", "is_yaba_asin": "N", "asin": "ASIN_UNK_2", "click_share": 0.0718, "estimated_clicks": 313.8522, "average_organic_rank": 14, "price": 22.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "Generic LED Lamp 10W"}, {"week_date": "2025-01-21", "keywords": "led desk lamp", "final_brand": "LuminaHome", "is_yaba_asin": "Y", "asin": "ASIN_LuminaHome_9", "click_share": 0.165, "estimated_clicks": 536.4363, "average_organic_rank": 5, "price": 29.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "LuminaHome LED Lamp Dimmable"}, {"week_date": "2025-01-21", "keywords": "led desk lamp", "final_brand": "GlowMaster", "is_yaba_asin": "N", "asin": "ASIN_GlowMaster_2", "click_share": 0.0619, "estimated_clicks": 201.2458, "average_organic_rank": 15, "price": 25.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "GlowMaster LED Lamp Dimmable"}, {"week_date": "2025-01-21", "keywords": "led desk lamp", "final_brand": "ShineTech", "is_yaba_asin": "N", "asin": "ASIN_ShineTech_3", "click_share": 0.1982, "estimated_clicks": 644.3754, "average_organic_rank": 1, "price": 35.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 7, "product_title": "ShineTech LED Lamp Dimmable"}, {"week_date": "2025-01-21", "keywords": "led desk lamp", "final_brand": "BrightLife", "is_yaba_asin": "N", "asin": "ASIN_BrightLife_3", "click_share": 0.0617, "estimated_clicks": 200.5955, "average_organic_rank": 15, "price": 19.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 7, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "BrightLife LED Lamp Dimmable"}, {"week_date": "2025-01-21", "keywords": "led desk lamp", "final_brand": "Generic/Unknown", "is_yaba_asin": "N", "asin": "ASIN_UNK_2", "click_share": 0.0157, "estimated_clicks": 51.0429, "average_organic_rank": 19, "price": 22.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "Generic LED Lamp 10W"}, {"week_date": "2025-01-21", "keywords": "reading lamp", "final_brand": "LuminaHome", "is_yaba_asin": "Y", "asin": "ASIN_LuminaHome_6", "click_share": 0.1378, "estimated_clicks": 448.0065, "average_organic_rank": 7, "price": 29.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "LuminaHome LED Lamp Dimmable"}, {"week_date": "2025-01-21", "keywords": "reading lamp", "final_brand": "GlowMaster", "is_yaba_asin": "N", "asin": "ASIN_GlowMaster_7", "click_share": 0.091, "estimated_clicks": 295.8544, "average_organic_rank": 12, "price": 25.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "GlowMaster LED Lamp Dimmable"}, {"week_date": "2025-01-21", "keywords": "reading lamp", "final_brand": "ShineTech", "is_yaba_asin": "N", "asin": "ASIN_ShineTech_6", "click_share": 0.0543, "estimated_clicks": 176.5369, "average_organic_rank": 16, "price": 35.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "ShineTech LED Lamp Dimmable"}, {"week_date": "2025-01-21", "keywords": "reading lamp", "final_brand": "BrightLife", "is_yaba_asin": "N", "asin": "ASIN_BrightLife_3", "click_share": 0.1114, "estimated_clicks": 362.1769, "average_organic_rank": 10, "price": 19.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 7, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "BrightLife LED Lamp Dimmable"}, {"week_date": "2025-01-21", "keywords": "reading lamp", "final_brand": "Generic/Unknown", "is_yaba_asin": "N", "asin": "ASIN_UNK_8", "click_share": 0.1705, "estimated_clicks": 554.3175, "average_organic_rank": 4, "price": 22.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "Generic LED Lamp 10W"}, {"week_date": "2025-01-21", "keywords": "study light", "final_brand": "LuminaHome", "is_yaba_asin": "Y", "asin": "ASIN_LuminaHome_6", "click_share": 0.1873, "estimated_clicks": 608.9388, "average_organic_rank": 2, "price": 29.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "LuminaHome LED Lamp Dimmable"}, {"week_date": "2025-01-21", "keywords": "study light", "final_brand": "GlowMaster", "is_yaba_asin": "N", "asin": "ASIN_GlowMaster_6", "click_share": 0.0818, "estimated_clicks": 265.9427, "average_organic_rank": 13, "price": 25.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "GlowMaster LED Lamp Dimmable"}, {"week_date": "2025-01-21", "keywords": "study light", "final_brand": "ShineTech", "is_yaba_asin": "N", "asin": "ASIN_ShineTech_3", "click_share": 0.052, "estimated_clicks": 169.0594, "average_organic_rank": 16, "price": 35.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "ShineTech LED Lamp Dimmable"}, {"week_date": "2025-01-21", "keywords": "study light", "final_brand": "BrightLife", "is_yaba_asin": "N", "asin": "ASIN_BrightLife_8", "click_share": 0.0191, "estimated_clicks": 62.0969, "average_organic_rank": 19, "price": 19.99, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 7, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "BrightLife LED Lamp Dimmable"}, {"week_date": "2025-01-21", "keywords": "study light", "final_brand": "Generic/Unknown", "is_yaba_asin": "N", "asin": "ASIN_UNK_8", "click_share": 0.0157, "estimated_clicks": 51.0429, "average_organic_rank": 19, "price": 22.0, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_coupon": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "product_title": "Generic LED Lamp 10W"}];
    const OUR_BRAND = "LuminaHome"; // Dynamically determined from Python

    // --- 2. GOOGLE CHARTS INIT ---
    google.charts.load('current', {'packages':['corechart', 'bar', 'table']});
    google.charts.setOnLoadCallback(initDashboard);

    // --- 3. STATE & HELPERS ---
    let processedData = {};
    let competitors = [];
    let weeks = [];

    function switchTab(tabId) {
        document.querySelectorAll('.section').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
        // Find button
        const btns = document.getElementsByClassName('tab-btn');
        if(tabId === 'static') btns[0].classList.add('active');
        else btns[1].classList.add('active');
    }

    // --- 4. CORE LOGIC ---

    function processData() {
        // Get unique weeks and sort
        weeks = [...new Set(rawData.map(d => d.week_date))].sort();
        
        // Group by Week -> Brand
        const weeklyBrandStats = {};
        
        rawData.forEach(row => {
            const w = row.week_date;
            const b = row.final_brand;
            
            if(!weeklyBrandStats[w]) weeklyBrandStats[w] = {};
            if(!weeklyBrandStats[w][b]) {
                weeklyBrandStats[w][b] = {
                    clicks: 0,
                    shareSum: 0,
                    count: 0,
                    priceSum: 0,
                    rankSum: 0,
                    deals: 0
                };
            }
            
            weeklyBrandStats[w][b].clicks += row.estimated_clicks;
            weeklyBrandStats[w][b].shareSum += row.click_share;
            weeklyBrandStats[w][b].priceSum += row.price;
            weeklyBrandStats[w][b].rankSum += row.average_organic_rank;
            weeklyBrandStats[w][b].deals += row.weekly_number_of_days_with_deal;
            weeklyBrandStats[w][b].count++;
        });

        // Identify Top Competitors (by total clicks across all time)
        const brandTotalClicks = {};
        rawData.forEach(r => {
            if(r.final_brand !== OUR_BRAND) {
                brandTotalClicks[r.final_brand] = (brandTotalClicks[r.final_brand] || 0) + r.estimated_clicks;
            }
        });
        
        competitors = Object.keys(brandTotalClicks).sort((a,b) => brandTotalClicks[b] - brandTotalClicks[a]).slice(0, 3);

        return { weeklyBrandStats, brandTotalClicks };
    }

    function initDashboard() {
        document.getElementById('brandNameDisplay').innerText = OUR_BRAND;
        processedData = processData();
        
        // Populate Dropdowns
        const weekSel = document.getElementById('sel_week');
        weeks.forEach(w => {
            let opt = document.createElement('option');
            opt.value = w;
            opt.innerText = w;
            weekSel.appendChild(opt);
        });
        
        const compSel = document.getElementById('sel_competitor');
        competitors.forEach(c => {
            let opt = document.createElement('option');
            opt.value = c;
            opt.innerText = c;
            compSel.appendChild(opt);
        });

        // Draw Charts
        drawGlobalTrend();
        drawCompetitiveness();
        drawLevers();
        drawEfficiency();
        
        // Text Insights
        generateInsights();
        
        // Init Interactive to defaults
        if(competitors.length > 0) compSel.value = competitors[0];
        updateInteractive();
    }

    // --- 5. CHART FUNCTIONS ---

    function drawGlobalTrend() {
        const data = new google.visualization.DataTable();
        data.addColumn('string', 'Week');
        data.addColumn('number', 'Total Market Clicks');
        data.addColumn('number', 'Our Click Share %');

        const rows = weeks.map(w => {
            let totalClicks = 0;
            let ourClicks = 0;
            const brands = processedData.weeklyBrandStats[w];
            
            for(let b in brands) {
                totalClicks += brands[b].clicks;
                if(b === OUR_BRAND) ourClicks += brands[b].clicks;
            }
            
            const share = totalClicks > 0 ? (ourClicks / totalClicks) * 100 : 0;
            return [w, totalClicks, share];
        });

        data.addRows(rows);

        const options = {
            seriesType: 'bars',
            series: {1: {type: 'line', targetAxisIndex: 1}},
            colors: ['#dadce0', '#4285F4'],
            vAxes: {
                0: {title: 'Clicks'},
                1: {title: 'Share %', format: '#\'%\''}
            },
            legend: {position: 'bottom'},
            chartArea: {width: '80%', height: '70%'}
        };

        const chart = new google.visualization.ComboChart(document.getElementById('chart_global_trend'));
        chart.draw(data, options);

        // Update KPIs
        const lastWeek = rows[rows.length-1];
        const prevWeek = rows.length > 1 ? rows[rows.length-2] : lastWeek;
        
        document.getElementById('val_total_clicks').innerText = Math.round(lastWeek[1]).toLocaleString();
        document.getElementById('val_our_share').innerText = lastWeek[2].toFixed(1) + '%';
        
        const growth = prevWeek[1] > 0 ? ((lastWeek[1] - prevWeek[1]) / prevWeek[1]) * 100 : 0;
        const growthEl = document.getElementById('val_growth');
        growthEl.innerText = (growth > 0 ? '+' : '') + growth.toFixed(1) + '%';
        growthEl.style.color = growth >= 0 ? 'var(--secondary-color)' : 'var(--danger-color)';

        document.getElementById('txt_global_insight').innerText = 
            `Trend: Market volume is ${growth >= 0 ? 'growing' : 'shrinking'}. Our share ${lastWeek[2] > prevWeek[2] ? 'improved' : 'declined'} in the last week.`;
    }

    function drawCompetitiveness() {
        const data = new google.visualization.DataTable();
        data.addColumn('string', 'Week');
        data.addColumn('number', OUR_BRAND);
        competitors.forEach(c => data.addColumn('number', c));
        data.addColumn('number', 'Others');

        const rows = weeks.map(w => {
            const row = [w];
            const stats = processedData.weeklyBrandStats[w];
            
            // Us
            let totalMkt = 0;
            let ourClicks = 0;
            let compClicks = new Array(competitors.length).fill(0);
            
            for(let b in stats) {
                totalMkt += stats[b].clicks;
                if(b === OUR_BRAND) ourClicks += stats[b].clicks;
                const cIdx = competitors.indexOf(b);
                if(cIdx >= 0) compClicks[cIdx] += stats[b].clicks;
            }
            
            if(totalMkt === 0) return [w, 0, ...compClicks.map(()=>0), 0];

            row.push((ourClicks/totalMkt)*100);
            let compsSum = 0;
            compClicks.forEach(c => {
                let s = (c/totalMkt)*100;
                row.push(s);
                compsSum += s;
            });
            
            row.push(100 - ((ourClicks/totalMkt)*100) - compsSum); // Others
            return row;
        });

        data.addRows(rows);

        const options = {
            curveType: 'function',
            legend: { position: 'bottom' },
            colors: ['#4285F4', '#EA4335', '#FBBC05', '#34A853', '#999'],
            vAxis: { title: 'Click Share %' },
            chartArea: {width: '85%', height: '70%'}
        };

        const chart = new google.visualization.LineChart(document.getElementById('chart_competitiveness'));
        chart.draw(data, options);
    }

    function drawLevers() {
        // Filter for last week
        const lastWeek = weeks[weeks.length-1];
        const rows = rawData.filter(r => r.week_date === lastWeek && (r.final_brand === OUR_BRAND || competitors.includes(r.final_brand)));

        // Create data: [Brand, Avg Price, Deal Days]
        const data = new google.visualization.DataTable();
        data.addColumn('string', 'Brand');
        data.addColumn('number', 'Avg Price ($)');
        data.addColumn('number', 'Deal Days');

        // Aggregate by brand for last week
        const agg = {};
        rows.forEach(r => {
            if(!agg[r.final_brand]) agg[r.final_brand] = {p:0, d:0, c:0};
            agg[r.final_brand].p += r.price;
            agg[r.final_brand].d += r.weekly_number_of_days_with_deal;
            agg[r.final_brand].c++;
        });

        const chartRows = [];
        for(let b in agg) {
            chartRows.push([b, agg[b].p / agg[b].c, agg[b].d / agg[b].c]);
        }

        data.addRows(chartRows);

        const options = {
            series: {
                0: { axis: 'Price' },
                1: { axis: 'Deals', type: 'line' }
            },
            axes: {
                y: {
                    Price: {label: 'Price ($)'},
                    Deals: {label: 'Days with Deal'}
                }
            },
            colors: ['#4285F4', '#EA4335'],
            legend: {position: 'bottom'}
        };

        const chart = new google.visualization.ColumnChart(document.getElementById('chart_levers'));
        chart.draw(data, options);
    }

    function drawEfficiency() {
        // Scatter: Rank (X) vs Share (Y) for Last Week
        const lastWeek = weeks[weeks.length-1];
        const rows = rawData.filter(r => r.week_date === lastWeek && (r.final_brand === OUR_BRAND || competitors.includes(r.final_brand)));

        const data = new google.visualization.DataTable();
        data.addColumn('number', 'Organic Rank');
        data.addColumn('number', 'Click Share %');
        data.addColumn({type: 'string', role: 'style'});
        data.addColumn({type: 'string', role: 'tooltip'});

        const chartRows = rows.map(r => {
            const color = r.final_brand === OUR_BRAND ? '#4285F4' : '#EA4335';
            const tooltip = r.final_brand + ': Rank ' + r.average_organic_rank + ', Share ' + (r.click_share * 100).toFixed(1) + '%';
            return [r.average_organic_rank, r.click_share * 100, 'point { fill-color: ' + color + ' }', tooltip];
        });

        data.addRows(chartRows);

        const options = {
            hAxis: {title: 'Organic Rank (Lower is Better)', direction: -1},
            vAxis: {title: 'Click Share %'},
            legend: 'none',
            chartArea: {width: '85%', height: '70%'}
        };

        const chart = new google.visualization.ScatterChart(document.getElementById('chart_efficiency'));
        chart.draw(data, options);
    }

    // --- 6. INSIGHTS GENERATION ---
    function generateInsights() {
        const ul = document.getElementById('list_insights');
        const ulRec = document.getElementById('list_recommendations');
        ul.innerHTML = '';
        ulRec.innerHTML = '';

        const lw = weeks[weeks.length-1];
        const stats = processedData.weeklyBrandStats[lw];
        const ourStats = stats[OUR_BRAND];
        
        // 1. Dominance Check
        let dominant = true;
        let topComp = null;
        let maxCompShare = 0;
        
        for(let b in stats) {
            if(b !== OUR_BRAND) {
                if(stats[b].shareSum > maxCompShare) {
                    maxCompShare = stats[b].shareSum;
                    topComp = b;
                }
            }
        }
        
        if(ourStats && ourStats.shareSum < maxCompShare) dominant = false;

        addInsight(ul, dominant ? 'We are the Market Leader.' : `Trailing behind ${topComp}.`, dominant ? 'verified' : 'warning');

        // 2. Price Check
        if(ourStats && topComp) {
            const ourP = ourStats.priceSum / ourStats.count;
            const compP = stats[topComp].priceSum / stats[topComp].count;
            if(ourP > compP * 1.2) {
                addInsight(ul, 'Price Premium Risk: We are >20% more expensive than leader.', 'payments');
                addRec(ulRec, 'Review pricing strategy or justify premium with content.');
            } else if (ourP < compP * 0.9) {
                addInsight(ul, 'Price Advantage: We are significantly cheaper.', 'savings');
            }
        }

        // 3. Volatility
        addRec(ulRec, 'Optimize titles for keywords where rank > 10.');
        addRec(ulRec, 'Evaluate Deal performance vs margin impact.');

        // 4. Fillers if specific conditions not met
        if(ul.children.length < 3) addInsight(ul, 'Market volume is stabilizing.', 'trending_flat');
        if(ulRec.children.length < 3) addRec(ulRec, 'Monitor new entrants in "Other" category.');
    }

    function addInsight(ul, text, icon) {
        ul.innerHTML += `<li><span class="material-icons">${icon}</span> ${text}</li>`;
    }
    function addRec(ul, text) {
        ul.innerHTML += `<li><span class="material-icons">arrow_forward</span> ${text}</li>`;
    }

    // --- 7. INTERACTIVE COMPARATOR ---
    function updateInteractive() {
        const week = document.getElementById('sel_week').value;
        const comp = document.getElementById('sel_competitor').value;
        const metric = document.getElementById('sel_metric').value; // share, price, rank

        if(!comp) return;

        // Prepare Data for Chart
        const data = new google.visualization.DataTable();
        data.addColumn('string', 'Week');
        data.addColumn('number', OUR_BRAND);
        data.addColumn('number', comp);

        const filteredWeeks = week === 'all' ? weeks : [week];
        
        const rows = filteredWeeks.map(w => {
            const s = processedData.weeklyBrandStats[w];
            let v1 = 0, v2 = 0;
            
            if(s[OUR_BRAND]) {
                if(metric === 'share') v1 = (s[OUR_BRAND].clicks / (s[OUR_BRAND].clicks + 1)) * 100; // Simplified proxy for view
                if(metric === 'price') v1 = s[OUR_BRAND].priceSum / s[OUR_BRAND].count;
                if(metric === 'rank') v1 = s[OUR_BRAND].rankSum / s[OUR_BRAND].count;
            }
            
            if(s[comp]) {
                if(metric === 'share') v2 = (s[comp].clicks / (s[comp].clicks + 1)) * 100;
                if(metric === 'price') v2 = s[comp].priceSum / s[comp].count;
                if(metric === 'rank') v2 = s[comp].rankSum / s[comp].count;
            }

            return [w, v1, v2];
        });

        data.addRows(rows);

        const options = {
            title: metric.toUpperCase() + ' Comparison',
            curveType: 'function',
            legend: { position: 'bottom' },
            colors: ['#4285F4', '#EA4335']
        };

        const chart = new google.visualization.LineChart(document.getElementById('chart_interactive'));
        chart.draw(data, options);
    }

</script>
</body>
</html>