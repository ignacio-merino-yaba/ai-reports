<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASIN Performance Report: Matcha Premium</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Prop-Types (Required for Recharts UMD) -->
    <script src="https://unpkg.com/prop-types/prop-types.min.js"></script>
    
    <!-- Recharts -->
    <script src="https://unpkg.com/recharts/umd/Recharts.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; }
        .card { background: white; border-radius: 1rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); padding: 1.5rem; }
        .chart-container { width: 100%; height: 300px; }
        .text-yaba { color: #2563eb; } /* Blue-600 */
        .bg-yaba { background-color: #2563eb; }
        .text-comp { color: #dc2626; } /* Red-600 */
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo } = React;
        const { 
            LineChart, Line, AreaChart, Area, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer,
            ScatterChart, Scatter, ZAxis, BarChart, Bar, Cell
        } = Recharts;

        // ------------------------------------------------------------------
        // DATA INJECTION (PROCESSED PYTHON OUTPUT)
        // ------------------------------------------------------------------
        const marketData = {"ourBrand": "NaturaleBio", "topCompetitors": ["NORITUAL LAB", "Special Leaves", "VAHDAM"], "trendData": [{"week": "2025-51", "us_clicks": 9700, "comp_clicks": 20798, "us_share": 21.72, "comp_share": 46.57}, {"week": "2025-52", "us_clicks": 9025, "comp_clicks": 15909, "us_share": 26.22, "comp_share": 46.22}, {"week": "2026-01", "us_clicks": 7170, "comp_clicks": 12663, "us_share": 25.9, "comp_share": 45.74}], "brandTrendData": [{"week": "2025-51", "NaturaleBio": 21.72, "NORITUAL LAB": 24.64, "Special Leaves": 8.14, "VAHDAM": 7.45, "Rest of Market": 6.34}, {"week": "2025-52", "NaturaleBio": 26.22, "NORITUAL LAB": 26.71, "Special Leaves": 8.24, "VAHDAM": 8.89, "Rest of Market": 2.38}, {"week": "2026-01", "NaturaleBio": 25.9, "NORITUAL LAB": 26.03, "Special Leaves": 7.02, "VAHDAM": 6.53, "Rest of Market": 6.16}], "asinPerformance": [{"week": "2025-51", "brand": "Special Leaves", "asin": "B0DRP6Y6XC", "title": "Matcha Pulver - 90g - 100% Nat\u00fcrlich & Fein Gemahl...", "is_yaba": "N", "clicks": 1817.7, "share": 4.07, "rank": 15.0, "price": 10.69, "deal_days": 0.0, "coupon_days": 7.0, "badges": 0}, {"week": "2025-51", "brand": "VAHDAM", "asin": "B07MD4LB49", "title": "VAHDAM, Matcha Gr\u00fcntee Pulver (100g, 50+ Tassen) A...", "is_yaba": "N", "clicks": 2157.1, "share": 4.83, "rank": 8.0, "price": 9.157142857, "deal_days": 5.0, "coupon_days": 0.0, "badges": 0}, {"week": "2025-51", "brand": "TEA Uniq\u014d", "asin": "B0912DKFK5", "title": "Tea Uniqo \u2013 Premium Matcha Pulver \u2013 Ideal zum Trin...", "is_yaba": "N", "clicks": 1710.5, "share": 3.83, "rank": 12.0, "price": 12.884285714, "deal_days": 0.0, "coupon_days": 0.0, "badges": 0}, {"week": "2025-51", "brand": "NaturaleBio", "asin": "B079VQ52MK", "title": "NaturaleBio Matcha Tee Pulver Bio - Premium-Qualit...", "is_yaba": "Y", "clicks": 1460.4, "share": 3.27, "rank": 5.0, "price": 23.63, "deal_days": 0.0, "coupon_days": 0.0, "badges": 0}, {"week": "2025-51", "brand": "NaturaleBio", "asin": "B06XQ69YCQ", "title": "NaturaleBio Matcha Tee Pulver Bio - Premium-Qualit...", "is_yaba": "Y", "clicks": 2246.4, "share": 5.03, "rank": 4.0, "price": 9.445714286, "deal_days": 0.0, "coupon_days": 0.0, "badges": 0}, {"week": "2025-51", "brand": "NaturaleBio", "asin": "B06XQ5DCYJ", "title": "NaturaleBio Matcha Tee Pulver Bio - Premium-Qualit...", "is_yaba": "Y", "clicks": 5993.4, "share": 13.42, "rank": 1.0, "price": 14.435714286, "deal_days": 0.0, "coupon_days": 0.0, "badges": 0}, {"week": "2025-51", "brand": "Special Leaves", "asin": "B0DRP6Y6XC", "title": "Matcha Pulver - 90g - 100% Nat\u00fcrlich & Fein Gemahl...", "is_yaba": "N", "clicks": 1817.7, "share": 4.07, "rank": 15.0, "price": 10.69, "deal_days": 0.0, "coupon_days": 7.0, "badges": 0}, {"week": "2025-51", "brand": "NORITUAL LAB", "asin": "B0FSL3C3Z8", "title": "Ceremonial Matcha Ryoku - Reines Gr\u00fcntee-Pulver au...", "is_yaba": "N", "clicks": 2661.8, "share": 5.96, "rank": 6.0, "price": 16.01, "deal_days": 0.0, "coupon_days": 0.0, "badges": 0}, {"week": "2025-51", "brand": "VAHDAM", "asin": "B07K1WBH4K", "title": "VAHDAM, Vanille Matcha Gr\u00fcner Tee Pulver (100g, 50...", "is_yaba": "N", "clicks": 1170.1, "share": 2.62, "rank": 22.0, "price": 9.242857143, "deal_days": 5.0, "coupon_days": 0.0, "badges": 0}, {"week": "2025-51", "brand": "NORITUAL LAB", "asin": "B0CNRX8G5S", "title": "Ceremonial Matcha - Reines Matcha Pulver aus Japan...", "is_yaba": "N", "clicks": 5680.8, "share": 12.72, "rank": 3.0, "price": 24.605714286, "deal_days": 0.0, "coupon_days": 0.0, "badges": 1}, {"week": "2025-51", "brand": "NORITUAL LAB", "asin": "B0FSL3C3Z8", "title": "Ceremonial Matcha Ryoku - Reines Gr\u00fcntee-Pulver au...", "is_yaba": "N", "clicks": 2661.8, "share": 5.96, "rank": 6.0, "price": 16.01, "deal_days": 0.0, "coupon_days": 0.0, "badges": 0}, {"week": "2025-51", "brand": "Ceremonial", "asin": "B0G1T7N675", "title": "Ceremonial Matcha Pulver BIO-Qualit\u00e4t 50g ideal zu...", "is_yaba": "N", "clicks": 1121.0, "share": 2.51, "rank": 13.0, "price": 9.112857143, "deal_days": 7.0, "coupon_days": 0.0, "badges": 0}, {"week": "2025-52", "brand": "Ceremonial", "asin": "B0G1T7N675", "title": "Ceremonial Matcha Pulver BIO-Qualit\u00e4t 50g ideal zu...", "is_yaba": "N", "clicks": 819.2, "share": 2.38, "rank": 12.0, "price": 12.447142857, "deal_days": 3.0, "coupon_days": 0.0, "badges": 0}, {"week": "2025-52", "brand": "NORITUAL LAB", "asin": "B0CNRX8G5S", "title": "Ceremonial Matcha - Reines Matcha Pulver aus Japan...", "is_yaba": "N", "clicks": 5104.6, "share": 14.83, "rank": 2.0, "price": 24.602857143, "deal_days": 0.0, "coupon_days": 0.0, "badges": 1}, {"week": "2025-52", "brand": "NaturaleBio", "asin": "B06XQ5DCYJ", "title": "NaturaleBio Matcha Tee Pulver Bio - Premium-Qualit...", "is_yaba": "Y", "clicks": 4922.2, "share": 14.3, "rank": 1.0, "price": 15.031428571, "deal_days": 0.0, "coupon_days": 0.0, "badges": 0}, {"week": "2025-52", "brand": "NaturaleBio", "asin": "B07SZFD3P9", "title": "NaturaleBio Matcha Ceremonial Grade 100g. Original...", "is_yaba": "Y", "clicks": 946.6, "share": 2.75, "rank": 25.0, "price": 30.562857143, "deal_days": 1.0, "coupon_days": 0.0, "badges": 0}, {"week": "2025-52", "brand": "NaturaleBio", "asin": "B06XQ69YCQ", "title": "NaturaleBio Matcha Tee Pulver Bio - Premium-Qualit...", "is_yaba": "Y", "clicks": 1786.4, "share": 5.19, "rank": 4.0, "price": 10.518571429, "deal_days": 0.0, "coupon_days": 0.0, "badges": 0}, {"week": "2025-52", "brand": "VAHDAM", "asin": "B07MD4LB49", "title": "VAHDAM, Matcha Gr\u00fcntee Pulver (100g, 50+ Tassen) A...", "is_yaba": "N", "clicks": 1858.7, "share": 5.4, "rank": 6.0, "price": 9.727142857, "deal_days": 3.0, "coupon_days": 0.0, "badges": 0}, {"week": "2025-52", "brand": "Special Leaves", "asin": "B0DRP6Y6XC", "title": "Matcha Pulver - 90g - 100% Nat\u00fcrlich & Fein Gemahl...", "is_yaba": "N", "clicks": 1418.1, "share": 4.12, "rank": 14.0, "price": 10.69, "deal_days": 0.0, "coupon_days": 7.0, "badges": 0}, {"week": "2025-52", "brand": "Special Leaves", "asin": "B0DRP6Y6XC", "title": "Matcha Pulver - 90g - 100% Nat\u00fcrlich & Fein Gemahl...", "is_yaba": "N", "clicks": 1418.1, "share": 4.12, "rank": 14.0, "price": 10.69, "deal_days": 0.0, "coupon_days": 7.0, "badges": 0}, {"week": "2025-52", "brand": "NORITUAL LAB", "asin": "B0FSL3C3Z8", "title": "Ceremonial Matcha Ryoku - Reines Gr\u00fcntee-Pulver au...", "is_yaba": "N", "clicks": 2044.6, "share": 5.94, "rank": 7.0, "price": 16.008571429, "deal_days": 0.0, "coupon_days": 0.0, "badges": 0}, {"week": "2025-52", "brand": "NORITUAL LAB", "asin": "B0FSL3C3Z8", "title": "Ceremonial Matcha Ryoku - Reines Gr\u00fcntee-Pulver au...", "is_yaba": "N", "clicks": 2044.6, "share": 5.94, "rank": 7.0, "price": 16.008571429, "deal_days": 0.0, "coupon_days": 0.0, "badges": 0}, {"week": "2025-52", "brand": "VAHDAM", "asin": "B07K1WBH4K", "title": "VAHDAM, Vanille Matcha Gr\u00fcner Tee Pulver (100g, 50...", "is_yaba": "N", "clicks": 1201.3, "share": 3.49, "rank": 12.0, "price": 9.727142857, "deal_days": 3.0, "coupon_days": 0.0, "badges": 0}, {"week": "2025-52", "brand": "NaturaleBio", "asin": "B079VQ52MK", "title": "NaturaleBio Matcha Tee Pulver Bio - Premium-Qualit...", "is_yaba": "Y", "clicks": 1369.9, "share": 3.98, "rank": 5.0, "price": 24.737142857, "deal_days": 0.0, "coupon_days": 0.0, "badges": 0}, {"week": "2026-01", "brand": "VAHDAM", "asin": "B07MD4LB49", "title": "VAHDAM, Matcha Gr\u00fcntee Pulver (100g, 50+ Tassen) A...", "is_yaba": "N", "clicks": 1049.2, "share": 3.79, "rank": 8.0, "price": 10.43, "deal_days": 0.0, "coupon_days": 0.0, "badges": 0}, {"week": "2026-01", "brand": "NORITUAL LAB", "asin": "B0CNRX8G5S", "title": "Ceremonial Matcha - Reines Matcha Pulver aus Japan...", "is_yaba": "N", "clicks": 3878.5, "share": 14.01, "rank": 2.0, "price": 23.91, "deal_days": 0.0, "coupon_days": 0.0, "badges": 1}, {"week": "2026-01", "brand": "NaturaleBio", "asin": "B079VQ52MK", "title": "NaturaleBio Matcha Tee Pulver Bio - Premium-Qualit...", "is_yaba": "Y", "clicks": 968.9, "share": 3.5, "rank": 5.0, "price": 24.5275, "deal_days": 0.0, "coupon_days": 0.0, "badges": 0}, {"week": "2026-01", "brand": "bioKontor", "asin": "B08XVX8V1T", "title": "Bio Matcha Pulver 100 g \u2013 Japan Matcha Tee, 100% n...", "is_yaba": "N", "clicks": 852.7, "share": 3.08, "rank": 9.0, "price": 11.9975, "deal_days": 0.0, "coupon_days": 0.0, "badges": 0}, {"week": "2026-01", "brand": "NORITUAL LAB", "asin": "B0FSL3C3Z8", "title": "Ceremonial Matcha Ryoku - Reines Gr\u00fcntee-Pulver au...", "is_yaba": "N", "clicks": 1663.8, "share": 6.01, "rank": 7.0, "price": 15.5575, "deal_days": 0.0, "coupon_days": 0.0, "badges": 0}, {"week": "2026-01", "brand": "NaturaleBio", "asin": "B06XQ5DCYJ", "title": "NaturaleBio Matcha Tee Pulver Bio - Premium-Qualit...", "is_yaba": "Y", "clicks": 4083.4, "share": 14.75, "rank": 1.0, "price": 14.6075, "deal_days": 0.0, "coupon_days": 0.0, "badges": 0}, {"week": "2026-01", "brand": "NaturaleBio", "asin": "B07SZFD3P9", "title": "NaturaleBio Matcha Ceremonial Grade 100g. Original...", "is_yaba": "Y", "clicks": 744.7, "share": 2.69, "rank": NaN, "price": 30.27, "deal_days": NaN, "coupon_days": NaN, "badges": 0}, {"week": "2026-01", "brand": "VAHDAM", "asin": "B07K1WBH4K", "title": "VAHDAM, Vanille Matcha Gr\u00fcner Tee Pulver (100g, 50...", "is_yaba": "N", "clicks": 758.5, "share": 2.74, "rank": 12.0, "price": 10.43, "deal_days": 0.0, "coupon_days": 0.0, "badges": 0}, {"week": "2026-01", "brand": "Special Leaves", "asin": "B0DRP6Y6XC", "title": "Matcha Pulver - 90g - 100% Nat\u00fcrlich & Fein Gemahl...", "is_yaba": "N", "clicks": 971.7, "share": 3.51, "rank": 15.0, "price": 10.39, "deal_days": 0.0, "coupon_days": 4.0, "badges": 0}, {"week": "2026-01", "brand": "Special Leaves", "asin": "B0DRP6Y6XC", "title": "Matcha Pulver - 90g - 100% Nat\u00fcrlich & Fein Gemahl...", "is_yaba": "N", "clicks": 971.7, "share": 3.51, "rank": 15.0, "price": 10.39, "deal_days": 0.0, "coupon_days": 4.0, "badges": 0}, {"week": "2026-01", "brand": "NORITUAL LAB", "asin": "B0FSL3C3Z8", "title": "Ceremonial Matcha Ryoku - Reines Gr\u00fcntee-Pulver au...", "is_yaba": "N", "clicks": 1663.8, "share": 6.01, "rank": 7.0, "price": 15.5575, "deal_days": 0.0, "coupon_days": 0.0, "badges": 0}, {"week": "2026-01", "brand": "NaturaleBio", "asin": "B06XQ69YCQ", "title": "NaturaleBio Matcha Tee Pulver Bio - Premium-Qualit...", "is_yaba": "Y", "clicks": 1373.1, "share": 4.96, "rank": 4.0, "price": 10.2225, "deal_days": 0.0, "coupon_days": 0.0, "badges": 0}, {"week": "2026-01", "brand": "bioKontor", "asin": "B08XVX8V1T", "title": "Bio Matcha Pulver 100 g \u2013 Japan Matcha Tee, 100% n...", "is_yaba": "N", "clicks": 852.7, "share": 3.08, "rank": 9.0, "price": 11.9975, "deal_days": 0.0, "coupon_days": 0.0, "badges": 0}]};

        // ------------------------------------------------------------------
        // APP COMPONENT
        // ------------------------------------------------------------------
        const MarketDashboard = () => {
            const [activeTab, setActiveTab] = useState('static');
            const [selectedWeek, setSelectedWeek] = useState(marketData.trendData[marketData.trendData.length - 1].week);
            const [selectedComp, setSelectedComp] = useState(marketData.topCompetitors[0]);

            // Icons
            const icons = {
                Up: <i data-lucide="trending-up" className="w-4 h-4 text-green-500" />,
                Down: <i data-lucide="trending-down" className="w-4 h-4 text-red-500" />,
                Alert: <i data-lucide="alert-circle" className="w-4 h-4 text-orange-500" />,
                Zap: <i data-lucide="zap" className="w-4 h-4 text-yellow-500" />
            };

            // Calculated Data
            const latestData = marketData.trendData[marketData.trendData.length - 1];
            const prevData = marketData.trendData[marketData.trendData.length - 2];
            const shareChange = (latestData.us_share - prevData.us_share).toFixed(2);
            const trendIcon = shareChange >= 0 ? icons.Up : icons.Down;

            // Prepare Scatter Data (Rank vs Share)
            const scatterData = useMemo(() => {
                const weekData = marketData.asinPerformance.filter(d => d.week === selectedWeek);
                return weekData.map(d => ({
                    x: d.rank || 30, // Default for unranked
                    y: d.share,
                    z: d.clicks,
                    name: d.brand,
                    isUs: d.brand === marketData.ourBrand,
                    asin: d.asin
                }));
            }, [selectedWeek]);

            // ------------------------------------------------------------------
            // RENDER: STATIC TAB (REPORT)
            // ------------------------------------------------------------------
            const renderStaticReport = () => (
                <div className="space-y-8 animate-fade-in">
                    {/* Header Metrics */}
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div className="card border-l-4 border-blue-600">
                            <h3 className="text-gray-500 text-sm font-medium">Market Share (Latest)</h3>
                            <div className="flex items-center gap-2 mt-1">
                                <span className="text-3xl font-bold text-gray-900">{latestData.us_share}%</span>
                                <span className={`text-sm font-medium ${shareChange >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                    {shareChange > 0 ? '+' : ''}{shareChange}% vs LW
                                </span>
                            </div>
                        </div>
                        <div className="card border-l-4 border-gray-400">
                            <h3 className="text-gray-500 text-sm font-medium">Top Competitor</h3>
                            <div className="flex items-center gap-2 mt-1">
                                <span className="text-2xl font-bold text-gray-900">{marketData.topCompetitors[0]}</span>
                                <span className="text-sm text-gray-500">
                                    {(marketData.brandTrendData[marketData.brandTrendData.length-1][marketData.topCompetitors[0]]).toFixed(1)}% Share
                                </span>
                            </div>
                        </div>
                        <div className="card border-l-4 border-indigo-500">
                            <h3 className="text-gray-500 text-sm font-medium">Market Vol (Est. Clicks)</h3>
                            <div className="flex items-center gap-2 mt-1">
                                <span className="text-2xl font-bold text-gray-900">
                                    {(latestData.us_clicks + latestData.comp_clicks).toLocaleString()}
                                </span>
                                <span className="text-xs text-gray-400">Last Week Total</span>
                            </div>
                        </div>
                    </div>

                    {/* Chart 1: Trend Evolution */}
                    <div className="card">
                        <h2 className="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                            <i data-lucide="bar-chart-2" className="w-5 h-5 text-blue-600"></i>
                            Global Trend: Us vs Competitors (Estimated Clicks)
                        </h2>
                        <div className="chart-container">
                            <ResponsiveContainer width="100%" height="100%">
                                <AreaChart data={marketData.trendData}>
                                    <CartesianGrid strokeDasharray="3 3" vertical={false} stroke="#e5e7eb" />
                                    <XAxis dataKey="week" stroke="#9ca3af" />
                                    <YAxis stroke="#9ca3af" />
                                    <Tooltip contentStyle={{ borderRadius: '8px', border: 'none', boxShadow: '0 4px 6px -1px rgba(0,0,0,0.1)' }} />
                                    <Legend />
                                    <Area type="monotone" dataKey="us_clicks" name={marketData.ourBrand} stackId="1" stroke="#2563eb" fill="#2563eb" fillOpacity={0.8} />
                                    <Area type="monotone" dataKey="comp_clicks" name="Competitors" stackId="1" stroke="#9ca3af" fill="#e5e7eb" />
                                </AreaChart>
                            </ResponsiveContainer>
                        </div>
                        <p className="mt-4 text-sm text-gray-600 leading-relaxed bg-blue-50 p-3 rounded-lg">
                            <strong>Trend Analysis:</strong> Market volume dipped significantly in the first week of 2026 (post-holiday seasonality). Despite this, 
                            <span className="font-bold text-blue-700"> {marketData.ourBrand} maintained a ~26% share</span>, 
                            showing strong resilience while competitors absorbed most of the volume loss.
                        </p>
                    </div>

                    {/* Chart 2: Brand Competitiveness */}
                    <div className="card">
                        <h2 className="text-xl font-bold text-gray-800 mb-4">Competitiveness: Brand Share Evolution</h2>
                        <div className="chart-container">
                            <ResponsiveContainer width="100%" height="100%">
                                <LineChart data={marketData.brandTrendData}>
                                    <CartesianGrid strokeDasharray="3 3" vertical={false} />
                                    <XAxis dataKey="week" />
                                    <YAxis />
                                    <Tooltip />
                                    <Legend />
                                    <Line type="monotone" dataKey={marketData.ourBrand} stroke="#2563eb" strokeWidth={3} dot={{r: 4}} />
                                    {marketData.topCompetitors.map((comp, idx) => (
                                        <Line key={comp} type="monotone" dataKey={comp} stroke={['#dc2626', '#d97706', '#059669'][idx]} strokeWidth={2} />
                                    ))}
                                </LineChart>
                            </ResponsiveContainer>
                        </div>
                    </div>

                    {/* Section 3: Palancas & Efficiency */}
                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        {/* Efficiency Scatter */}
                        <div className="card">
                            <h2 className="text-lg font-bold text-gray-800 mb-4">Efficiency: Rank vs Click Share</h2>
                            <div className="h-64">
                                <ResponsiveContainer width="100%" height="100%">
                                    <ScatterChart margin={{ top: 20, right: 20, bottom: 20, left: 0 }}>
                                        <CartesianGrid strokeDasharray="3 3" />
                                        <XAxis type="number" dataKey="x" name="Rank" label={{ value: 'Organic Rank (Lower is Better)', position: 'insideBottom', offset: -10 }} reversed />
                                        <YAxis type="number" dataKey="y" name="Share" label={{ value: 'Click Share %', angle: -90, position: 'insideLeft' }} />
                                        <Tooltip cursor={{ strokeDasharray: '3 3' }} content={({ payload }) => {
                                            if (payload && payload.length) {
                                                const d = payload[0].payload;
                                                return <div className="bg-white p-2 border rounded shadow text-xs">
                                                    <strong>{d.name}</strong><br/>Rank: {d.x}<br/>Share: {d.y}%
                                                </div>;
                                            }
                                            return null;
                                        }} />
                                        <Scatter name="ASINs" data={scatterData} fill="#8884d8">
                                            {scatterData.map((entry, index) => (
                                                <Cell key={`cell-${index}`} fill={entry.isUs ? '#2563eb' : '#9ca3af'} />
                                            ))}
                                        </Scatter>
                                    </ScatterChart>
                                </ResponsiveContainer>
                            </div>
                            <p className="text-xs text-gray-500 mt-2">Blue = {marketData.ourBrand}, Gray = Competitors. Top-left is best (High Share, Top Rank).</p>
                        </div>

                        {/* Text Insights */}
                        <div className="card bg-gray-50 border border-gray-200">
                            <h2 className="text-lg font-bold text-gray-800 mb-4">ðŸ’¡ Strategic Insights</h2>
                            <ul className="space-y-3 text-sm text-gray-700">
                                <li className="flex gap-2">
                                    <span className="text-blue-500 font-bold">1.</span>
                                    <span>
                                        <strong>Dominant Leader:</strong> Our main ASIN (B06XQ5DCYJ) anchors the brand with ~14% individual share and Rank #1. It is the most efficient asset in the category.
                                    </span>
                                </li>
                                <li className="flex gap-2">
                                    <span className="text-red-500 font-bold">2.</span>
                                    <span>
                                        <strong>The Challenger:</strong> <em>{marketData.topCompetitors[0]}</em> matches our total share closely (~26%). They utilize a mix of strong ranking (Rank #2-3) and premium pricing (~24â‚¬), targeting the same high-end segment.
                                    </span>
                                </li>
                                <li className="flex gap-2">
                                    <span className="text-orange-500 font-bold">3.</span>
                                    <span>
                                        <strong>Coupon Aggression:</strong> <em>Special Leaves</em> maintains ~7% share using Coupons (4-7 days/week). This "pay-to-play" tactic compensates for their lower organic rank (#15).
                                    </span>
                                </li>
                                <li className="flex gap-2">
                                    <span className="text-blue-500 font-bold">4.</span>
                                    <span>
                                        <strong>Deal Effectiveness:</strong> Deals on our secondary ASIN (B07SZFD3P9) showed minimal lift (Share ~2.7%). Organic strength on the main ASIN outweighs promotional spikes on weaker ones.
                                    </span>
                                </li>
                            </ul>
                        </div>
                    </div>

                    {/* Recommendations */}
                    <div className="card bg-blue-600 text-white">
                        <h2 className="text-xl font-bold mb-4">ðŸš€ Actionable Recommendations</h2>
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div className="bg-white/10 p-4 rounded-lg backdrop-blur-sm">
                                <h3 className="font-bold mb-2 flex items-center gap-2"><i data-lucide="shield" className="w-4 h-4"></i> Defend Top Rank</h3>
                                <p className="text-sm opacity-90">Prioritize stock and conversion on B06XQ5DCYJ. It is the brand's engine. Do not risk OOS.</p>
                            </div>
                            <div className="bg-white/10 p-4 rounded-lg backdrop-blur-sm">
                                <h3 className="font-bold mb-2 flex items-center gap-2"><i data-lucide="crosshair" className="w-4 h-4"></i> Counter-Attack Rival</h3>
                                <p className="text-sm opacity-90">Consider a targeted coupon on the secondary ASIN (B07SZFD3P9) to steal share from NORITUAL LAB's similar premium ASIN.</p>
                            </div>
                            <div className="bg-white/10 p-4 rounded-lg backdrop-blur-sm">
                                <h3 className="font-bold mb-2 flex items-center gap-2"><i data-lucide="search" className="w-4 h-4"></i> Keyword Expansion</h3>
                                <p className="text-sm opacity-90">With Search Volume dropping, expand keywords beyond "Matcha Premium" to capture broader "Green Tea" intent.</p>
                            </div>
                        </div>
                    </div>
                </div>
            );

            // ------------------------------------------------------------------
            // RENDER: INTERACTIVE TAB (COMPARATOR)
            // ------------------------------------------------------------------
            const renderInteractiveComp = () => {
                // Filter data for comparison
                const weekData = marketData.asinPerformance.filter(d => d.week === selectedWeek);
                
                // Get our best ASIN for this week
                const ourBest = weekData.filter(d => d.is_yaba === 'Y').sort((a,b) => b.share - a.share)[0] || {};
                
                // Get competitor best ASIN for this week
                const compBest = weekData.filter(d => d.brand === selectedComp).sort((a,b) => b.share - a.share)[0] || {};

                return (
                    <div className="space-y-6 animate-fade-in">
                        {/* Controls */}
                        <div className="flex flex-wrap gap-4 bg-white p-4 rounded-xl shadow-sm">
                            <div>
                                <label className="block text-xs font-bold text-gray-500 uppercase">Select Week</label>
                                <select 
                                    className="mt-1 block w-48 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 p-2 border"
                                    value={selectedWeek}
                                    onChange={(e) => setSelectedWeek(e.target.value)}
                                >
                                    {marketData.trendData.map(t => <option key={t.week} value={t.week}>{t.week}</option>)}
                                </select>
                            </div>
                            <div>
                                <label className="block text-xs font-bold text-gray-500 uppercase">Select Competitor</label>
                                <select 
                                    className="mt-1 block w-48 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 p-2 border"
                                    value={selectedComp}
                                    onChange={(e) => setSelectedComp(e.target.value)}
                                >
                                    {marketData.topCompetitors.map(c => <option key={c} value={c}>{c}</option>)}
                                </select>
                            </div>
                        </div>

                        {/* Head-to-Head Cards */}
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                            {/* Us */}
                            <div className="card border-t-4 border-blue-600 relative overflow-hidden">
                                <div className="absolute top-0 right-0 p-4 opacity-10"><i data-lucide="flag" className="w-24 h-24 text-blue-600"></i></div>
                                <h3 className="text-xl font-bold text-blue-700">{marketData.ourBrand}</h3>
                                <p className="text-sm text-gray-500 mb-4">{ourBest.title ? ourBest.title.substring(0, 40) + '...' : 'No Data'}</p>
                                
                                <div className="space-y-4">
                                    <div className="flex justify-between items-center border-b pb-2">
                                        <span className="text-gray-600">Click Share</span>
                                        <span className="text-xl font-bold">{ourBest.share || 0}%</span>
                                    </div>
                                    <div className="flex justify-between items-center border-b pb-2">
                                        <span className="text-gray-600">Organic Rank</span>
                                        <span className="text-xl font-bold">#{ourBest.rank || '-'}</span>
                                    </div>
                                    <div className="flex justify-between items-center border-b pb-2">
                                        <span className="text-gray-600">Price</span>
                                        <span className="text-xl font-bold">{ourBest.price ? `â‚¬${ourBest.price.toFixed(2)}` : '-'}</span>
                                    </div>
                                    <div className="flex gap-2 mt-2">
                                        {ourBest.deal_days > 0 && <span className="px-2 py-1 bg-red-100 text-red-700 text-xs font-bold rounded">Deal Active</span>}
                                        {ourBest.badges && <span className="px-2 py-1 bg-yellow-100 text-yellow-700 text-xs font-bold rounded">Best Seller/Choice</span>}
                                    </div>
                                </div>
                            </div>

                            {/* Competitor */}
                            <div className="card border-t-4 border-gray-500 relative overflow-hidden">
                                <div className="absolute top-0 right-0 p-4 opacity-10"><i data-lucide="swords" className="w-24 h-24 text-gray-600"></i></div>
                                <h3 className="text-xl font-bold text-gray-700">{selectedComp}</h3>
                                <p className="text-sm text-gray-500 mb-4">{compBest.title ? compBest.title.substring(0, 40) + '...' : 'No Data'}</p>
                                
                                <div className="space-y-4">
                                    <div className="flex justify-between items-center border-b pb-2">
                                        <span className="text-gray-600">Click Share</span>
                                        <span className={`text-xl font-bold ${compBest.share > ourBest.share ? 'text-red-600' : 'text-gray-900'}`}>{compBest.share || 0}%</span>
                                    </div>
                                    <div className="flex justify-between items-center border-b pb-2">
                                        <span className="text-gray-600">Organic Rank</span>
                                        <span className="text-xl font-bold">#{compBest.rank || '-'}</span>
                                    </div>
                                    <div className="flex justify-between items-center border-b pb-2">
                                        <span className="text-gray-600">Price</span>
                                        <span className="text-xl font-bold">{compBest.price ? `â‚¬${compBest.price.toFixed(2)}` : '-'}</span>
                                    </div>
                                    <div className="flex gap-2 mt-2">
                                        {compBest.coupon_days > 0 && <span className="px-2 py-1 bg-green-100 text-green-700 text-xs font-bold rounded">Coupon ({compBest.coupon_days} days)</span>}
                                        {compBest.badges && <span className="px-2 py-1 bg-yellow-100 text-yellow-700 text-xs font-bold rounded">Badge</span>}
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Comparison Insight */}
                        <div className="bg-white p-4 rounded-lg border-l-4 border-purple-500 shadow-sm mt-4">
                            <h4 className="font-bold text-purple-700">âš¡ Automated Head-to-Head Insight</h4>
                            <p className="text-sm text-gray-600 mt-1">
                                {ourBest.share > compBest.share 
                                    ? `Great! You are leading ${selectedComp} by +${(ourBest.share - compBest.share).toFixed(1)}% share. ` 
                                    : `Alert: ${selectedComp} is ahead by +${(compBest.share - ourBest.share).toFixed(1)}% share. `}
                                {compBest.price < ourBest.price ? "They are undercutting your price." : "You have a price advantage (lower) or they are premium positioned."}
                            </p>
                        </div>
                    </div>
                );
            };

            // ------------------------------------------------------------------
            // MAIN LAYOUT
            // ------------------------------------------------------------------
            return (
                <div className="max-w-6xl mx-auto p-4 md:p-8">
                    <header className="mb-8 flex flex-col md:flex-row justify-between items-start md:items-center">
                        <div>
                            <h1 className="text-3xl font-bold text-gray-900 tracking-tight">Parent ASIN Intelligence</h1>
                            <p className="text-gray-500 mt-1">Market Analysis: {marketData.ourBrand} vs Competition</p>
                        </div>
                        <div className="mt-4 md:mt-0 flex bg-white rounded-lg p-1 shadow-sm border">
                            <button 
                                onClick={() => setActiveTab('static')}
                                className={`px-4 py-2 text-sm font-medium rounded-md transition-all ${activeTab === 'static' ? 'bg-blue-600 text-white shadow' : 'text-gray-600 hover:bg-gray-50'}`}
                            >
                                Executive Report
                            </button>
                            <button 
                                onClick={() => setActiveTab('interactive')}
                                className={`px-4 py-2 text-sm font-medium rounded-md transition-all ${activeTab === 'interactive' ? 'bg-blue-600 text-white shadow' : 'text-gray-600 hover:bg-gray-50'}`}
                            >
                                Interactive Comparator
                            </button>
                        </div>
                    </header>

                    {activeTab === 'static' ? renderStaticReport() : renderInteractiveComp()}

                    <footer className="mt-12 text-center text-xs text-gray-400 border-t pt-4">
                        Generated by AI Intelligence Analyst â€¢ Data Source: input_file_0.csv â€¢ React/Recharts Engine
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<MarketDashboard />);
        
        // Initialize Icons
        setTimeout(() => lucide.createIcons(), 100);
    </script>
</body>
</html>