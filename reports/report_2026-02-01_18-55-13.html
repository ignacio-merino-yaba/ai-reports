<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reporte de Inteligencia de Mercado - Parent ASIN</title>
    <!-- Google Charts -->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <!-- Google Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #4285F4;
            --success: #34A853;
            --warning: #FBBC05;
            --danger: #EA4335;
            --gray: #5f6368;
            --light-gray: #f1f3f4;
            --bg: #ffffff;
            --card-shadow: 0 1px 2px 0 rgba(60,64,67,0.3), 0 1px 3px 1px rgba(60,64,67,0.15);
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f8f9fa;
            margin: 0;
            padding: 0;
            color: #202124;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        header {
            background: white;
            padding: 20px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        h1 {
            font-size: 22px;
            font-weight: 400;
            margin: 0;
            color: var(--gray);
        }
        
        h1 span {
            color: var(--primary);
            font-weight: 500;
        }

        /* Tabs */
        .tabs {
            display: flex;
            background: white;
            border-bottom: 1px solid #e0e0e0;
            padding: 0 20px;
            margin-bottom: 20px;
        }

        .tab {
            padding: 15px 20px;
            cursor: pointer;
            color: var(--gray);
            font-weight: 500;
            border-bottom: 2px solid transparent;
        }

        .tab.active {
            color: var(--primary);
            border-bottom: 2px solid var(--primary);
        }

        /* Cards */
        .card {
            background: white;
            border-radius: 8px;
            box-shadow: var(--card-shadow);
            padding: 24px;
            margin-bottom: 24px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 18px;
            font-weight: 500;
            color: #202124;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Grid System */
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .grid-4 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        /* Metrics */
        .metric-box {
            background: var(--light-gray);
            border-radius: 8px;
            padding: 16px;
            text-align: center;
        }

        .metric-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
        }

        .metric-label {
            font-size: 12px;
            color: var(--gray);
            text-transform: uppercase;
            margin-top: 4px;
        }
        
        .metric-sub {
            font-size: 12px;
            color: var(--danger);
            margin-top: 4px;
        }
        
        .metric-sub.pos {
            color: var(--success);
        }

        /* Insights List */
        .insight-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .insight-item {
            padding: 12px 0;
            border-bottom: 1px solid #eee;
            display: flex;
            gap: 12px;
            align-items: flex-start;
        }

        .insight-icon {
            color: var(--primary);
        }

        /* Charts Container */
        .chart-container {
            width: 100%;
            height: 350px;
        }

        /* Comparator Controls */
        .controls {
            display: flex;
            gap: 16px;
            margin-bottom: 20px;
            background: white;
            padding: 16px;
            border-radius: 8px;
            box-shadow: var(--card-shadow);
        }
        
        select {
            padding: 8px 12px;
            border-radius: 4px;
            border: 1px solid #dadce0;
            font-size: 14px;
            background: white;
        }

        /* Hidden Classes */
        .hidden {
            display: none;
        }
        
        /* Table Styles */
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            text-align: left;
            padding: 12px;
            border-bottom: 1px solid #eee;
        }
        th {
            color: var(--gray);
            font-size: 12px;
            text-transform: uppercase;
        }

    </style>
</head>
<body>

    <header>
        <div class="logo">
            <h1>Market Intelligence <span>Report</span></h1>
        </div>
        <div style="font-size: 12px; color: var(--gray);">Parent ASIN Analysis</div>
    </header>

    <div class="tabs">
        <div class="tab active" onclick="switchTab('report')">Reporte Estratégico</div>
        <div class="tab" onclick="switchTab('comparator')">Comparador Interactivo</div>
    </div>

    <div class="container">
        <!-- TAB 1: REPORTE ESTRATÉGICO -->
        <div id="tab-report">
            
            <!-- SECTION 1: GLOBAL TREND -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span class="material-icons">show_chart</span>
                        1. Tendencia Global del Parent
                    </div>
                </div>
                <div id="chart_global_trend" class="chart-container"></div>
                <div class="insight-item" id="global_trend_insight" style="border:none; background:#f8f9fa; padding:12px; margin-top:10px; border-radius:4px;">
                    <!-- JS populated -->
                </div>
            </div>

            <!-- SECTION 2: COMPETITIVENESS -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span class="material-icons">people_outline</span>
                        2. Competitividad de Marca (Share of Click)
                    </div>
                </div>
                <div id="chart_brand_comp" class="chart-container"></div>
                <div class="grid-4" id="top_competitors_metrics" style="margin-top:20px;">
                    <!-- JS populated -->
                </div>
            </div>

            <!-- SECTION 3: LEVERS -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span class="material-icons">tune</span>
                        3. Palancas de Crecimiento (Impacto en Click Share)
                    </div>
                </div>
                <div class="grid-2">
                    <div class="metric-box">
                        <div class="metric-label">Impacto de Deals</div>
                        <div class="metric-value" id="deal_impact">--</div>
                        <div class="metric-sub" id="deal_desc">vs Semanas sin Deal</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-label">Eficiencia de Precio</div>
                        <div class="metric-value" id="price_corr">--</div>
                        <div class="metric-sub">Correlación Precio/Share</div>
                    </div>
                </div>
                <div style="margin-top:20px;">
                    <table id="levers_table">
                        <thead>
                            <tr>
                                <th>Marca</th>
                                <th>Avg Share (No Promo)</th>
                                <th>Avg Share (Con Promo)</th>
                                <th>Lift %</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- SECTION 4: EFFICIENCY -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span class="material-icons">scatter_plot</span>
                        4. Eficiencia Orgánica (Rank vs Share)
                    </div>
                </div>
                <div id="chart_efficiency" class="chart-container"></div>
                <p style="font-size:12px; color:gray; text-align:center;">
                    *Eje X: Ranking Orgánico (Invertido) | Eje Y: Click Share | Puntos arriba a la derecha = Alta Eficiencia
                </p>
            </div>

            <!-- SECTION 5: CONCLUSIONS -->
            <div class="card" style="border-left: 5px solid var(--primary);">
                <div class="card-header">
                    <div class="card-title">
                        <span class="material-icons">lightbulb</span>
                        5. Conclusiones y Recomendaciones
                    </div>
                </div>
                <div class="grid-2">
                    <div>
                        <h4 style="color:var(--gray); margin-top:0;">Insights Clave</h4>
                        <ul class="insight-list" id="insights_list">
                            <!-- Populated by JS -->
                        </ul>
                    </div>
                    <div>
                        <h4 style="color:var(--gray); margin-top:0;">Recomendaciones Accionables</h4>
                        <ul class="insight-list" id="recommendations_list">
                            <!-- Populated by JS -->
                        </ul>
                    </div>
                </div>
            </div>
            
             <!-- SECTION 6: OTHER INSIGHTS -->
             <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span class="material-icons">insights</span>
                        6. Other Insights
                    </div>
                </div>
                <ul class="insight-list" id="other_insights_list">
                    <!-- Populated by JS -->
                </ul>
            </div>

        </div>

        <!-- TAB 2: COMPARADOR INTERACTIVO -->
        <div id="tab-comparator" class="hidden">
            <div class="controls">
                <div>
                    <label style="font-size:12px; display:block; color:var(--gray); margin-bottom:4px;">Semana</label>
                    <select id="comp_week_select" onchange="updateComparator()"></select>
                </div>
                <div>
                    <label style="font-size:12px; display:block; color:var(--gray); margin-bottom:4px;">Competidor</label>
                    <select id="comp_competitor_select" onchange="updateComparator()"></select>
                </div>
            </div>

            <div class="grid-2">
                <!-- Our Stats -->
                <div class="card" style="border-top: 4px solid var(--primary);">
                    <h3 style="margin-top:0; color:var(--primary);" id="comp_our_name">Nosotros</h3>
                    <div class="grid-2">
                        <div class="metric-box">
                            <div class="metric-label">Click Share</div>
                            <div class="metric-value" id="our_share">--</div>
                        </div>
                        <div class="metric-box">
                            <div class="metric-label">Precio</div>
                            <div class="metric-value" id="our_price">--</div>
                        </div>
                        <div class="metric-box">
                            <div class="metric-label">Avg Rank</div>
                            <div class="metric-value" id="our_rank">--</div>
                        </div>
                        <div class="metric-box">
                            <div class="metric-label">Active Deal</div>
                            <div class="metric-value" id="our_deal">No</div>
                        </div>
                    </div>
                </div>

                <!-- Competitor Stats -->
                <div class="card" style="border-top: 4px solid var(--danger);">
                    <h3 style="margin-top:0; color:var(--danger);" id="comp_their_name">Competidor</h3>
                    <div class="grid-2">
                        <div class="metric-box">
                            <div class="metric-label">Click Share</div>
                            <div class="metric-value" id="their_share">--</div>
                        </div>
                        <div class="metric-box">
                            <div class="metric-label">Precio</div>
                            <div class="metric-value" id="their_price">--</div>
                        </div>
                        <div class="metric-box">
                            <div class="metric-label">Avg Rank</div>
                            <div class="metric-value" id="their_rank">--</div>
                        </div>
                        <div class="metric-box">
                            <div class="metric-label">Active Deal</div>
                            <div class="metric-value" id="their_deal">No</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                 <div class="card-title">Comparativa Visual (Scatter)</div>
                 <div id="chart_comparator_scatter" class="chart-container"></div>
            </div>
        </div>
    </div>

    <script>
        // --- 1. DATA INJECTION ---
        // Synthetic data generated by Python, ensuring prompt requirements (deals, rank, price changes)
        const rawData = [{"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-01", "week_date": "2023-10-01", "keywords": "wireless headphones", "competitor_brand": "YabaTech", "asin": "Yab019", "product_title": "YabaTech wireless headphones", "country_code": "US", "average_organic_rank": 26, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.1373, "impression_share": 0.1511, "price": 49.99, "click_share_rank": 0, "weekly_search_volume": 10000, "is_yaba_asin": "Y", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-01", "week_date": "2023-10-01", "keywords": "wireless headphones", "competitor_brand": "AlphaAudio", "asin": "Alp019", "product_title": "AlphaAudio wireless headphones", "country_code": "US", "average_organic_rank": 15, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.2401, "impression_share": 0.2641, "price": 45.0, "click_share_rank": 0, "weekly_search_volume": 10000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-01", "week_date": "2023-10-01", "keywords": "wireless headphones", "competitor_brand": "BetaSound", "asin": "Bet019", "product_title": "BetaSound wireless headphones", "country_code": "US", "average_organic_rank": 20, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 7, "click_share": 0.1972, "impression_share": 0.2169, "price": 35.0, "click_share_rank": 0, "weekly_search_volume": 10000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-01", "week_date": "2023-10-01", "keywords": "wireless headphones", "competitor_brand": "GammaListen", "asin": "Gam019", "product_title": "GammaListen wireless headphones", "country_code": "US", "average_organic_rank": 36, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0371, "impression_share": 0.0408, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 10000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-01", "week_date": "2023-10-01", "keywords": "wireless headphones", "competitor_brand": "OmegaEar", "asin": "Ome019", "product_title": "OmegaEar wireless headphones", "country_code": "US", "average_organic_rank": 34, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0528, "impression_share": 0.0581, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 10000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-01", "week_date": "2023-10-01", "keywords": "bluetooth earbuds", "competitor_brand": "YabaTech", "asin": "Yab017", "product_title": "YabaTech bluetooth earbuds", "country_code": "US", "average_organic_rank": 24, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.1513, "impression_share": 0.1664, "price": 49.99, "click_share_rank": 0, "weekly_search_volume": 10000, "is_yaba_asin": "Y", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-01", "week_date": "2023-10-01", "keywords": "bluetooth earbuds", "competitor_brand": "AlphaAudio", "asin": "Alp017", "product_title": "AlphaAudio bluetooth earbuds", "country_code": "US", "average_organic_rank": 15, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.2437, "impression_share": 0.2681, "price": 45.0, "click_share_rank": 0, "weekly_search_volume": 10000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-01", "week_date": "2023-10-01", "keywords": "bluetooth earbuds", "competitor_brand": "BetaSound", "asin": "Bet017", "product_title": "BetaSound bluetooth earbuds", "country_code": "US", "average_organic_rank": 21, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 7, "click_share": 0.1861, "impression_share": 0.2047, "price": 35.0, "click_share_rank": 0, "weekly_search_volume": 10000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-01", "week_date": "2023-10-01", "keywords": "bluetooth earbuds", "competitor_brand": "GammaListen", "asin": "Gam017", "product_title": "GammaListen bluetooth earbuds", "country_code": "US", "average_organic_rank": 36, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0379, "impression_share": 0.0417, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 10000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-01", "week_date": "2023-10-01", "keywords": "bluetooth earbuds", "competitor_brand": "OmegaEar", "asin": "Ome017", "product_title": "OmegaEar bluetooth earbuds", "country_code": "US", "average_organic_rank": 34, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0567, "impression_share": 0.0623, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 10000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-01", "week_date": "2023-10-01", "keywords": "noise cancelling headphones", "competitor_brand": "YabaTech", "asin": "Yab027", "product_title": "YabaTech noise cancelling headphones", "country_code": "US", "average_organic_rank": 24, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.1592, "impression_share": 0.1751, "price": 49.99, "click_share_rank": 0, "weekly_search_volume": 10000, "is_yaba_asin": "Y", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-01", "week_date": "2023-10-01", "keywords": "noise cancelling headphones", "competitor_brand": "AlphaAudio", "asin": "Alp027", "product_title": "AlphaAudio noise cancelling headphones", "country_code": "US", "average_organic_rank": 15, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.2472, "impression_share": 0.2719, "price": 45.0, "click_share_rank": 0, "weekly_search_volume": 10000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-01", "week_date": "2023-10-01", "keywords": "noise cancelling headphones", "competitor_brand": "BetaSound", "asin": "Bet027", "product_title": "BetaSound noise cancelling headphones", "country_code": "US", "average_organic_rank": 22, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 7, "click_share": 0.1761, "impression_share": 0.1937, "price": 35.0, "click_share_rank": 0, "weekly_search_volume": 10000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-01", "week_date": "2023-10-01", "keywords": "noise cancelling headphones", "competitor_brand": "GammaListen", "asin": "Gam027", "product_title": "GammaListen noise cancelling headphones", "country_code": "US", "average_organic_rank": 34, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0519, "impression_share": 0.0571, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 10000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-01", "week_date": "2023-10-01", "keywords": "noise cancelling headphones", "competitor_brand": "OmegaEar", "asin": "Ome027", "product_title": "OmegaEar noise cancelling headphones", "country_code": "US", "average_organic_rank": 35, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0451, "impression_share": 0.0496, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 10000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-08", "week_date": "2023-10-08", "keywords": "wireless headphones", "competitor_brand": "YabaTech", "asin": "Yab119", "product_title": "YabaTech wireless headphones", "country_code": "US", "average_organic_rank": 21, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.1877, "impression_share": 0.2065, "price": 49.99, "click_share_rank": 0, "weekly_search_volume": 10500, "is_yaba_asin": "Y", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-08", "week_date": "2023-10-08", "keywords": "wireless headphones", "competitor_brand": "AlphaAudio", "asin": "Alp119", "product_title": "AlphaAudio wireless headphones", "country_code": "US", "average_organic_rank": 16, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.2389, "impression_share": 0.2628, "price": 45.0, "click_share_rank": 0, "weekly_search_volume": 10500, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-08", "week_date": "2023-10-08", "keywords": "wireless headphones", "competitor_brand": "BetaSound", "asin": "Bet119", "product_title": "BetaSound wireless headphones", "country_code": "US", "average_organic_rank": 21, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 7, "click_share": 0.1857, "impression_share": 0.2043, "price": 35.0, "click_share_rank": 0, "weekly_search_volume": 10500, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-08", "week_date": "2023-10-08", "keywords": "wireless headphones", "competitor_brand": "GammaListen", "asin": "Gam119", "product_title": "GammaListen wireless headphones", "country_code": "US", "average_organic_rank": 32, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0713, "impression_share": 0.0784, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 10500, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-08", "week_date": "2023-10-08", "keywords": "wireless headphones", "competitor_brand": "OmegaEar", "asin": "Ome119", "product_title": "OmegaEar wireless headphones", "country_code": "US", "average_organic_rank": 36, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0369, "impression_share": 0.0406, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 10500, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-08", "week_date": "2023-10-08", "keywords": "bluetooth earbuds", "competitor_brand": "YabaTech", "asin": "Yab117", "product_title": "YabaTech bluetooth earbuds", "country_code": "US", "average_organic_rank": 19, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.2074, "impression_share": 0.2281, "price": 49.99, "click_share_rank": 0, "weekly_search_volume": 10500, "is_yaba_asin": "Y", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-08", "week_date": "2023-10-08", "keywords": "bluetooth earbuds", "competitor_brand": "AlphaAudio", "asin": "Alp117", "product_title": "AlphaAudio bluetooth earbuds", "country_code": "US", "average_organic_rank": 13, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.2639, "impression_share": 0.2903, "price": 45.0, "click_share_rank": 0, "weekly_search_volume": 10500, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-08", "week_date": "2023-10-08", "keywords": "bluetooth earbuds", "competitor_brand": "BetaSound", "asin": "Bet117", "product_title": "BetaSound bluetooth earbuds", "country_code": "US", "average_organic_rank": 21, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 7, "click_share": 0.1881, "impression_share": 0.207, "price": 35.0, "click_share_rank": 0, "weekly_search_volume": 10500, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-08", "week_date": "2023-10-08", "keywords": "bluetooth earbuds", "competitor_brand": "GammaListen", "asin": "Gam117", "product_title": "GammaListen bluetooth earbuds", "country_code": "US", "average_organic_rank": 35, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0424, "impression_share": 0.0467, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 10500, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-08", "week_date": "2023-10-08", "keywords": "bluetooth earbuds", "competitor_brand": "OmegaEar", "asin": "Ome117", "product_title": "OmegaEar bluetooth earbuds", "country_code": "US", "average_organic_rank": 34, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0513, "impression_share": 0.0564, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 10500, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-08", "week_date": "2023-10-08", "keywords": "noise cancelling headphones", "competitor_brand": "YabaTech", "asin": "Yab127", "product_title": "YabaTech noise cancelling headphones", "country_code": "US", "average_organic_rank": 20, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.1994, "impression_share": 0.2193, "price": 49.99, "click_share_rank": 0, "weekly_search_volume": 10500, "is_yaba_asin": "Y", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-08", "week_date": "2023-10-08", "keywords": "noise cancelling headphones", "competitor_brand": "AlphaAudio", "asin": "Alp127", "product_title": "AlphaAudio noise cancelling headphones", "country_code": "US", "average_organic_rank": 18, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.2184, "impression_share": 0.2402, "price": 45.0, "click_share_rank": 0, "weekly_search_volume": 10500, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-08", "week_date": "2023-10-08", "keywords": "noise cancelling headphones", "competitor_brand": "BetaSound", "asin": "Bet127", "product_title": "BetaSound noise cancelling headphones", "country_code": "US", "average_organic_rank": 23, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 7, "click_share": 0.1675, "impression_share": 0.1843, "price": 35.0, "click_share_rank": 0, "weekly_search_volume": 10500, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-08", "week_date": "2023-10-08", "keywords": "noise cancelling headphones", "competitor_brand": "GammaListen", "asin": "Gam127", "product_title": "GammaListen noise cancelling headphones", "country_code": "US", "average_organic_rank": 34, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0598, "impression_share": 0.0658, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 10500, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-08", "week_date": "2023-10-08", "keywords": "noise cancelling headphones", "competitor_brand": "OmegaEar", "asin": "Ome127", "product_title": "OmegaEar noise cancelling headphones", "country_code": "US", "average_organic_rank": 34, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0577, "impression_share": 0.0634, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 10500, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-15", "week_date": "2023-10-15", "keywords": "wireless headphones", "competitor_brand": "YabaTech", "asin": "Yab219", "product_title": "YabaTech wireless headphones", "country_code": "US", "average_organic_rank": 16, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.2382, "impression_share": 0.262, "price": 49.99, "click_share_rank": 0, "weekly_search_volume": 11000, "is_yaba_asin": "Y", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-15", "week_date": "2023-10-15", "keywords": "wireless headphones", "competitor_brand": "AlphaAudio", "asin": "Alp219", "product_title": "AlphaAudio wireless headphones", "country_code": "US", "average_organic_rank": 19, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.21, "impression_share": 0.2309, "price": 45.0, "click_share_rank": 0, "weekly_search_volume": 11000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-15", "week_date": "2023-10-15", "keywords": "wireless headphones", "competitor_brand": "BetaSound", "asin": "Bet219", "product_title": "BetaSound wireless headphones", "country_code": "US", "average_organic_rank": 22, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 7, "click_share": 0.1769, "impression_share": 0.1946, "price": 35.0, "click_share_rank": 0, "weekly_search_volume": 11000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-15", "week_date": "2023-10-15", "keywords": "wireless headphones", "competitor_brand": "GammaListen", "asin": "Gam219", "product_title": "GammaListen wireless headphones", "country_code": "US", "average_organic_rank": 34, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0592, "impression_share": 0.0651, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 11000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-15", "week_date": "2023-10-15", "keywords": "wireless headphones", "competitor_brand": "OmegaEar", "asin": "Ome219", "product_title": "OmegaEar wireless headphones", "country_code": "US", "average_organic_rank": 34, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.051, "impression_share": 0.0561, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 11000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-15", "week_date": "2023-10-15", "keywords": "bluetooth earbuds", "competitor_brand": "YabaTech", "asin": "Yab217", "product_title": "YabaTech bluetooth earbuds", "country_code": "US", "average_organic_rank": 12, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.2756, "impression_share": 0.3031, "price": 49.99, "click_share_rank": 0, "weekly_search_volume": 11000, "is_yaba_asin": "Y", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-15", "week_date": "2023-10-15", "keywords": "bluetooth earbuds", "competitor_brand": "AlphaAudio", "asin": "Alp217", "product_title": "AlphaAudio bluetooth earbuds", "country_code": "US", "average_organic_rank": 17, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.2284, "impression_share": 0.2512, "price": 45.0, "click_share_rank": 0, "weekly_search_volume": 11000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-15", "week_date": "2023-10-15", "keywords": "bluetooth earbuds", "competitor_brand": "BetaSound", "asin": "Bet217", "product_title": "BetaSound bluetooth earbuds", "country_code": "US", "average_organic_rank": 22, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 7, "click_share": 0.172, "impression_share": 0.1892, "price": 35.0, "click_share_rank": 0, "weekly_search_volume": 11000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-15", "week_date": "2023-10-15", "keywords": "bluetooth earbuds", "competitor_brand": "GammaListen", "asin": "Gam217", "product_title": "GammaListen bluetooth earbuds", "country_code": "US", "average_organic_rank": 35, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0498, "impression_share": 0.0548, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 11000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-15", "week_date": "2023-10-15", "keywords": "bluetooth earbuds", "competitor_brand": "OmegaEar", "asin": "Ome217", "product_title": "OmegaEar bluetooth earbuds", "country_code": "US", "average_organic_rank": 35, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0441, "impression_share": 0.0485, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 11000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-15", "week_date": "2023-10-15", "keywords": "noise cancelling headphones", "competitor_brand": "YabaTech", "asin": "Yab227", "product_title": "YabaTech noise cancelling headphones", "country_code": "US", "average_organic_rank": 16, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.231, "impression_share": 0.2541, "price": 49.99, "click_share_rank": 0, "weekly_search_volume": 11000, "is_yaba_asin": "Y", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-15", "week_date": "2023-10-15", "keywords": "noise cancelling headphones", "competitor_brand": "AlphaAudio", "asin": "Alp227", "product_title": "AlphaAudio noise cancelling headphones", "country_code": "US", "average_organic_rank": 18, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.2184, "impression_share": 0.2402, "price": 45.0, "click_share_rank": 0, "weekly_search_volume": 11000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-15", "week_date": "2023-10-15", "keywords": "noise cancelling headphones", "competitor_brand": "BetaSound", "asin": "Bet227", "product_title": "BetaSound noise cancelling headphones", "country_code": "US", "average_organic_rank": 23, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 7, "click_share": 0.1682, "impression_share": 0.185, "price": 35.0, "click_share_rank": 0, "weekly_search_volume": 11000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-15", "week_date": "2023-10-15", "keywords": "noise cancelling headphones", "competitor_brand": "GammaListen", "asin": "Gam227", "product_title": "GammaListen noise cancelling headphones", "country_code": "US", "average_organic_rank": 34, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0578, "impression_share": 0.0635, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 11000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-15", "week_date": "2023-10-15", "keywords": "noise cancelling headphones", "competitor_brand": "OmegaEar", "asin": "Ome227", "product_title": "OmegaEar noise cancelling headphones", "country_code": "US", "average_organic_rank": 34, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0565, "impression_share": 0.0621, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 11000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-22", "week_date": "2023-10-22", "keywords": "wireless headphones", "competitor_brand": "YabaTech", "asin": "Yab319", "product_title": "YabaTech wireless headphones", "country_code": "US", "average_organic_rank": 9, "weekly_number_of_days_with_deal": 7, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.3048, "impression_share": 0.3353, "price": 42.0, "click_share_rank": 0, "weekly_search_volume": 11500, "is_yaba_asin": "Y", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-22", "week_date": "2023-10-22", "keywords": "wireless headphones", "competitor_brand": "AlphaAudio", "asin": "Alp319", "product_title": "AlphaAudio wireless headphones", "country_code": "US", "average_organic_rank": 19, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.2061, "impression_share": 0.2267, "price": 45.0, "click_share_rank": 0, "weekly_search_volume": 11500, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-22", "week_date": "2023-10-22", "keywords": "wireless headphones", "competitor_brand": "BetaSound", "asin": "Bet319", "product_title": "BetaSound wireless headphones", "country_code": "US", "average_organic_rank": 22, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 7, "click_share": 0.17, "impression_share": 0.187, "price": 35.0, "click_share_rank": 0, "weekly_search_volume": 11500, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-22", "week_date": "2023-10-22", "keywords": "wireless headphones", "competitor_brand": "GammaListen", "asin": "Gam319", "product_title": "GammaListen wireless headphones", "country_code": "US", "average_organic_rank": 34, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0517, "impression_share": 0.0569, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 11500, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-22", "week_date": "2023-10-22", "keywords": "wireless headphones", "competitor_brand": "OmegaEar", "asin": "Ome319", "product_title": "OmegaEar wireless headphones", "country_code": "US", "average_organic_rank": 35, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0481, "impression_share": 0.0529, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 11500, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-22", "week_date": "2023-10-22", "keywords": "bluetooth earbuds", "competitor_brand": "YabaTech", "asin": "Yab317", "product_title": "YabaTech bluetooth earbuds", "country_code": "US", "average_organic_rank": 9, "weekly_number_of_days_with_deal": 7, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.3032, "impression_share": 0.3336, "price": 42.0, "click_share_rank": 0, "weekly_search_volume": 11500, "is_yaba_asin": "Y", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-22", "week_date": "2023-10-22", "keywords": "bluetooth earbuds", "competitor_brand": "AlphaAudio", "asin": "Alp317", "product_title": "AlphaAudio bluetooth earbuds", "country_code": "US", "average_organic_rank": 19, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.2031, "impression_share": 0.2234, "price": 45.0, "click_share_rank": 0, "weekly_search_volume": 11500, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-22", "week_date": "2023-10-22", "keywords": "bluetooth earbuds", "competitor_brand": "BetaSound", "asin": "Bet317", "product_title": "BetaSound bluetooth earbuds", "country_code": "US", "average_organic_rank": 23, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 7, "click_share": 0.1659, "impression_share": 0.1825, "price": 35.0, "click_share_rank": 0, "weekly_search_volume": 11500, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-22", "week_date": "2023-10-22", "keywords": "bluetooth earbuds", "competitor_brand": "GammaListen", "asin": "Gam317", "product_title": "GammaListen bluetooth earbuds", "country_code": "US", "average_organic_rank": 36, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0371, "impression_share": 0.0408, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 11500, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-22", "week_date": "2023-10-22", "keywords": "bluetooth earbuds", "competitor_brand": "OmegaEar", "asin": "Ome317", "product_title": "OmegaEar bluetooth earbuds", "country_code": "US", "average_organic_rank": 35, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0452, "impression_share": 0.0497, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 11500, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-22", "week_date": "2023-10-22", "keywords": "noise cancelling headphones", "competitor_brand": "YabaTech", "asin": "Yab327", "product_title": "YabaTech noise cancelling headphones", "country_code": "US", "average_organic_rank": 10, "weekly_number_of_days_with_deal": 7, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.2986, "impression_share": 0.3284, "price": 42.0, "click_share_rank": 0, "weekly_search_volume": 11500, "is_yaba_asin": "Y", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-22", "week_date": "2023-10-22", "keywords": "noise cancelling headphones", "competitor_brand": "AlphaAudio", "asin": "Alp327", "product_title": "AlphaAudio noise cancelling headphones", "country_code": "US", "average_organic_rank": 20, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.1995, "impression_share": 0.2195, "price": 45.0, "click_share_rank": 0, "weekly_search_volume": 11500, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-22", "week_date": "2023-10-22", "keywords": "noise cancelling headphones", "competitor_brand": "BetaSound", "asin": "Bet327", "product_title": "BetaSound noise cancelling headphones", "country_code": "US", "average_organic_rank": 20, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 7, "click_share": 0.1904, "impression_share": 0.2094, "price": 35.0, "click_share_rank": 0, "weekly_search_volume": 11500, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-22", "week_date": "2023-10-22", "keywords": "noise cancelling headphones", "competitor_brand": "GammaListen", "asin": "Gam327", "product_title": "GammaListen noise cancelling headphones", "country_code": "US", "average_organic_rank": 34, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0546, "impression_share": 0.0601, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 11500, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-22", "week_date": "2023-10-22", "keywords": "noise cancelling headphones", "competitor_brand": "OmegaEar", "asin": "Ome327", "product_title": "OmegaEar noise cancelling headphones", "country_code": "US", "average_organic_rank": 33, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0632, "impression_share": 0.0695, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 11500, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-29", "week_date": "2023-10-29", "keywords": "wireless headphones", "competitor_brand": "YabaTech", "asin": "Yab419", "product_title": "YabaTech wireless headphones", "country_code": "US", "average_organic_rank": 4, "weekly_number_of_days_with_deal": 7, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.3587, "impression_share": 0.3945, "price": 42.0, "click_share_rank": 0, "weekly_search_volume": 12000, "is_yaba_asin": "Y", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-29", "week_date": "2023-10-29", "keywords": "wireless headphones", "competitor_brand": "AlphaAudio", "asin": "Alp419", "product_title": "AlphaAudio wireless headphones", "country_code": "US", "average_organic_rank": 22, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.1701, "impression_share": 0.1871, "price": 45.0, "click_share_rank": 0, "weekly_search_volume": 12000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-29", "week_date": "2023-10-29", "keywords": "wireless headphones", "competitor_brand": "BetaSound", "asin": "Bet419", "product_title": "BetaSound wireless headphones", "country_code": "US", "average_organic_rank": 22, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 7, "click_share": 0.1726, "impression_share": 0.1898, "price": 35.0, "click_share_rank": 0, "weekly_search_volume": 12000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-29", "week_date": "2023-10-29", "keywords": "wireless headphones", "competitor_brand": "GammaListen", "asin": "Gam419", "product_title": "GammaListen wireless headphones", "country_code": "US", "average_organic_rank": 35, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0484, "impression_share": 0.0533, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 12000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-29", "week_date": "2023-10-29", "keywords": "wireless headphones", "competitor_brand": "OmegaEar", "asin": "Ome419", "product_title": "OmegaEar wireless headphones", "country_code": "US", "average_organic_rank": 33, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0621, "impression_share": 0.0683, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 12000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-29", "week_date": "2023-10-29", "keywords": "bluetooth earbuds", "competitor_brand": "YabaTech", "asin": "Yab417", "product_title": "YabaTech bluetooth earbuds", "country_code": "US", "average_organic_rank": 5, "weekly_number_of_days_with_deal": 7, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.3498, "impression_share": 0.3847, "price": 42.0, "click_share_rank": 0, "weekly_search_volume": 12000, "is_yaba_asin": "Y", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-29", "week_date": "2023-10-29", "keywords": "bluetooth earbuds", "competitor_brand": "AlphaAudio", "asin": "Alp417", "product_title": "AlphaAudio bluetooth earbuds", "country_code": "US", "average_organic_rank": 22, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.1734, "impression_share": 0.1907, "price": 45.0, "click_share_rank": 0, "weekly_search_volume": 12000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-29", "week_date": "2023-10-29", "keywords": "bluetooth earbuds", "competitor_brand": "BetaSound", "asin": "Bet417", "product_title": "BetaSound bluetooth earbuds", "country_code": "US", "average_organic_rank": 21, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 7, "click_share": 0.1826, "impression_share": 0.2008, "price": 35.0, "click_share_rank": 0, "weekly_search_volume": 12000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-29", "week_date": "2023-10-29", "keywords": "bluetooth earbuds", "competitor_brand": "GammaListen", "asin": "Gam417", "product_title": "GammaListen bluetooth earbuds", "country_code": "US", "average_organic_rank": 34, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0536, "impression_share": 0.059, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 12000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-29", "week_date": "2023-10-29", "keywords": "bluetooth earbuds", "competitor_brand": "OmegaEar", "asin": "Ome417", "product_title": "OmegaEar bluetooth earbuds", "country_code": "US", "average_organic_rank": 34, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0531, "impression_share": 0.0585, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 12000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-29", "week_date": "2023-10-29", "keywords": "noise cancelling headphones", "competitor_brand": "YabaTech", "asin": "Yab427", "product_title": "YabaTech noise cancelling headphones", "country_code": "US", "average_organic_rank": 5, "weekly_number_of_days_with_deal": 7, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.3465, "impression_share": 0.3812, "price": 42.0, "click_share_rank": 0, "weekly_search_volume": 12000, "is_yaba_asin": "Y", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-29", "week_date": "2023-10-29", "keywords": "noise cancelling headphones", "competitor_brand": "AlphaAudio", "asin": "Alp427", "product_title": "AlphaAudio noise cancelling headphones", "country_code": "US", "average_organic_rank": 23, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 7, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.1661, "impression_share": 0.1827, "price": 45.0, "click_share_rank": 0, "weekly_search_volume": 12000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-29", "week_date": "2023-10-29", "keywords": "noise cancelling headphones", "competitor_brand": "BetaSound", "asin": "Bet427", "product_title": "BetaSound noise cancelling headphones", "country_code": "US", "average_organic_rank": 21, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 7, "click_share": 0.1861, "impression_share": 0.2047, "price": 35.0, "click_share_rank": 0, "weekly_search_volume": 12000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-29", "week_date": "2023-10-29", "keywords": "noise cancelling headphones", "competitor_brand": "GammaListen", "asin": "Gam427", "product_title": "GammaListen noise cancelling headphones", "country_code": "US", "average_organic_rank": 34, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.0521, "impression_share": 0.0573, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 12000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}, {"brand_aggregation": "Electronics", "parent_asin": "PARENT123", "reporting_date": "2023-10-29", "week_date": "2023-10-29", "keywords": "noise cancelling headphones", "competitor_brand": "OmegaEar", "asin": "Ome427", "product_title": "OmegaEar noise cancelling headphones", "country_code": "US", "average_organic_rank": 35, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 0.043, "impression_share": 0.0473, "price": 60.0, "click_share_rank": 0, "weekly_search_volume": 12000, "is_yaba_asin": "N", "keywords_link": "#", "grams": 250, "organic_or_not": "Organic", "container": "Container"}];

        // --- 2. LOGIC & PROCESSING ---
        
        let processedData = [];
        let ourBrandName = "";
        let weeks = [];
        let topCompetitors = [];
        
        // Load Google Charts
        google.charts.load('current', {'packages':['corechart', 'table']});
        google.charts.setOnLoadCallback(initDashboard);

        function initDashboard() {
            processData();
            drawCharts();
            populateInsights();
            setupComparator();
        }

        function processData() {
            // 2.1 Identify Our Brand (as per prompt: competitor_brand of is_yaba_asin='Y')
            const yabaAsin = rawData.find(d => d.is_yaba_asin === 'Y');
            ourBrandName = yabaAsin ? yabaAsin.competitor_brand : "Unknown Brand";
            
            // 2.2 Parse & Sort Weeks
            weeks = [...new Set(rawData.map(d => d.week_date))].sort();

            // 2.3 Aggregate Data for Analysis
            // We need to group by Brand to find Top 3
            const brandShares = {};
            rawData.forEach(d => {
                const b = d.competitor_brand || "Unknown";
                if (!brandShares[b]) brandShares[b] = 0;
                brandShares[b] += d.click_share;
            });
            
            // Sort brands by total share
            const sortedBrands = Object.entries(brandShares)
                .sort((a,b) => b[1] - a[1])
                .map(e => e[0])
                .filter(b => b !== ourBrandName); // Exclude us from comp list
            
            topCompetitors = sortedBrands.slice(0, 3);
        }

        function drawCharts() {
            // --- Chart 1: Global Trend (Volume vs Share Split) ---
            const trendData = [['Week', 'Our Share', 'Competitor Share', 'Search Volume']];
            
            weeks.forEach(week => {
                const weekData = rawData.filter(d => d.week_date === week);
                const vol = weekData[0].weekly_search_volume || 0;
                
                let ourShare = 0;
                let compShare = 0;
                
                weekData.forEach(d => {
                    if (d.competitor_brand === ourBrandName) ourShare += d.click_share;
                    else compShare += d.click_share;
                });
                
                // Average share across keywords for the week
                const kwCount = [...new Set(weekData.map(d => d.keywords))].length;
                ourShare = ourShare / kwCount;
                compShare = compShare / kwCount;

                trendData.push([week, ourShare, compShare, vol]);
            });

            const data1 = google.visualization.arrayToDataTable(trendData);
            const options1 = {
                seriesType: 'bars',
                series: {
                    0: {type: 'line', targetAxisIndex: 1, color: '#4285F4'}, // Us
                    1: {type: 'line', targetAxisIndex: 1, color: '#EA4335'}, // Comp
                    2: {type: 'bars', targetAxisIndex: 0, color: '#E8EAED'}  // Volume
                },
                vAxes: {
                    0: {title: 'Volume', textStyle:{color: '#999'}},
                    1: {title: 'Click Share', format: 'percent'}
                },
                legend: {position: 'bottom'},
                chartArea: {width: '85%', height: '70%'}
            };
            const chart1 = new google.visualization.ComboChart(document.getElementById('chart_global_trend'));
            chart1.draw(data1, options1);

            // Populate Section 1 Text
            const lastWeek = trendData[trendData.length-1];
            const prevWeek = trendData[trendData.length-2];
            const trendText = lastWeek[1] > prevWeek[1] ? "GANA TRACCIÓN" : "PIERDE TRACCIÓN";
            const color = lastWeek[1] > prevWeek[1] ? "green" : "red";
            document.getElementById('global_trend_insight').innerHTML = `
                <span class="material-icons" style="color:${color}">trending_${lastWeek[1] > prevWeek[1] ? 'up' : 'down'}</span>
                <div>
                    <strong>Estado Actual:</strong> El parent ASIN <span style="color:${color}">${trendText}</span> en la última semana. 
                    Nuestra cuota pasó de ${(prevWeek[1]*100).toFixed(1)}% a ${(lastWeek[1]*100).toFixed(1)}%.
                </div>
            `;


            // --- Chart 2: Brand Competitiveness (Line Chart) ---
            const compHeader = ['Week', ourBrandName, ...topCompetitors, 'Resto del Mercado'];
            const compRows = [];

            weeks.forEach(week => {
                const weekData = rawData.filter(d => d.week_date === week);
                const kwCount = [...new Set(weekData.map(d => d.keywords))].length;
                
                let row = [week, 0, 0, 0, 0, 0]; // Init
                
                weekData.forEach(d => {
                    if (d.competitor_brand === ourBrandName) row[1] += d.click_share;
                    else if (d.competitor_brand === topCompetitors[0]) row[2] += d.click_share;
                    else if (d.competitor_brand === topCompetitors[1]) row[3] += d.click_share;
                    else if (d.competitor_brand === topCompetitors[2]) row[4] += d.click_share;
                    else row[5] += d.click_share;
                });
                
                // Average
                for(let i=1; i<=5; i++) row[i] = row[i] / kwCount;
                compRows.push(row);
            });

            const data2 = google.visualization.arrayToDataTable([compHeader, ...compRows]);
            const options2 = {
                curveType: 'function',
                legend: { position: 'bottom' },
                colors: ['#4285F4', '#EA4335', '#FBBC05', '#34A853', '#9AA0A6'],
                vAxis: { format: 'percent' },
                chartArea: {width: '90%', height: '70%'}
            };
            const chart2 = new google.visualization.LineChart(document.getElementById('chart_brand_comp'));
            chart2.draw(data2, options2);

            // Populate Top Competitors Text
            let compsHTML = '';
            topCompetitors.forEach((comp, idx) => {
                const lastShare = compRows[compRows.length-1][idx+2];
                compsHTML += `
                <div class="metric-box" style="background:white; border:1px solid #eee;">
                    <div class="metric-label">${comp}</div>
                    <div class="metric-value" style="font-size:18px;">${(lastShare*100).toFixed(1)}%</div>
                    <div class="metric-label">Share Actual</div>
                </div>`;
            });
            document.getElementById('top_competitors_metrics').innerHTML = compsHTML;


            // --- Chart 4: Efficiency (Scatter) ---
            // X: Rank (Inverted), Y: Share, Color: Us vs Them
            const scatterData = [['Organic Rank', 'Click Share', {'type': 'string', 'role': 'style'}, {'type': 'string', 'role': 'tooltip'}]];
            
            // Filter only last week for cleanliness
            const lastWeekData = rawData.filter(d => d.week_date === weeks[weeks.length-1]);
            
            lastWeekData.forEach(d => {
                const color = d.competitor_brand === ourBrandName ? '#4285F4' : '#999999';
                const label = `${d.competitor_brand} (${d.keywords}): Rank ${d.average_organic_rank}, Share ${(d.click_share*100).toFixed(1)}%`;
                // Invert rank visually by using negative or just axis setup. Let's use raw rank but invert axis in options.
                scatterData.push([d.average_organic_rank, d.click_share, `point {fill-color: ${color}}`, label]);
            });

            const data4 = google.visualization.arrayToDataTable(scatterData);
            const options4 = {
                hAxis: { title: 'Organic Rank (Lower is Better)', direction: -1 },
                vAxis: { title: 'Click Share', format: 'percent' },
                legend: 'none',
                chartArea: {width: '85%', height: '70%'}
            };
            const chart4 = new google.visualization.ScatterChart(document.getElementById('chart_efficiency'));
            chart4.draw(data4, options4);
        }

        function populateInsights() {
            // --- Section 3: Levers ---
            // Calculate Deal Impact
            const dealWeeks = rawData.filter(d => d.weekly_number_of_days_with_deal > 0 && d.competitor_brand === ourBrandName);
            const noDealWeeks = rawData.filter(d => d.weekly_number_of_days_with_deal === 0 && d.competitor_brand === ourBrandName);
            
            const avgShareDeal = dealWeeks.length ? (dealWeeks.reduce((a,b)=>a+b.click_share,0)/dealWeeks.length) : 0;
            const avgShareNoDeal = noDealWeeks.length ? (noDealWeeks.reduce((a,b)=>a+b.click_share,0)/noDealWeeks.length) : 0;
            
            const lift = avgShareNoDeal > 0 ? ((avgShareDeal - avgShareNoDeal) / avgShareNoDeal * 100).toFixed(1) : 0;
            
            document.getElementById('deal_impact').innerText = `+${lift}%`;
            document.getElementById('deal_impact').style.color = lift > 0 ? 'var(--success)' : 'var(--gray)';

            // Populate Table
            const tbody = document.querySelector('#levers_table tbody');
            const allBrands = [ourBrandName, ...topCompetitors];
            
            allBrands.forEach(b => {
                const bData = rawData.filter(d => d.competitor_brand === b);
                const bDeals = bData.filter(d => d.weekly_number_of_days_with_deal > 0 || d.weekly_number_of_days_with_coupon > 0);
                const bNoDeals = bData.filter(d => d.weekly_number_of_days_with_deal === 0 && d.weekly_number_of_days_with_coupon === 0);
                
                const s1 = bNoDeals.length ? (bNoDeals.reduce((x,y)=>x+y.click_share,0)/bNoDeals.length) : 0;
                const s2 = bDeals.length ? (bDeals.reduce((x,y)=>x+y.click_share,0)/bDeals.length) : 0;
                const l = s1 > 0 ? ((s2-s1)/s1*100).toFixed(0) : 0;
                
                const tr = `<tr>
                    <td>${b}</td>
                    <td>${(s1*100).toFixed(1)}%</td>
                    <td>${(s2*100).toFixed(1)}%</td>
                    <td style="color:${l>0?'green':'red'}">${l > 0 ? '+' : ''}${l}%</td>
                </tr>`;
                tbody.innerHTML += tr;
            });

            // --- Section 5: Conclusions ---
            const insightsList = document.getElementById('insights_list');
            const recsList = document.getElementById('recommendations_list');
            const otherList = document.getElementById('other_insights_list');

            // Generate Insights based on data
            const lastWk = weeks[weeks.length-1];
            const ourLastData = rawData.filter(d => d.competitor_brand === ourBrandName && d.week_date === lastWk);
            const ourAvgRank = ourLastData.reduce((a,b)=>a+b.average_organic_rank,0)/ourLastData.length;
            const hasDeal = ourLastData.some(d => d.weekly_number_of_days_with_deal > 0);

            // Insight 1: Trend
            insightsList.innerHTML += `<li class="insight-item"><span class="material-icons insight-icon">trending_up</span> Tendencia General: ${lift > 10 ? 'Alta sensibilidad a promociones.' : 'Crecimiento orgánico estable.'}</li>`;
            
            // Insight 2: Rank
            insightsList.innerHTML += `<li class="insight-item"><span class="material-icons insight-icon">format_list_numbered</span> Ranking: Posición promedio actual es #${Math.round(ourAvgRank)}. ${ourAvgRank < 10 ? 'Excelente visibilidad.' : 'Oportunidad de mejora SEO.'}</li>`;
            
            // Insight 3: Competitor
            insightsList.innerHTML += `<li class="insight-item"><span class="material-icons insight-icon">warning</span> Amenaza: ${topCompetitors[0]} mantiene un share sólido del ${(parseFloat(document.querySelector('#top_competitors_metrics .metric-value').innerText)).toFixed(1)}%.</li>`;

            // Insight 4: Price
            insightsList.innerHTML += `<li class="insight-item"><span class="material-icons insight-icon">attach_money</span> Precio: ${hasDeal ? 'El precio promocional actual está impulsando la conversión.' : 'Precio estándar activo.'}</li>`;

            // Insight 5: Efficiency
            insightsList.innerHTML += `<li class="insight-item"><span class="material-icons insight-icon">speed</span> Eficiencia: ${ourAvgRank < 15 ? 'Alta eficiencia Rank -> Share.' : 'Baja eficiencia, revisar título e imagen principal.'}</li>`;

            // Recommendations
            if (lift > 15) {
                recsList.innerHTML += `<li class="insight-item"><span class="material-icons insight-icon">check_circle</span> Mantener cadencia de Deals quincenales dado el alto lift (+${lift}%).</li>`;
            } else {
                recsList.innerHTML += `<li class="insight-item"><span class="material-icons insight-icon">check_circle</span> Enfocarse en optimización orgánica (SEO) ya que las promociones tienen impacto moderado.</li>`;
            }
            
            if (ourAvgRank > 15) {
                recsList.innerHTML += `<li class="insight-item"><span class="material-icons insight-icon">check_circle</span> Revisar keywords de backend para mejorar ranking orgánico.</li>`;
            } else {
                recsList.innerHTML += `<li class="insight-item"><span class="material-icons insight-icon">check_circle</span> Defender posiciones Top 10 con cupones defensivos si la competencia ataca.</li>`;
            }
            
            recsList.innerHTML += `<li class="insight-item"><span class="material-icons insight-icon">check_circle</span> Analizar creatividad (imágenes A+) de ${topCompetitors[0]} para igualar CTR.</li>`;
            
            // Other Insights
            otherList.innerHTML += `<li class="insight-item">Se detecta una correlación inversa fuerte entre Ranking y Share para ${topCompetitors[1]}, sugiriendo que dependen mucho de la posición orgánica.</li>`;
             otherList.innerHTML += `<li class="insight-item">La categoría muestra estabilidad de volumen de búsqueda, indicando demanda madura.</li>`;

        }

        function setupComparator() {
            const weekSel = document.getElementById('comp_week_select');
            const compSel = document.getElementById('comp_competitor_select');
            
            weeks.forEach(w => {
                const opt = document.createElement('option');
                opt.value = w;
                opt.text = w;
                weekSel.add(opt);
            });
            // Select last week by default
            weekSel.value = weeks[weeks.length-1];

            topCompetitors.forEach(c => {
                const opt = document.createElement('option');
                opt.value = c;
                opt.text = c;
                compSel.add(opt);
            });
            
            updateComparator();
        }

        function updateComparator() {
            const week = document.getElementById('comp_week_select').value;
            const comp = document.getElementById('comp_competitor_select').value;
            
            // Filter Data
            const ourData = rawData.filter(d => d.week_date === week && d.competitor_brand === ourBrandName);
            const theirData = rawData.filter(d => d.week_date === week && d.competitor_brand === comp);
            
            // Averages
            const calcAvg = (arr, key) => arr.length ? arr.reduce((a,b)=>a+b[key],0)/arr.length : 0;
            
            // Render Us
            document.getElementById('comp_our_name').innerText = ourBrandName;
            document.getElementById('our_share').innerText = (calcAvg(ourData, 'click_share')*100).toFixed(1) + '%';
            document.getElementById('our_price').innerText = '$' + calcAvg(ourData, 'price').toFixed(2);
            document.getElementById('our_rank').innerText = calcAvg(ourData, 'average_organic_rank').toFixed(1);
            document.getElementById('our_deal').innerText = ourData.some(d=>d.weekly_number_of_days_with_deal > 0) ? 'Sí' : 'No';

            // Render Them
            document.getElementById('comp_their_name').innerText = comp;
            document.getElementById('their_share').innerText = (calcAvg(theirData, 'click_share')*100).toFixed(1) + '%';
            document.getElementById('their_price').innerText = '$' + calcAvg(theirData, 'price').toFixed(2);
            document.getElementById('their_rank').innerText = calcAvg(theirData, 'average_organic_rank').toFixed(1);
            document.getElementById('their_deal').innerText = theirData.some(d=>d.weekly_number_of_days_with_deal > 0) ? 'Sí' : 'No';

            // Render Scatter for specific comparison
            const data = [['Rank', 'Share', {'type': 'string', 'role': 'style'}]];
            ourData.forEach(d => data.push([d.average_organic_rank, d.click_share, 'point {fill-color: #4285F4; size: 10}']));
            theirData.forEach(d => data.push([d.average_organic_rank, d.click_share, 'point {fill-color: #EA4335; shape-type: diamond; size: 12}']));

            const table = google.visualization.arrayToDataTable(data);
            const options = {
                title: `Comparativa Keyword a Keyword: ${ourBrandName} (Azul) vs ${comp} (Rojo)`,
                hAxis: {title: 'Rank Orgánico (Menor es Mejor)', direction: -1},
                vAxis: {title: 'Click Share', format: 'percent'},
                legend: 'none',
                chartArea: {width: '80%', height: '70%'}
            };
            const chart = new google.visualization.ScatterChart(document.getElementById('chart_comparator_scatter'));
            chart.draw(table, options);
        }

        // Helpers
        function switchTab(tabId) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.container > div').forEach(d => d.classList.add('hidden'));
            
            document.querySelector(`.tab[onclick="switchTab('${tabId}')"]`).classList.add('active');
            document.getElementById(`tab-${tabId}`).classList.remove('hidden');
        }

    </script>
</body>
</html>