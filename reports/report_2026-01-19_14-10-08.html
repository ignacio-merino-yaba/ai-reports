<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reporte de Inteligencia de Mercado - Parent ASIN</title>
    
    <!-- React & ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Recharts -->
    <script src="https://unpkg.com/recharts/umd/Recharts.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: #F5F5F7; color: #1D1D1F; }
        .card { background: white; border-radius: 16px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03); border: 1px solid #E5E7EB; }
        .btn-tab { transition: all 0.2s; }
        .btn-tab.active { background-color: white; color: #007AFF; box-shadow: 0 1px 3px rgba(0,0,0,0.1); font-weight: 600; }
        .text-brand { color: #007AFF; }
        .text-comp { color: #8E8E93; }
        .recharts-cartesian-grid-horizontal line, .recharts-cartesian-grid-vertical line { stroke: #E5E7EB; }
        .recharts-tooltip-wrapper { outline: none; }
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #C1C1C1; border-radius: 4px; }
    </style>
</head>
<body>

<div id="root"></div>

<script type="text/babel">
    const { LineChart, Line, AreaChart, Area, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, BarChart, Bar, ScatterChart, Scatter, ZAxis } = Recharts;
    
    // --- DATA INJECTION ---
    const marketData = {"metadata": {"our_brand": "NATURALEBIO", "competitors": ["NORITUAL LAB", "CEREMONIAL", "UNREAL\u00ae"], "weeks": ["2025-52", "2026-01"]}, "chart_data": [{"week": "2025-52", "our_clicks": 238.38725, "comp_clicks": 1236.38455, "our_share": 12.55, "top1_share": 31.83, "top2_share": 17.04, "top3_share": 6.04, "others_share": 10.179999999999993, "our_price": 21.787857143, "comp_price": 21.085}, {"week": "2026-01", "our_clicks": 103.79625999999999, "comp_clicks": 624.12058, "our_share": 10.82, "top1_share": 31.939999999999998, "top2_share": 16.95, "top3_share": 3.39, "others_share": 12.780000000000001, "our_price": 21.49, "comp_price": 19.34}], "efficiency_data": [{"asin": "B0G1T7N675", "brand": "CEREMONIAL", "is_us": false, "rank": 13, "share": 2.87, "price": 8.47, "deal": true, "title": "Ceremonial Matcha Pulver BIO-Q..."}, {"asin": "B0F9B1LWQQ", "brand": "UNREAL\u00ae", "is_us": false, "rank": 10, "share": 3.39, "price": 29.95, "deal": false, "title": "UNREAL\u00ae 100g Ceremonial Bio Ma..."}, {"asin": "B0G3XBLNKN", "brand": "JIBIX", "is_us": false, "rank": 12, "share": 3.91, "price": 22.99, "deal": false, "title": "Jibix Ceremonial Matcha \u2013 100%..."}, {"asin": "B06XQ5DCYJ", "brand": "NATURALEBIO", "is_us": true, "rank": 4, "share": 5.08, "price": 13.99, "deal": false, "title": "NaturaleBio Matcha Tee Pulver ..."}, {"asin": "B07SZFD3P9", "brand": "NATURALEBIO", "is_us": true, "rank": 10, "share": 5.74, "price": 28.99, "deal": false, "title": "NaturaleBio Matcha Ceremonial ..."}, {"asin": "B0FC2XRLV5", "brand": "MATCHA", "is_us": false, "rank": 9, "share": 1.96, "price": 14.99, "deal": false, "title": "Matcha Pulver Ceremonial Grade..."}, {"asin": "B0FK5VGD2H", "brand": "M'ATELIER", "is_us": false, "rank": 6, "share": 4.17, "price": 19.99, "deal": false, "title": "M'atelier Reines Matcha Pulver..."}, {"asin": "B0FSL3C3Z8", "brand": "CEREMONIAL", "is_us": false, "rank": 2, "share": 14.08, "price": 14.9, "deal": false, "title": "Ceremonial Matcha Ryoku - Rein..."}, {"asin": "B0FSL3C3Z8", "brand": "NORITUAL LAB", "is_us": false, "rank": 2, "share": 14.08, "price": 14.9, "deal": false, "title": "Ceremonial Matcha Ryoku - Rein..."}, {"asin": "B0FJ917BGC", "brand": "ORIGEENS", "is_us": false, "rank": 15, "share": 2.74, "price": 24.97, "deal": false, "title": "ORIGEENS BIO MATCHA CEREMONIAL..."}, {"asin": "B0CNRX8G5S", "brand": "NORITUAL LAB", "is_us": false, "rank": 1, "share": 17.86, "price": 22.9, "deal": false, "title": "Ceremonial Matcha - Reines Mat..."}], "insights": {"trend": "La tendencia de clics para nuestra marca es decreciente. Pasamos de 238 a 104 clics estimados.", "dominance": "El l\u00edder actual del mercado es NORITUAL LAB. Nuestra marca ocupa la posici\u00f3n #3 en cuota de clics esta semana.", "price": "Nuestro precio promedio es 21.49, comparado con el promedio de competidores de 20.50.", "top_competitors": ["NORITUAL LAB", "CEREMONIAL", "UNREAL\u00ae"], "our_brand": "NATURALEBIO"}, "raw_competitor_metrics": [{"week_date": "2025-52", "final_brand": "CEREMONIAL", "click_share": 17.04, "price": 27.3864285715, "weekly_number_of_days_with_deal": 1}, {"week_date": "2025-52", "final_brand": "JIBIX", "click_share": 3.67, "price": 23.575714286, "weekly_number_of_days_with_deal": 0}, {"week_date": "2025-52", "final_brand": "KURO MATCHA", "click_share": 3.55, "price": 9.178571429, "weekly_number_of_days_with_deal": 0}, {"week_date": "2025-52", "final_brand": "MATCHA & CO", "click_share": 1.78, "price": 31.344285714, "weekly_number_of_days_with_deal": 0}, {"week_date": "2025-52", "final_brand": "NATURALEBIO", "click_share": 12.55, "price": 21.787857143, "weekly_number_of_days_with_deal": 1}, {"week_date": "2025-52", "final_brand": "NORITUAL LAB", "click_share": 31.83, "price": 19.382142856999998, "weekly_number_of_days_with_deal": 0}, {"week_date": "2025-52", "final_brand": "UNREAL\u00ae", "click_share": 6.04, "price": 19.9464285715, "weekly_number_of_days_with_deal": 0}, {"week_date": "2025-52", "final_brand": "WEIGHTWORLD", "click_share": 1.18, "price": 13.321428571, "weekly_number_of_days_with_deal": 0}, {"week_date": "2026-01", "final_brand": "CEREMONIAL", "click_share": 16.95, "price": 11.685, "weekly_number_of_days_with_deal": 4}, {"week_date": "2026-01", "final_brand": "JIBIX", "click_share": 3.91, "price": 22.99, "weekly_number_of_days_with_deal": 0}, {"week_date": "2026-01", "final_brand": "M'ATELIER", "click_share": 4.17, "price": 19.99, "weekly_number_of_days_with_deal": 0}, {"week_date": "2026-01", "final_brand": "MATCHA", "click_share": 1.96, "price": 14.99, "weekly_number_of_days_with_deal": 0}, {"week_date": "2026-01", "final_brand": "NATURALEBIO", "click_share": 10.82, "price": 21.49, "weekly_number_of_days_with_deal": 0}, {"week_date": "2026-01", "final_brand": "NORITUAL LAB", "click_share": 31.939999999999998, "price": 18.9, "weekly_number_of_days_with_deal": 0}, {"week_date": "2026-01", "final_brand": "ORIGEENS", "click_share": 2.74, "price": 24.97, "weekly_number_of_days_with_deal": 0}, {"week_date": "2026-01", "final_brand": "UNREAL\u00ae", "click_share": 3.39, "price": 29.95, "weekly_number_of_days_with_deal": 0}]};
    // ----------------------

    const COLORS = {
        us: '#007AFF',
        comp1: '#34C759',
        comp2: '#FF9500',
        comp3: '#FF3B30',
        others: '#E5E5EA',
        grid: '#F2F2F7'
    };

    function CustomTooltip({ active, payload, label }) {
        if (active && payload && payload.length) {
            return (
                <div className="bg-white/90 backdrop-blur-md p-3 rounded-lg border border-gray-100 shadow-xl text-xs">
                    <p className="font-bold mb-1 text-gray-800">{label}</p>
                    {payload.map((entry, index) => (
                        <div key={index} style={{ color: entry.color }} className="flex items-center gap-2 mb-1">
                            <span className="w-2 h-2 rounded-full" style={{background: entry.color}}></span>
                            <span className="capitalize">{entry.name}: {entry.value.toLocaleString()}</span>
                        </div>
                    ))}
                </div>
            );
        }
        return null;
    }

    const StatCard = ({ title, value, subtext, trend, icon }) => (
        <div className="card p-5 flex flex-col justify-between h-full">
            <div className="flex justify-between items-start mb-2">
                <span className="text-gray-500 text-sm font-medium uppercase tracking-wide">{title}</span>
                {icon && <i data-lucide={icon} className="w-4 h-4 text-gray-400"></i>}
            </div>
            <div>
                <div className="text-2xl font-bold text-gray-900">{value}</div>
                {subtext && <div className={`text-xs mt-1 font-medium ${trend === 'up' ? 'text-green-600' : trend === 'down' ? 'text-red-600' : 'text-gray-500'}`}>
                    {subtext}
                </div>}
            </div>
        </div>
    );

    const StaticReport = () => {
        // Trend calculation
        const lastWeek = marketData.chart_data[marketData.chart_data.length - 1];
        const prevWeek = marketData.chart_data[0];
        const clickTrend = lastWeek.our_clicks > prevWeek.our_clicks ? 'up' : 'down';
        
        return (
            <div className="space-y-8 animate-fade-in">
                
                {/* 1. Global Trend */}
                <section>
                    <div className="flex items-center gap-2 mb-4">
                        <h2 className="text-xl font-bold text-gray-900">1. Tendencia Global del Parent</h2>
                    </div>
                    <div className="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                        <StatCard title="Est. Clics (√öltima Sem.)" value={lastWeek.our_clicks.toFixed(0)} subtext={`${clickTrend === 'up' ? '‚ñ≤' : '‚ñº'} vs inicio`} trend={clickTrend} icon="mouse-pointer" />
                        <StatCard title="Click Share (Nosotros)" value={`${lastWeek.our_share}%`} subtext="Visibilidad actual" icon="pie-chart" />
                        <StatCard title="Precio Promedio" value={`‚Ç¨${lastWeek.our_price.toFixed(2)}`} subtext={`vs Market ‚Ç¨${lastWeek.comp_price.toFixed(2)}`} icon="tag" />
                        <StatCard title="Competidor L√≠der" value={marketData.metadata.competitors[0]} subtext={`${lastWeek.top1_share}% Share`} icon="trophy" />
                    </div>
                    <div className="card p-6 h-80">
                        <h3 className="text-sm font-semibold text-gray-500 mb-4 uppercase">Evoluci√≥n de Clics: Nosotros (Azul) vs Competencia (Gris)</h3>
                        <ResponsiveContainer width="100%" height="100%">
                            <LineChart data={marketData.chart_data}>
                                <CartesianGrid strokeDasharray="3 3" vertical={false} stroke={COLORS.grid} />
                                <XAxis dataKey="week" axisLine={false} tickLine={false} tick={{fill:'#8E8E93', fontSize:12}} />
                                <YAxis yAxisId="left" axisLine={false} tickLine={false} tick={{fill:'#8E8E93', fontSize:12}} />
                                <YAxis yAxisId="right" orientation="right" axisLine={false} tickLine={false} hide />
                                <Tooltip content={<CustomTooltip />} />
                                <Legend />
                                <Line yAxisId="left" type="monotone" dataKey="our_clicks" name="Nuestros Clics" stroke={COLORS.us} strokeWidth={3} dot={{r: 4}} activeDot={{r: 6}} />
                                <Line yAxisId="right" type="monotone" dataKey="comp_clicks" name="Clics Competencia" stroke="#8E8E93" strokeWidth={2} strokeDasharray="5 5" dot={false} />
                            </LineChart>
                        </ResponsiveContainer>
                    </div>
                    <div className="mt-4 bg-blue-50 p-4 rounded-xl border border-blue-100 text-sm text-blue-900">
                        <strong>Insight de Tendencia:</strong> {marketData.insights.trend}
                    </div>
                </section>

                {/* 2. Competitividad de Marca */}
                <section>
                    <h2 className="text-xl font-bold text-gray-900 mb-4">2. Competitividad de Marca (Share %)</h2>
                    <div className="card p-6 h-96">
                        <ResponsiveContainer width="100%" height="100%">
                            <AreaChart data={marketData.chart_data} margin={{top: 10, right: 30, left: 0, bottom: 0}}>
                                <defs>
                                    <linearGradient id="colorUs" x1="0" y1="0" x2="0" y2="1">
                                        <stop offset="5%" stopColor={COLORS.us} stopOpacity={0.8}/>
                                        <stop offset="95%" stopColor={COLORS.us} stopOpacity={0}/>
                                    </linearGradient>
                                </defs>
                                <XAxis dataKey="week" axisLine={false} tickLine={false} tick={{fill:'#8E8E93', fontSize:12}} />
                                <YAxis axisLine={false} tickLine={false} tick={{fill:'#8E8E93', fontSize:12}} domain={[0, 'auto']} />
                                <CartesianGrid strokeDasharray="3 3" vertical={false} stroke={COLORS.grid} />
                                <Tooltip content={<CustomTooltip />} />
                                <Legend iconType="circle" />
                                <Area type="monotone" dataKey="our_share" name={marketData.metadata.our_brand} stroke={COLORS.us} fill="url(#colorUs)" strokeWidth={2} />
                                <Area type="monotone" dataKey="top1_share" name={marketData.metadata.competitors[0]} stroke={COLORS.comp1} fill="none" strokeWidth={2} />
                                <Area type="monotone" dataKey="top2_share" name={marketData.metadata.competitors[1]} stroke={COLORS.comp2} fill="none" strokeWidth={2} />
                                <Area type="monotone" dataKey="top3_share" name={marketData.metadata.competitors[2]} stroke={COLORS.comp3} fill="none" strokeWidth={2} />
                            </AreaChart>
                        </ResponsiveContainer>
                    </div>
                    <div className="mt-4 bg-gray-50 p-4 rounded-xl border border-gray-200 text-sm text-gray-700">
                        <strong>Dominio de Mercado:</strong> {marketData.insights.dominance}
                    </div>
                </section>

                {/* 4. Efficiency (Scatter) */}
                <section>
                    <h2 className="text-xl font-bold text-gray-900 mb-4">3. Eficiencia: Organic Rank vs Click Share</h2>
                    <div className="card p-6 h-96">
                        <p className="text-xs text-gray-400 mb-2">Cuadrante Superior Izquierdo = Alta Eficiencia (Buen Rank, Alto Share)</p>
                        <ResponsiveContainer width="100%" height="100%">
                            <ScatterChart margin={{top: 20, right: 20, bottom: 20, left: 20}}>
                                <CartesianGrid strokeDasharray="3 3" stroke={COLORS.grid} />
                                <XAxis type="number" dataKey="rank" name="Rank Org√°nico" reversed={true} label={{ value: 'Rank (M√°s bajo es mejor) ‚Üí', position: 'bottom', offset: 0, fill: '#8E8E93', fontSize: 12 }} domain={[0, 'auto']} />
                                <YAxis type="number" dataKey="share" name="Click Share %" label={{ value: 'Click Share %', angle: -90, position: 'insideLeft', fill: '#8E8E93', fontSize: 12 }} />
                                <Tooltip cursor={{ strokeDasharray: '3 3' }} content={({ payload }) => {
                                    if (payload && payload.length) {
                                        const d = payload[0].payload;
                                        return (
                                            <div className="bg-white p-2 border border-gray-200 shadow-lg rounded text-xs">
                                                <p className="font-bold">{d.brand}</p>
                                                <p>ASIN: {d.asin}</p>
                                                <p>Rank: {d.rank} | Share: {d.share}%</p>
                                                <p>Price: ‚Ç¨{d.price}</p>
                                                {d.deal && <p className="text-red-500 font-bold">DEAL ACTIVE</p>}
                                            </div>
                                        );
                                    }
                                    return null;
                                }} />
                                <Scatter name="ASINs" data={marketData.efficiency_data} fill="#8884d8">
                                    {marketData.efficiency_data.map((entry, index) => (
                                        <cell key={`cell-${index}`} fill={entry.is_us ? COLORS.us : (entry.deal ? COLORS.comp3 : '#8E8E93')} />
                                    ))}
                                </Scatter>
                            </ScatterChart>
                        </ResponsiveContainer>
                    </div>
                    <div className="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="bg-green-50 p-4 rounded-xl border border-green-100">
                            <h4 className="font-semibold text-green-900 text-sm mb-1">Puntos Fuertes</h4>
                            <ul className="list-disc ml-4 text-xs text-green-800">
                                <li>Nuestra marca mantiene posiciones altas (Rank &lt; 10).</li>
                                <li>ASINs con deal activo muestran picos de share (ver puntos rojos).</li>
                            </ul>
                        </div>
                        <div className="bg-yellow-50 p-4 rounded-xl border border-yellow-100">
                            <h4 className="font-semibold text-yellow-900 text-sm mb-1">Oportunidades</h4>
                            <ul className="list-disc ml-4 text-xs text-yellow-800">
                                <li>Competidores con precios &lt; ‚Ç¨15 ganan tracci√≥n.</li>
                                <li>Revisar ASINs con bajo share a pesar de buen rank (Problema de CTR).</li>
                            </ul>
                        </div>
                    </div>
                </section>

                {/* 5. Conclusions */}
                <section>
                    <h2 className="text-xl font-bold text-gray-900 mb-4">4. Conclusiones y Recomendaciones</h2>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div className="card p-6 bg-gradient-to-br from-white to-gray-50">
                            <h3 className="flex items-center gap-2 font-bold text-gray-800 mb-3">
                                <i data-lucide="lightbulb" className="w-5 h-5 text-yellow-500"></i> Insights Clave
                            </h3>
                            <ul className="space-y-3 text-sm text-gray-600">
                                <li className="flex gap-2 items-start"><span className="text-blue-500 font-bold">‚Ä¢</span> {marketData.insights.trend}</li>
                                <li className="flex gap-2 items-start"><span className="text-blue-500 font-bold">‚Ä¢</span> {marketData.insights.dominance}</li>
                                <li className="flex gap-2 items-start"><span className="text-blue-500 font-bold">‚Ä¢</span> {marketData.insights.price}</li>
                                <li className="flex gap-2 items-start"><span className="text-blue-500 font-bold">‚Ä¢</span> La presencia de deals en competidores (ej. CEREMONIAL) est√° impactando el share.</li>
                                <li className="flex gap-2 items-start"><span className="text-blue-500 font-bold">‚Ä¢</span> Alta sensibilidad al precio en el segmento "Matcha Ceremonial".</li>
                            </ul>
                        </div>
                        <div className="card p-6 bg-gradient-to-br from-white to-blue-50 border-blue-100">
                            <h3 className="flex items-center gap-2 font-bold text-blue-900 mb-3">
                                <i data-lucide="check-circle" className="w-5 h-5 text-blue-600"></i> Acciones Recomendadas
                            </h3>
                            <ul className="space-y-3 text-sm text-blue-800">
                                <li className="flex gap-2 items-start"><span className="bg-blue-200 text-blue-800 px-1.5 rounded text-xs font-bold mt-0.5">PRECIO</span> Considerar cup√≥n de 10-15% para recuperar cuota frente a NORITUAL LAB.</li>
                                <li className="flex gap-2 items-start"><span className="bg-blue-200 text-blue-800 px-1.5 rounded text-xs font-bold mt-0.5">CRO</span> Optimizar imagen principal para mejorar CTR en posiciones Top 5.</li>
                                <li className="flex gap-2 items-start"><span className="bg-blue-200 text-blue-800 px-1.5 rounded text-xs font-bold mt-0.5">ADS</span> Defender Keywords de marca agresivamente para evitar fuga de tr√°fico.</li>
                            </ul>
                        </div>
                    </div>
                </section>
            </div>
        );
    };

    const Comparator = () => {
        const [week, setWeek] = React.useState(marketData.metadata.weeks[marketData.metadata.weeks.length - 1]);
        const [competitor, setCompetitor] = React.useState(marketData.metadata.competitors[0]);

        // Get data for selected week and competitor
        const rawWeekData = marketData.raw_competitor_metrics.filter(d => d.week_date === week);
        const usData = rawWeekData.find(d => d.final_brand === marketData.metadata.our_brand) || { click_share: 0, price: 0, weekly_number_of_days_with_deal: 0 };
        const compData = rawWeekData.find(d => d.final_brand === competitor) || { click_share: 0, price: 0, weekly_number_of_days_with_deal: 0 };

        const priceDiff = ((usData.price - compData.price) / compData.price) * 100;
        const shareDiff = usData.click_share - compData.click_share;

        return (
            <div className="animate-fade-in">
                <div className="flex flex-col md:flex-row gap-4 mb-6">
                    <div className="bg-white p-3 rounded-xl border border-gray-200 flex-1">
                        <label className="text-xs text-gray-500 font-bold uppercase block mb-1">Semana</label>
                        <select className="w-full bg-transparent font-semibold text-gray-800 outline-none" value={week} onChange={(e) => setWeek(e.target.value)}>
                            {marketData.metadata.weeks.map(w => <option key={w} value={w}>{w}</option>)}
                        </select>
                    </div>
                    <div className="bg-white p-3 rounded-xl border border-gray-200 flex-1">
                        <label className="text-xs text-gray-500 font-bold uppercase block mb-1">Competidor</label>
                        <select className="w-full bg-transparent font-semibold text-gray-800 outline-none" value={competitor} onChange={(e) => setCompetitor(e.target.value)}>
                            {marketData.metadata.competitors.map(c => <option key={c} value={c}>{c}</option>)}
                        </select>
                    </div>
                </div>

                <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    {/* Price Comparison */}
                    <div className="card p-6 flex flex-col items-center text-center">
                        <h3 className="text-gray-500 text-sm font-bold uppercase mb-4">Diferencial de Precio</h3>
                        <div className="flex items-end gap-4 mb-2">
                            <div className="text-right">
                                <div className="text-xs text-gray-400">Nosotros</div>
                                <div className="text-xl font-bold text-gray-900">‚Ç¨{usData.price.toFixed(2)}</div>
                            </div>
                            <div className="text-gray-300 font-light text-2xl">vs</div>
                            <div className="text-left">
                                <div className="text-xs text-gray-400">{competitor}</div>
                                <div className="text-xl font-bold text-gray-900">‚Ç¨{compData.price.toFixed(2)}</div>
                            </div>
                        </div>
                        <div className={`text-sm font-bold px-3 py-1 rounded-full ${priceDiff > 0 ? 'bg-red-100 text-red-700' : 'bg-green-100 text-green-700'}`}>
                            {priceDiff > 0 ? `+${priceDiff.toFixed(1)}% M√°s Caros` : `${priceDiff.toFixed(1)}% M√°s Baratos`}
                        </div>
                    </div>

                    {/* Share Comparison */}
                    <div className="card p-6 flex flex-col items-center text-center">
                        <h3 className="text-gray-500 text-sm font-bold uppercase mb-4">Gap de Cuota (Share)</h3>
                        <div className="w-full bg-gray-100 rounded-full h-4 mb-2 overflow-hidden flex relative">
                            <div style={{width: '50%', background: '#E5E7EB'}}></div> 
                            {/* Visual hack for simple bar */}
                        </div>
                        <div className="flex justify-between w-full text-xs font-bold text-gray-500 mb-2">
                            <span>{usData.click_share.toFixed(1)}%</span>
                            <span>{compData.click_share.toFixed(1)}%</span>
                        </div>
                         <div className={`text-xl font-bold ${shareDiff > 0 ? 'text-green-600' : 'text-red-600'}`}>
                            {shareDiff > 0 ? `+${shareDiff.toFixed(1)}%` : `${shareDiff.toFixed(1)}%`}
                        </div>
                        <p className="text-xs text-gray-400">Diferencia de puntos porcentuales</p>
                    </div>

                    {/* Deal Status */}
                    <div className="card p-6 flex flex-col items-center justify-center text-center">
                        <h3 className="text-gray-500 text-sm font-bold uppercase mb-4">Actividad Promocional</h3>
                        <div className="flex gap-4">
                            <div className={`p-3 rounded-lg border ${usData.weekly_number_of_days_with_deal > 0 ? 'bg-green-50 border-green-200' : 'bg-gray-50 border-gray-100'}`}>
                                <div className="text-xs text-gray-400 mb-1">Nosotros</div>
                                <div className="font-bold">{usData.weekly_number_of_days_with_deal > 0 ? 'üî• Deal' : 'Sin Promo'}</div>
                            </div>
                            <div className={`p-3 rounded-lg border ${compData.weekly_number_of_days_with_deal > 0 ? 'bg-red-50 border-red-200' : 'bg-gray-50 border-gray-100'}`}>
                                <div className="text-xs text-gray-400 mb-1">{competitor}</div>
                                <div className="font-bold">{compData.weekly_number_of_days_with_deal > 0 ? 'üî• Deal' : 'Sin Promo'}</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        );
    };

    const App = () => {
        const [activeTab, setActiveTab] = React.useState('static');

        return (
            <div className="max-w-6xl mx-auto p-4 md:p-8">
                <header className="mb-8 flex flex-col md:flex-row justify-between items-start md:items-center">
                    <div>
                        <h1 className="text-3xl font-bold tracking-tight text-gray-900">An√°lisis: {marketData.metadata.our_brand}</h1>
                        <p className="text-gray-500 mt-1">Parent ASIN Intelligence ‚Ä¢ {marketData.metadata.weeks[0]} - {marketData.metadata.weeks[marketData.metadata.weeks.length - 1]}</p>
                    </div>
                    <div className="mt-4 md:mt-0 bg-gray-200 p-1 rounded-lg inline-flex">
                        <button onClick={() => setActiveTab('static')} className={`btn-tab px-4 py-2 rounded-md text-sm ${activeTab === 'static' ? 'active' : 'text-gray-600'}`}>Dashboard</button>
                        <button onClick={() => setActiveTab('interactive')} className={`btn-tab px-4 py-2 rounded-md text-sm ${activeTab === 'interactive' ? 'active' : 'text-gray-600'}`}>Comparador VS</button>
                    </div>
                </header>

                <main>
                    {activeTab === 'static' ? <StaticReport /> : <Comparator />}
                </main>

                <footer className="mt-12 text-center text-xs text-gray-400 border-t border-gray-200 pt-6">
                    <p>Generated by AI Market Analyst ‚Ä¢ Confidential Data</p>
                </footer>
            </div>
        );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
    
    // Lucide Icons init
    setTimeout(() => {
        lucide.createIcons();
    }, 500);
</script>
</body>
</html>