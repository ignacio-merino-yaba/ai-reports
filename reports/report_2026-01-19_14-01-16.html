<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parent ASIN Strategic Analysis Report</title>
    
    <!-- External Dependencies (CDN) -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/recharts/umd/Recharts.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Custom Styles -->
    <style>
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: #f5f5f7; color: #1d1d1f; }
        .glass-panel { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.3); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03); }
        .card-shadow { box-shadow: 0 4px 24px 0 rgba(0,0,0,0.04); }
        .text-yaba { color: #0071e3; }
        .bg-yaba { background-color: #0071e3; }
        .text-comp { color: #ff3b30; }
        .bg-comp { background-color: #ff3b30; }
        
        /* Recharts custom tooltip */
        .custom-tooltip { background-color: rgba(255, 255, 255, 0.95); padding: 12px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); border: 1px solid #e5e5e5; font-size: 13px; }
    </style>
</head>
<body>

<div id="root"></div>

<script type="text/babel">
    const { useState, useMemo } = React;
    const { LineChart, Line, AreaChart, Area, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, BarChart, Bar, ScatterChart, Scatter, ZAxis } = Recharts;
    const { TrendingUp, TrendingDown, Award, Zap, Shield, Target, AlertTriangle, ArrowRight, DollarSign, Search } = lucide;

    // --- INJECTED DATA ---
    const marketData = {"trend_data": [{"week": "2025-51", "competitors": 23142.4726, "my_asins": 11573.99464, "total": 34716.46724}, {"week": "2026-01", "competitors": 10832.239418, "my_asins": 4740.47924, "total": 15572.718657999998}], "brand_share_data": [{"week_str": "2025-51", "Heapwell Superfoods": 7.41, "NaturaleBio": 18.93, "Perfect Ted": 17.75, "PureChimp": 2.05, "Rest of Market": 5.39, "SuperSelf": 11.399999999999999}, {"week_str": "2026-01", "Heapwell Superfoods": 7.28, "NaturaleBio": 19.4, "Perfect Ted": 14.59, "PureChimp": 0.0, "Rest of Market": 4.92, "SuperSelf": 17.54}], "latest_week": "2026-01", "raw_data": [{"brand_aggregation": "naturalebio", "parent_asin": "Matcha Premium", "reporting_date": "2026-01-03", "week_date": "2026-01", "keywords": "matcha powder", "competitor_brand": "Heapwell Superfoods", "asin": "B06XTYYYJ8", "product_title": "Heapwell Matcha Powder - 50g | High Grade Japanese...", "country_code": "uk", "average_organic_rank": 6, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 7.28, "impression_share": 6.26, "price": 9.99, "click_share_rank": 4, "weekly_search_volume": 24435.46, "is_yaba_asin": "N", "keywords_link": "https://www.amazon.co.uk/s?k=matcha+powder", "real_brand": "Heapwell Superfoods", "estimated_clicks": 1778.901488, "week_str": "2026-01", "brand_category": "Heapwell Superfoods"}, {"brand_aggregation": "naturalebio", "parent_asin": "Matcha Premium", "reporting_date": "2025-12-20", "week_date": "2025-51", "keywords": "matcha powder", "competitor_brand": "Heapwell Superfoods", "asin": "B06XTYYYJ8", "product_title": "Heapwell Matcha Powder - 50g | High Grade Japanese...", "country_code": "uk", "average_organic_rank": 7, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 7.41, "impression_share": 5.72, "price": 9.99, "click_share_rank": 4, "weekly_search_volume": 55166.8, "is_yaba_asin": "N", "keywords_link": "https://www.amazon.co.uk/s?k=matcha+powder", "real_brand": "Heapwell Superfoods", "estimated_clicks": 4087.85988, "week_str": "2025-51", "brand_category": "Heapwell Superfoods"}, {"brand_aggregation": "naturalebio", "parent_asin": "Matcha Premium", "reporting_date": "2026-01-03", "week_date": "2026-01", "keywords": "matcha powder", "competitor_brand": "SuperSelf", "asin": "B082DKRSB4", "product_title": "SuperSelf Organic Matcha Powder - Ceremonial Grade...", "country_code": "uk", "average_organic_rank": 7, "weekly_number_of_days_with_deal": 4, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 4, "click_share": 4.06, "impression_share": 5.29, "price": 14.86, "click_share_rank": 7, "weekly_search_volume": 24435.46, "is_yaba_asin": "N", "keywords_link": "https://www.amazon.co.uk/s?k=matcha+powder", "real_brand": "SuperSelf", "estimated_clicks": 992.079676, "week_str": "2026-01", "brand_category": "SuperSelf"}, {"brand_aggregation": "naturalebio", "parent_asin": "Matcha Premium", "reporting_date": "2025-12-20", "week_date": "2025-51", "keywords": "matcha powder", "competitor_brand": "SuperSelf", "asin": "B082DKRSB4", "product_title": "SuperSelf Organic Matcha Powder - Ceremonial Grade...", "country_code": "uk", "average_organic_rank": 10, "weekly_number_of_days_with_deal": 6, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 7, "click_share": 3.38, "impression_share": 4.57, "price": 15.58, "click_share_rank": 8, "weekly_search_volume": 55166.8, "is_yaba_asin": "N", "keywords_link": "https://www.amazon.co.uk/s?k=matcha+powder", "real_brand": "SuperSelf", "estimated_clicks": 1864.6378399999999, "week_str": "2025-51", "brand_category": "SuperSelf"}, {"brand_aggregation": "naturalebio", "parent_asin": "Matcha Premium", "reporting_date": "2025-12-20", "week_date": "2025-51", "keywords": "matcha powder", "competitor_brand": "SuperSelf", "asin": "B08YK2RPBZ", "product_title": "SuperSelf Organic Matcha Powder - Ceremonial Grade...", "country_code": "uk", "average_organic_rank": 5, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 7, "click_share": 8.02, "impression_share": 3.41, "price": 9.9, "click_share_rank": 3, "weekly_search_volume": 55166.8, "is_yaba_asin": "N", "keywords_link": "https://www.amazon.co.uk/s?k=matcha+powder", "real_brand": "SuperSelf", "estimated_clicks": 4424.3773599999995, "week_str": "2025-51", "brand_category": "SuperSelf"}, {"brand_aggregation": "naturalebio", "parent_asin": "Matcha Premium", "reporting_date": "2026-01-03", "week_date": "2026-01", "keywords": "matcha powder", "competitor_brand": "SuperSelf", "asin": "B08YK2RPBZ", "product_title": "SuperSelf Organic Matcha Powder - Ceremonial Grade...", "country_code": "uk", "average_organic_rank": 3, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 4, "click_share": 13.48, "impression_share": 3.85, "price": 9.9, "click_share_rank": 2, "weekly_search_volume": 24435.46, "is_yaba_asin": "N", "keywords_link": "https://www.amazon.co.uk/s?k=matcha+powder", "real_brand": "SuperSelf", "estimated_clicks": 3293.900008, "week_str": "2026-01", "brand_category": "SuperSelf"}, {"brand_aggregation": "naturalebio", "parent_asin": "Matcha Premium", "reporting_date": "2026-01-03", "week_date": "2026-01", "keywords": "matcha powder", "competitor_brand": null, "asin": "B08YRXQ2JH", "product_title": "Double Dragon | 100% Organic | Premium Matcha Gree...", "country_code": "uk", "average_organic_rank": 11, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 4.92, "impression_share": 3.79, "price": 6.98, "click_share_rank": 5, "weekly_search_volume": 24435.46, "is_yaba_asin": "N", "keywords_link": "https://www.amazon.co.uk/s?k=matcha+powder", "real_brand": "Double Dragon", "estimated_clicks": 1202.224632, "week_str": "2026-01", "brand_category": "Rest of Market"}, {"brand_aggregation": "naturalebio", "parent_asin": "Matcha Premium", "reporting_date": "2025-12-20", "week_date": "2025-51", "keywords": "matcha powder", "competitor_brand": null, "asin": "B08YRXQ2JH", "product_title": "Double Dragon | 100% Organic | Premium Matcha Gree...", "country_code": "uk", "average_organic_rank": 12, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 5.39, "impression_share": 4.66, "price": 6.98, "click_share_rank": 6, "weekly_search_volume": 55166.8, "is_yaba_asin": "N", "keywords_link": "https://www.amazon.co.uk/s?k=matcha+powder", "real_brand": "Double Dragon", "estimated_clicks": 2973.49052, "week_str": "2025-51", "brand_category": "Rest of Market"}, {"brand_aggregation": "naturalebio", "parent_asin": "Matcha Premium", "reporting_date": "2025-12-20", "week_date": "2025-51", "keywords": "matcha powder", "competitor_brand": "Perfect Ted", "asin": "B09DQ1PWGX", "product_title": "PerfectTed Organic Matcha Powder, Ceremonial Grade...", "country_code": "uk", "average_organic_rank": 9, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 8.86, "impression_share": 6.17, "price": 9.49, "click_share_rank": 2, "weekly_search_volume": 55166.8, "is_yaba_asin": "N", "keywords_link": "https://www.amazon.co.uk/s?k=matcha+powder", "real_brand": "Perfect Ted", "estimated_clicks": 4887.77848, "week_str": "2025-51", "brand_category": "Perfect Ted"}, {"brand_aggregation": "naturalebio", "parent_asin": "Matcha Premium", "reporting_date": "2026-01-03", "week_date": "2026-01", "keywords": "matcha powder", "competitor_brand": "Perfect Ted", "asin": "B09DQ1PWGX", "product_title": "PerfectTed Organic Matcha Powder, Ceremonial Grade...", "country_code": "uk", "average_organic_rank": 34, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 4.68, "impression_share": 3.65, "price": 2.1225, "click_share_rank": 6, "weekly_search_volume": 24435.46, "is_yaba_asin": "N", "keywords_link": "https://www.amazon.co.uk/s?k=matcha+powder", "real_brand": "Perfect Ted", "estimated_clicks": 1143.5795279999998, "week_str": "2026-01", "brand_category": "Perfect Ted"}, {"brand_aggregation": "naturalebio", "parent_asin": "Matcha Premium", "reporting_date": "2026-01-03", "week_date": "2026-01", "keywords": "matcha powder", "competitor_brand": "Perfect Ted", "asin": "B0D9M91WZD", "product_title": "PerfectTed Vanilla Bean Matcha Powder, Ceremonial ...", "country_code": "uk", "average_organic_rank": 11, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 2.37, "impression_share": 3.53, "price": 11.0, "click_share_rank": 9, "weekly_search_volume": 24435.46, "is_yaba_asin": "N", "keywords_link": "https://www.amazon.co.uk/s?k=matcha+powder", "real_brand": "Perfect Ted", "estimated_clicks": 579.120402, "week_str": "2026-01", "brand_category": "Perfect Ted"}, {"brand_aggregation": "naturalebio", "parent_asin": "Matcha Premium", "reporting_date": "2025-12-20", "week_date": "2025-51", "keywords": "matcha powder", "competitor_brand": "Perfect Ted", "asin": "B0D9M91WZD", "product_title": "PerfectTed Vanilla Bean Matcha Powder, Ceremonial ...", "country_code": "uk", "average_organic_rank": 11, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 3.3, "impression_share": 5.17, "price": 9.49, "click_share_rank": 9, "weekly_search_volume": 55166.8, "is_yaba_asin": "N", "keywords_link": "https://www.amazon.co.uk/s?k=matcha+powder", "real_brand": "Perfect Ted", "estimated_clicks": 1820.5044000000003, "week_str": "2025-51", "brand_category": "Perfect Ted"}, {"brand_aggregation": "naturalebio", "parent_asin": "Matcha Premium", "reporting_date": "2026-01-03", "week_date": "2026-01", "keywords": "matcha powder", "competitor_brand": "Perfect Ted", "asin": "B0F21VZMJQ", "product_title": "PerfectTed Original Matcha Powder, Ceremonial Grad...", "country_code": "uk", "average_organic_rank": 4, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 1, "weekly_number_of_days_with_coupon": 0, "click_share": 7.54, "impression_share": 3.41, "price": 16.99, "click_share_rank": 3, "weekly_search_volume": 24435.46, "is_yaba_asin": "N", "keywords_link": "https://www.amazon.co.uk/s?k=matcha+powder", "real_brand": "Perfect Ted", "estimated_clicks": 1842.4336839999999, "week_str": "2026-01", "brand_category": "Perfect Ted"}, {"brand_aggregation": "naturalebio", "parent_asin": "Matcha Premium", "reporting_date": "2025-12-20", "week_date": "2025-51", "keywords": "matcha powder", "competitor_brand": "Perfect Ted", "asin": "B0F21VZMJQ", "product_title": "PerfectTed Original Matcha Powder, Ceremonial Grad...", "country_code": "uk", "average_organic_rank": 5, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 5.59, "impression_share": 3.66, "price": 16.99, "click_share_rank": 5, "weekly_search_volume": 55166.8, "is_yaba_asin": "N", "keywords_link": "https://www.amazon.co.uk/s?k=matcha+powder", "real_brand": "Perfect Ted", "estimated_clicks": 3083.82412, "week_str": "2025-51", "brand_category": "Perfect Ted"}, {"brand_aggregation": "naturalebio", "parent_asin": "Matcha Premium", "reporting_date": "2025-12-20", "week_date": "2025-51", "keywords": "matcha powder", "competitor_brand": "PureChimp", "asin": "B00HNDSOCI", "product_title": "PureChimp Ceremonial Grade Matcha Powder 50g. 100%...", "country_code": "uk", "average_organic_rank": 12, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 7, "click_share": 2.05, "impression_share": 3.89, "price": 14.95, "click_share_rank": 10, "weekly_search_volume": 55166.8, "is_yaba_asin": "Y", "keywords_link": "https://www.amazon.co.uk/s?k=matcha+powder", "real_brand": "PureChimp", "estimated_clicks": 1130.9194, "week_str": "2025-51", "brand_category": "PureChimp"}, {"brand_aggregation": "naturalebio", "parent_asin": "Matcha Premium", "reporting_date": "2025-12-20", "week_date": "2025-51", "keywords": "matcha powder", "competitor_brand": "NaturaleBio", "asin": "B06XQ5DCYJ", "product_title": "NaturaleBio Japanese Organic Matcha Green Tea Powd...", "country_code": "uk", "average_organic_rank": 1, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 7, "weekly_number_of_days_with_coupon": 0, "click_share": 13.56, "impression_share": 3.27, "price": 12.275714286, "click_share_rank": 1, "weekly_search_volume": 55166.8, "is_yaba_asin": "Y", "keywords_link": "https://www.amazon.co.uk/s?k=matcha+powder", "real_brand": "NaturaleBio", "estimated_clicks": 7480.61808, "week_str": "2025-51", "brand_category": "NaturaleBio"}, {"brand_aggregation": "naturalebio", "parent_asin": "Matcha Premium", "reporting_date": "2026-01-03", "week_date": "2026-01", "keywords": "matcha powder", "competitor_brand": "NaturaleBio", "asin": "B06XQ5DCYJ", "product_title": "NaturaleBio Japanese Organic Matcha Green Tea Powd...", "country_code": "uk", "average_organic_rank": 1, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 4, "weekly_number_of_days_with_coupon": 0, "click_share": 14.18, "impression_share": 3.44, "price": 12.49, "click_share_rank": 1, "weekly_search_volume": 24435.46, "is_yaba_asin": "Y", "keywords_link": "https://www.amazon.co.uk/s?k=matcha+powder", "real_brand": "NaturaleBio", "estimated_clicks": 3464.948228, "week_str": "2026-01", "brand_category": "NaturaleBio"}, {"brand_aggregation": "naturalebio", "parent_asin": "Matcha Premium", "reporting_date": "2026-01-03", "week_date": "2026-01", "keywords": "matcha powder", "competitor_brand": "NaturaleBio", "asin": "B079VQ52MK", "product_title": "NaturaleBio Japanese Organic Matcha Green Tea Powd...", "country_code": "uk", "average_organic_rank": 7, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 3.19, "impression_share": 3.37, "price": 20.99, "click_share_rank": 8, "weekly_search_volume": 24435.46, "is_yaba_asin": "Y", "keywords_link": "https://www.amazon.co.uk/s?k=matcha+powder", "real_brand": "NaturaleBio", "estimated_clicks": 779.4911739999999, "week_str": "2026-01", "brand_category": "NaturaleBio"}, {"brand_aggregation": "naturalebio", "parent_asin": "Matcha Premium", "reporting_date": "2025-12-20", "week_date": "2025-51", "keywords": "matcha powder", "competitor_brand": "NaturaleBio", "asin": "B079VQ52MK", "product_title": "NaturaleBio Japanese Organic Matcha Green Tea Powd...", "country_code": "uk", "average_organic_rank": 3, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 5.37, "impression_share": 3.24, "price": 20.132857143, "click_share_rank": 7, "weekly_search_volume": 55166.8, "is_yaba_asin": "Y", "keywords_link": "https://www.amazon.co.uk/s?k=matcha+powder", "real_brand": "NaturaleBio", "estimated_clicks": 2962.45716, "week_str": "2025-51", "brand_category": "NaturaleBio"}, {"brand_aggregation": "naturalebio", "parent_asin": "Matcha Premium", "reporting_date": "2026-01-03", "week_date": "2026-01", "keywords": "matcha powder", "competitor_brand": "NaturaleBio", "asin": "B07B29VZ6W", "product_title": "NaturaleBio Japanese Organic Matcha Green Tea Powd...", "country_code": "uk", "average_organic_rank": 10, "weekly_number_of_days_with_deal": 0, "weekly_number_of_days_with_best_seller_badge": 0, "weekly_number_of_days_with_amazon_choice_badge": 0, "weekly_number_of_days_with_coupon": 0, "click_share": 2.03, "impression_share": 3.01, "price": 16.49, "click_share_rank": 10, "weekly_search_volume": 24435.46, "is_yaba_asin": "Y", "keywords_link": "https://www.amazon.co.uk/s?k=matcha+powder", "real_brand": "NaturaleBio", "estimated_clicks": 496.039838, "week_str": "2026-01", "brand_category": "NaturaleBio"}], "meta": {"my_brands": ["PureChimp", "NaturaleBio"], "top_competitors": ["Perfect Ted", "SuperSelf", "Heapwell Superfoods"], "avg_price_my": 16.2214285715, "avg_price_competitors": 11.358541666666667}};
    
    // --- UTILS ---
    const formatCurrency = (val) => new Intl.NumberFormat('en-GB', { style: 'currency', currency: 'GBP' }).format(val);
    const formatNumber = (val) => new Intl.NumberFormat('en-GB').format(Math.round(val));
    
    // --- COMPONENTS ---

    const InfoCard = ({ title, value, subvalue, trend, icon: Icon, color = "blue" }) => (
        <div className="bg-white rounded-2xl p-6 card-shadow border border-gray-100 flex flex-col justify-between">
            <div className="flex justify-between items-start mb-4">
                <div className={`p-3 rounded-xl bg-${color}-50 text-${color}-600`}>
                    <Icon size={24} />
                </div>
                {trend && (
                    <span className={`px-2 py-1 rounded-full text-xs font-medium ${trend === 'up' ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}`}>
                        {trend === 'up' ? <TrendingUp size={14} className="inline mr-1"/> : <TrendingDown size={14} className="inline mr-1"/>}
                        Last Week
                    </span>
                )}
            </div>
            <div>
                <p className="text-sm text-gray-500 font-medium mb-1">{title}</p>
                <h3 className="text-3xl font-bold text-gray-900">{value}</h3>
                {subvalue && <p className="text-sm text-gray-400 mt-2">{subvalue}</p>}
            </div>
        </div>
    );

    const InsightsSection = ({ insights }) => (
        <div className="bg-white rounded-2xl p-8 card-shadow border border-gray-100">
            <h2 className="text-xl font-bold mb-6 flex items-center gap-2">
                <Zap className="text-yellow-500" />
                Strategic Insights & Recommendations
            </h2>
            <div className="grid md:grid-cols-2 gap-8">
                <div>
                    <h3 className="text-sm font-bold text-gray-400 uppercase tracking-wider mb-4">Key Observations</h3>
                    <ul className="space-y-4">
                        {insights.observations.map((obs, i) => (
                            <li key={i} className="flex gap-3 items-start">
                                <div className="mt-1 min-w-[20px] h-[20px] rounded-full bg-blue-100 text-blue-600 flex items-center justify-center text-xs font-bold">{i+1}</div>
                                <p className="text-gray-700 text-sm leading-relaxed">{obs}</p>
                            </li>
                        ))}
                    </ul>
                </div>
                <div>
                    <h3 className="text-sm font-bold text-gray-400 uppercase tracking-wider mb-4">Action Plan</h3>
                    <ul className="space-y-4">
                        {insights.actions.map((act, i) => (
                            <li key={i} className="flex gap-3 items-start p-3 bg-gray-50 rounded-xl border border-gray-100">
                                <ArrowRight className="text-green-600 mt-0.5 min-w-[16px]" size={16} />
                                <p className="text-gray-800 text-sm font-medium">{act}</p>
                            </li>
                        ))}
                    </ul>
                </div>
            </div>
        </div>
    );

    const DashboardTab = () => {
        // Calculate Metrics for Latest Week vs Previous
        const weeks = [...new Set(marketData.raw_data.map(d => d.week_str))].sort();
        const currentWeek = weeks[weeks.length - 1];
        const prevWeek = weeks[weeks.length - 2];
        
        const currentData = marketData.raw_data.filter(d => d.week_str === currentWeek);
        const prevData = marketData.raw_data.filter(d => d.week_str === prevWeek);
        
        // My Performance
        const myCurrent = currentData.filter(d => d.is_yaba_asin === 'Y');
        const myPrev = prevData.filter(d => d.is_yaba_asin === 'Y');
        
        const myClicks = myCurrent.reduce((acc, curr) => acc + curr.estimated_clicks, 0);
        const myClicksPrev = myPrev.reduce((acc, curr) => acc + curr.estimated_clicks, 0);
        
        const totalClicks = currentData.reduce((acc, curr) => acc + curr.estimated_clicks, 0);
        const myShare = totalClicks ? (myClicks / totalClicks) * 100 : 0;
        
        const avgPrice = myCurrent.length ? myCurrent.reduce((acc, c) => acc + c.price, 0) / myCurrent.length : 0;
        const avgRank = myCurrent.length ? myCurrent.reduce((acc, c) => acc + c.average_organic_rank, 0) / myCurrent.length : 0;

        // Custom Tooltip for Charts
        const CustomTooltip = ({ active, payload, label }) => {
            if (active && payload && payload.length) {
                return (
                    <div className="custom-tooltip">
                        <p className="font-bold mb-2">{label}</p>
                        {payload.map((pld) => (
                            <div key={pld.dataKey} className="flex items-center gap-2 mb-1">
                                <span className="w-2 h-2 rounded-full" style={{backgroundColor: pld.color}}></span>
                                <span className="text-gray-600 capitalize">{pld.name === 'my_asins' ? 'Our Brand' : (pld.name === 'competitors' ? 'Competitors' : pld.name)}:</span>
                                <span className="font-medium">{formatNumber(pld.value)}</span>
                            </div>
                        ))}
                    </div>
                );
            }
            return null;
        };

        return (
            <div className="space-y-8 animate-fade-in">
                {/* Header */}
                <div className="flex flex-col md:flex-row justify-between items-end md:items-center gap-4">
                    <div>
                        <h2 className="text-2xl font-bold text-gray-900">Performance Dashboard</h2>
                        <p className="text-gray-500 text-sm">Week {currentWeek} Analysis</p>
                    </div>
                    <div className="px-4 py-2 bg-blue-50 text-blue-700 rounded-lg text-sm font-medium border border-blue-100">
                        {marketData.meta.my_brands.join(", ")}
                    </div>
                </div>

                {/* KPI Cards */}
                <div className="grid grid-cols-1 md:grid-cols-4 gap-6">
                    <InfoCard 
                        title="Total Clicks (Est.)" 
                        value={formatNumber(myClicks)} 
                        subvalue={`${myClicks > myClicksPrev ? '+' : ''}${formatNumber(myClicks - myClicksPrev)} vs Prev Week`}
                        trend={myClicks >= myClicksPrev ? 'up' : 'down'}
                        icon={Target}
                        color="blue"
                    />
                    <InfoCard 
                        title="Market Share (Clicks)" 
                        value={`${myShare.toFixed(1)}%`}
                        subvalue="Of total category clicks"
                        trend="up" // Logic would need historic share comparison
                        icon={Award}
                        color="purple"
                    />
                    <InfoCard 
                        title="Avg. Organic Rank" 
                        value={`#${avgRank.toFixed(1)}`}
                        subvalue="Across all keywords"
                        icon={Search}
                        color="green"
                    />
                    <InfoCard 
                        title="Avg. Price" 
                        value={formatCurrency(avgPrice)}
                        subvalue={`vs ${formatCurrency(marketData.meta.avg_price_competitors)} (Comp.)`}
                        icon={DollarSign}
                        color="orange"
                    />
                </div>

                {/* Main Charts Section */}
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    {/* Trend Chart */}
                    <div className="bg-white p-6 rounded-2xl card-shadow border border-gray-100">
                        <h3 className="text-lg font-bold mb-4 text-gray-800">Global Trend: Clicks Evolution</h3>
                        <div className="h-72 w-full">
                            <ResponsiveContainer width="100%" height="100%">
                                <AreaChart data={marketData.trend_data}>
                                    <defs>
                                        <linearGradient id="colorMy" x1="0" y1="0" x2="0" y2="1">
                                            <stop offset="5%" stopColor="#0071e3" stopOpacity={0.2}/>
                                            <stop offset="95%" stopColor="#0071e3" stopOpacity={0}/>
                                        </linearGradient>
                                        <linearGradient id="colorComp" x1="0" y1="0" x2="0" y2="1">
                                            <stop offset="5%" stopColor="#ff3b30" stopOpacity={0.2}/>
                                            <stop offset="95%" stopColor="#ff3b30" stopOpacity={0}/>
                                        </linearGradient>
                                    </defs>
                                    <CartesianGrid strokeDasharray="3 3" vertical={false} stroke="#f0f0f0" />
                                    <XAxis dataKey="week" axisLine={false} tickLine={false} tick={{fill: '#9ca3af', fontSize: 12}} dy={10} />
                                    <YAxis axisLine={false} tickLine={false} tick={{fill: '#9ca3af', fontSize: 12}} />
                                    <Tooltip content={<CustomTooltip />} />
                                    <Legend verticalAlign="top" height={36}/>
                                    <Area type="monotone" dataKey="competitors" stackId="1" stroke="#ff3b30" fill="url(#colorComp)" name="Competitors" />
                                    <Area type="monotone" dataKey="my_asins" stackId="1" stroke="#0071e3" fill="url(#colorMy)" name="Our Brand" />
                                </AreaChart>
                            </ResponsiveContainer>
                        </div>
                    </div>

                    {/* Brand Share Chart */}
                    <div className="bg-white p-6 rounded-2xl card-shadow border border-gray-100">
                        <h3 className="text-lg font-bold mb-4 text-gray-800">Competitiveness: Share of Voice</h3>
                        <div className="h-72 w-full">
                            <ResponsiveContainer width="100%" height="100%">
                                <LineChart data={marketData.brand_share_data}>
                                    <CartesianGrid strokeDasharray="3 3" vertical={false} stroke="#f0f0f0" />
                                    <XAxis dataKey="week_str" axisLine={false} tickLine={false} tick={{fill: '#9ca3af', fontSize: 12}} dy={10} />
                                    <YAxis unit="%" axisLine={false} tickLine={false} tick={{fill: '#9ca3af', fontSize: 12}} />
                                    <Tooltip contentStyle={{borderRadius: '12px', border: 'none', boxShadow: '0 4px 12px rgba(0,0,0,0.1)'}} />
                                    <Legend verticalAlign="top" height={36}/>
                                    {/* Dynamically generating lines */}
                                    {marketData.meta.my_brands.map((brand, i) => (
                                        <Line key={brand} type="monotone" dataKey={brand} stroke="#0071e3" strokeWidth={3} dot={{r: 4}} activeDot={{r: 6}} />
                                    ))}
                                    {marketData.meta.top_competitors.map((brand, i) => (
                                        <Line key={brand} type="monotone" dataKey={brand} stroke={['#ff3b30', '#ff9f0a', '#32d74b'][i % 3]} strokeWidth={2} dot={false} />
                                    ))}
                                    <Line type="monotone" dataKey="Rest of Market" stroke="#9ca3af" strokeDasharray="5 5" dot={false} />
                                </LineChart>
                            </ResponsiveContainer>
                        </div>
                    </div>
                </div>

                {/* Efficiency Chart */}
                 <div className="bg-white p-6 rounded-2xl card-shadow border border-gray-100">
                    <h3 className="text-lg font-bold mb-2 text-gray-800">Efficiency Matrix: Organic Rank vs Click Share</h3>
                    <p className="text-sm text-gray-500 mb-6">Are we getting the share we deserve for our rank?</p>
                    <div className="h-80 w-full">
                         <ResponsiveContainer width="100%" height="100%">
                            <ScatterChart margin={{ top: 20, right: 20, bottom: 20, left: 20 }}>
                                <CartesianGrid strokeDasharray="3 3" vertical={false} stroke="#f0f0f0" />
                                <XAxis type="number" dataKey="average_organic_rank" name="Rank" reversed={true} label={{ value: 'Organic Rank (Lower is Better)', position: 'bottom', offset: 0 }} />
                                <YAxis type="number" dataKey="click_share" name="Click Share" unit="%" label={{ value: 'Click Share %', angle: -90, position: 'insideLeft' }} />
                                <Tooltip cursor={{ strokeDasharray: '3 3' }} content={({ active, payload }) => {
                                    if (active && payload && payload.length) {
                                        const d = payload[0].payload;
                                        return (
                                            <div className="custom-tooltip">
                                                <p className="font-bold">{d.real_brand}</p>
                                                <p className="text-xs text-gray-500 mb-2 truncate max-w-[200px]">{d.product_title}</p>
                                                <p>Rank: {d.average_organic_rank}</p>
                                                <p>Share: {d.click_share}%</p>
                                                <p>Price: £{d.price}</p>
                                            </div>
                                        );
                                    }
                                    return null;
                                }} />
                                {/* My ASINs */}
                                <Scatter name="Our ASINs" data={currentData.filter(d => d.is_yaba_asin === 'Y')} fill="#0071e3" shape="circle" />
                                {/* Competitors */}
                                <Scatter name="Competitors" data={currentData.filter(d => d.is_yaba_asin === 'N')} fill="#ff3b30" shape="triangle" />
                            </ScatterChart>
                        </ResponsiveContainer>
                    </div>
                </div>

                {/* Insights Section */}
                <InsightsSection 
                    insights={{
                        observations: [
                            "Market Contraction: Total search volume dropped significantly by ~55% from W51 to W01, impacting total clicks for all players.",
                            "Share Resilience: Despite volume drop, NaturaleBio maintained a dominant position (~19% share). However, SuperSelf (Competitor) surged from 11% to 17% share.",
                            "Competitor Surge: SuperSelf's growth correlates with aggressive couponing (4 days active in W01) and competitive pricing (£9.90 vs our ~£12-16).",
                            "Portfolio Split: While NaturaleBio holds rank #1, PureChimp (our other brand) lost visibility (0% share in W01 vs 2% in W51), likely due to stock or rank issues.",
                            "Premium Positioning: Our average price (£16.22) is significantly higher than the top competitors (£11.36). We are holding share despite this premium, indicating strong brand equity, but vulnerable to price wars."
                        ],
                        actions: [
                            "Defend against SuperSelf: Consider a tactical coupon or temporary price match on the main NaturaleBio variant to halt SuperSelf's momentum.",
                            "Revive PureChimp: Investigate PureChimp's sudden drop to 0% share. Check inventory status and organic rank (Rank #12 is too low for visibility).",
                            "Leverage 'Choice': Our main ASIN has the Amazon's Choice badge for 4 days. Maximize conversion during these days with sponsored ads to improve efficiency.",
                            "Bundle Opportunity: Since we have a premium price perception, consider virtual bundles to increase perceived value without direct price erosion."
                        ]
                    }}
                />
            </div>
        );
    };

    const ComparatorTab = () => {
        const weeks = [...new Set(marketData.raw_data.map(d => d.week_str))].sort().reverse();
        const competitors = [...new Set(marketData.raw_data.filter(d => d.is_yaba_asin === 'N').map(d => d.real_brand))].sort();
        
        const [selectedWeek, setSelectedWeek] = useState(weeks[0]);
        const [selectedComp, setSelectedComp] = useState(competitors[0]);
        
        // Filter Data
        const weekData = marketData.raw_data.filter(d => d.week_str === selectedWeek);
        const myData = weekData.find(d => d.is_yaba_asin === 'Y' && d.average_organic_rank < 5) || weekData.find(d => d.is_yaba_asin === 'Y'); // Take best performing Y asin as representative
        const compData = weekData.find(d => d.real_brand === selectedComp);

        if (!myData || !compData) return <div className="p-8 text-center text-gray-500">Insufficient data for this combination.</div>;

        const ComparisonRow = ({ label, myVal, compVal, type = "text", highlight = false }) => {
            let myDisplay = myVal;
            let compDisplay = compVal;
            let win = null; // 'me', 'comp', 'draw'

            if (type === 'price') {
                myDisplay = formatCurrency(myVal);
                compDisplay = formatCurrency(compVal);
                win = myVal < compVal ? 'me' : 'comp'; // Lower price wins? Depends on strategy, assuming lower is more competitive for share
            } else if (type === 'rank') {
                myDisplay = `#${myVal}`;
                compDisplay = `#${compVal}`;
                win = myVal < compVal ? 'me' : 'comp';
            } else if (type === 'share') {
                myDisplay = `${myVal}%`;
                compDisplay = `${compVal}%`;
                win = myVal > compVal ? 'me' : 'comp';
            } else if (type === 'bool') {
                myDisplay = myVal > 0 ? 'Yes' : 'No';
                compDisplay = compVal > 0 ? 'Yes' : 'No';
                win = myVal > compVal ? 'me' : (compVal > myVal ? 'comp' : 'draw');
            }

            return (
                <div className={`grid grid-cols-3 gap-4 py-4 border-b border-gray-100 ${highlight ? 'bg-gray-50 -mx-4 px-4' : ''}`}>
                    <div className="text-gray-500 font-medium text-sm flex items-center">{label}</div>
                    <div className={`font-bold text-lg ${win === 'me' ? 'text-green-600' : ''}`}>{myDisplay}</div>
                    <div className={`font-bold text-lg ${win === 'comp' ? 'text-red-600' : ''}`}>{compDisplay}</div>
                </div>
            );
        };

        return (
            <div className="animate-fade-in space-y-6">
                {/* Controls */}
                <div className="bg-white p-6 rounded-2xl card-shadow flex flex-col md:flex-row gap-4 border border-gray-100">
                    <div className="flex-1">
                        <label className="block text-xs font-bold text-gray-400 uppercase tracking-wide mb-2">Select Week</label>
                        <select 
                            className="w-full bg-gray-50 border border-gray-200 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5"
                            value={selectedWeek}
                            onChange={(e) => setSelectedWeek(e.target.value)}
                        >
                            {weeks.map(w => <option key={w} value={w}>Week {w}</option>)}
                        </select>
                    </div>
                    <div className="flex-1">
                        <label className="block text-xs font-bold text-gray-400 uppercase tracking-wide mb-2">Select Competitor</label>
                        <select 
                            className="w-full bg-gray-50 border border-gray-200 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5"
                            value={selectedComp}
                            onChange={(e) => setSelectedComp(e.target.value)}
                        >
                            {competitors.map(c => <option key={c} value={c}>{c}</option>)}
                        </select>
                    </div>
                </div>

                {/* Head to Head Card */}
                <div className="bg-white rounded-2xl card-shadow overflow-hidden border border-gray-100">
                    <div className="grid grid-cols-3 bg-gray-50 p-6 border-b border-gray-100">
                        <div className="font-bold text-gray-400 text-sm uppercase tracking-wider">Metric</div>
                        <div>
                            <span className="bg-blue-100 text-blue-700 px-2 py-1 rounded text-xs font-bold mb-1 block w-max">US</span>
                            <div className="font-bold text-gray-900 truncate">{myData.real_brand}</div>
                            <div className="text-xs text-gray-400 truncate w-3/4">{myData.product_title}</div>
                        </div>
                        <div>
                            <span className="bg-red-100 text-red-700 px-2 py-1 rounded text-xs font-bold mb-1 block w-max">THEM</span>
                            <div className="font-bold text-gray-900 truncate">{compData.real_brand}</div>
                            <div className="text-xs text-gray-400 truncate w-3/4">{compData.product_title}</div>
                        </div>
                    </div>
                    
                    <div className="p-6">
                        <ComparisonRow label="Click Share" myVal={myData.click_share} compVal={compData.click_share} type="share" highlight />
                        <ComparisonRow label="Organic Rank" myVal={myData.average_organic_rank} compVal={compData.average_organic_rank} type="rank" />
                        <ComparisonRow label="Price" myVal={myData.price} compVal={compData.price} type="price" />
                        <ComparisonRow label="Deal Active Days" myVal={myData.weekly_number_of_days_with_deal} compVal={compData.weekly_number_of_days_with_deal} type="bool" />
                        <ComparisonRow label="Coupon Active Days" myVal={myData.weekly_number_of_days_with_coupon} compVal={compData.weekly_number_of_days_with_coupon} type="bool" />
                        <ComparisonRow label="Amazon Choice Days" myVal={myData.weekly_number_of_days_with_amazon_choice_badge} compVal={compData.weekly_number_of_days_with_amazon_choice_badge} type="bool" />
                    </div>
                </div>
            </div>
        );
    };

    const App = () => {
        const [activeTab, setActiveTab] = useState('dashboard');

        return (
            <div className="min-h-screen p-4 md:p-8 max-w-7xl mx-auto">
                <header className="mb-8 flex flex-col md:flex-row md:items-center justify-between gap-4">
                    <div>
                        <h1 className="text-3xl font-bold text-gray-900 tracking-tight">Market Intelligence</h1>
                        <p className="text-gray-500 mt-1">Single Parent ASIN & Category Analysis</p>
                    </div>
                    
                    <div className="bg-white p-1 rounded-xl shadow-sm border border-gray-200 flex">
                        <button 
                            onClick={() => setActiveTab('dashboard')}
                            className={`px-6 py-2 rounded-lg text-sm font-medium transition-all ${activeTab === 'dashboard' ? 'bg-gray-900 text-white shadow-md' : 'text-gray-500 hover:text-gray-900'}`}
                        >
                            Report
                        </button>
                        <button 
                            onClick={() => setActiveTab('comparator')}
                            className={`px-6 py-2 rounded-lg text-sm font-medium transition-all ${activeTab === 'comparator' ? 'bg-gray-900 text-white shadow-md' : 'text-gray-500 hover:text-gray-900'}`}
                        >
                            Comparison
                        </button>
                    </div>
                </header>

                <main>
                    {activeTab === 'dashboard' ? <DashboardTab /> : <ComparatorTab />}
                </main>
            </div>
        );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
</script>

</body>
</html>