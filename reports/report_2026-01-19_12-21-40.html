<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reporte de Inteligencia de Mercado - NaturaleBio</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- PropTypes (Required for Recharts UMD) -->
    <script src="https://unpkg.com/prop-types/prop-types.min.js"></script>
    
    <!-- Recharts -->
    <script src="https://unpkg.com/recharts/umd/Recharts.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; }
        .card { background: white; border-radius: 1rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // --- DATA INJECTION ---
        const marketData = {"ourBrand": "NaturaleBio", "topCompetitors": ["NORITUAL LAB", "Ceremonial", "VAHDAM"], "trendData": [{"week": "2025-51", "clicks_competitor": 29992.117211999997, "clicks_us": 13185.822275999999, "share_competitor": 49.29, "share_us": 21.67}, {"week": "2025-52", "clicks_competitor": 25276.6356, "clicks_us": 10420.943440000001, "share_competitor": 52.95, "share_us": 21.830000000000002}, {"week": "2026-01", "clicks_competitor": 13364.5216, "clicks_us": 6086.78514, "share_competitor": 49.6, "share_us": 22.59}], "brandShareData": [{"week_date": "2025-51", "Ceremonial": 11.41, "NORITUAL LAB": 25.509999999999998, "Rest of Market": 8.879999999999999, "Us": 21.67, "VAHDAM": 3.49}, {"week_date": "2025-52", "Ceremonial": 8.42, "NORITUAL LAB": 27.189999999999998, "Rest of Market": 11.68, "Us": 21.830000000000002, "VAHDAM": 5.66}, {"week_date": "2026-01", "Ceremonial": 7.38, "NORITUAL LAB": 26.72, "Rest of Market": 12.350000000000001, "Us": 22.59, "VAHDAM": 3.15}], "rawLastWeek": [{"asin": "B07SZFD3P9", "product_title": "NaturaleBio Matcha Ceremonial Grade 100g. Original...", "real_brand": "NaturaleBio", "price": 30.27, "click_share": 2.68, "average_organic_rank": null, "is_yaba_asin": "Y", "weekly_number_of_days_with_deal": null}, {"asin": "B06XQ5DCYJ", "product_title": "NaturaleBio Matcha Tee Pulver Bio - Premium-Qualit...", "real_brand": "NaturaleBio", "price": 14.6075, "click_share": 12.9, "average_organic_rank": 2.0, "is_yaba_asin": "Y", "weekly_number_of_days_with_deal": 0.0}, {"asin": "B0CNRX8G5S", "product_title": "Ceremonial Matcha - Reines Matcha Pulver aus Japan...", "real_brand": "NORITUAL LAB", "price": 23.91, "click_share": 19.34, "average_organic_rank": 2.0, "is_yaba_asin": "N", "weekly_number_of_days_with_deal": 0.0}, {"asin": "B06XQ69YCQ", "product_title": "NaturaleBio Matcha Tee Pulver Bio - Premium-Qualit...", "real_brand": "NaturaleBio", "price": 10.2225, "click_share": 3.35, "average_organic_rank": 5.0, "is_yaba_asin": "Y", "weekly_number_of_days_with_deal": 0.0}, {"asin": "B079VQ52MK", "product_title": "NaturaleBio Matcha Tee Pulver Bio - Premium-Qualit...", "real_brand": "NaturaleBio", "price": 24.5275, "click_share": 3.66, "average_organic_rank": 5.0, "is_yaba_asin": "Y", "weekly_number_of_days_with_deal": 0.0}, {"asin": "B0FSL3C3Z8", "product_title": "Ceremonial Matcha Ryoku - Reines Gr\u00fcntee-Pulver au...", "real_brand": "NORITUAL LAB", "price": 15.5575, "click_share": 7.38, "average_organic_rank": 6.0, "is_yaba_asin": "N", "weekly_number_of_days_with_deal": 0.0}, {"asin": "B0FSL3C3Z8", "product_title": "Ceremonial Matcha Ryoku - Reines Gr\u00fcntee-Pulver au...", "real_brand": "Ceremonial", "price": 15.5575, "click_share": 7.38, "average_organic_rank": 6.0, "is_yaba_asin": "N", "weekly_number_of_days_with_deal": 0.0}, {"asin": "B07MD4LB49", "product_title": "VAHDAM, Matcha Gr\u00fcntee Pulver (100g, 50+ Tassen) A...", "real_brand": "VAHDAM", "price": 10.43, "click_share": 3.15, "average_organic_rank": 9.0, "is_yaba_asin": "N", "weekly_number_of_days_with_deal": 0.0}, {"asin": "B08XVX8V1T", "product_title": "Bio Matcha Pulver 100 g \u2013 Japan Matcha Tee, 100% n...", "real_brand": "Bio", "price": 11.9975, "click_share": 2.39, "average_organic_rank": 10.0, "is_yaba_asin": "N", "weekly_number_of_days_with_deal": 0.0}, {"asin": "B08XVX8V1T", "product_title": "Bio Matcha Pulver 100 g \u2013 Japan Matcha Tee, 100% n...", "real_brand": "bioKontor", "price": 11.9975, "click_share": 2.39, "average_organic_rank": 10.0, "is_yaba_asin": "N", "weekly_number_of_days_with_deal": 0.0}, {"asin": "B0DRP6Y6XC", "product_title": "Matcha Pulver - 90g - 100% Nat\u00fcrlich & Fein Gemahl...", "real_brand": "Special Leaves", "price": 10.39, "click_share": 3.0, "average_organic_rank": 16.0, "is_yaba_asin": "N", "weekly_number_of_days_with_deal": 0.0}, {"asin": "B0DRP6Y6XC", "product_title": "Matcha Pulver - 90g - 100% Nat\u00fcrlich & Fein Gemahl...", "real_brand": "Matcha", "price": 10.39, "click_share": 3.0, "average_organic_rank": 16.0, "is_yaba_asin": "N", "weekly_number_of_days_with_deal": 0.0}, {"asin": "B0F9B1LWQQ", "product_title": "UNREAL\u00ae 100g Ceremonial Bio Matcha \u2013 100% Japanisc...", "real_brand": "UNREAL\u00ae", "price": 31.2725, "click_share": 1.57, "average_organic_rank": 19.0, "is_yaba_asin": "N", "weekly_number_of_days_with_deal": 0.0}], "fullRawData": [{"week_date": "2026-01", "asin": "B07SZFD3P9", "product_title": "NaturaleBio Matcha Ceremonial Grade 100g. Original...", "real_brand": "NaturaleBio", "is_yaba_asin": "Y", "price": 30.27, "click_share": 2.68, "average_organic_rank": null, "weekly_number_of_days_with_deal": null, "weekly_number_of_days_with_coupon": null, "weekly_number_of_days_with_best_seller_badge": null, "weekly_number_of_days_with_amazon_choice_badge": null, "estimated_clicks": 722.11528}, {"week_date": "2025-51", "asin": "B06XQ5DCYJ", "product_title": "NaturaleBio Matcha Tee Pulver Bio - Premium-Qualit...", "real_brand": "NaturaleBio", "is_yaba_asin": "Y", "price": 14.084285714, "click_share": 11.18, "average_organic_rank": 2.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 6802.837704}, {"week_date": "2025-52", "asin": "B06XQ5DCYJ", "product_title": "NaturaleBio Matcha Tee Pulver Bio - Premium-Qualit...", "real_brand": "NaturaleBio", "is_yaba_asin": "Y", "price": 15.058571429, "click_share": 11.66, "average_organic_rank": 2.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 5566.11088}, {"week_date": "2026-01", "asin": "B06XQ5DCYJ", "product_title": "NaturaleBio Matcha Tee Pulver Bio - Premium-Qualit...", "real_brand": "NaturaleBio", "is_yaba_asin": "Y", "price": 14.6075, "click_share": 12.9, "average_organic_rank": 2.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 3475.8534}, {"week_date": "2025-51", "asin": "B0CNRX8G5S", "product_title": "Ceremonial Matcha - Reines Matcha Pulver aus Japan...", "real_brand": "NORITUAL LAB", "is_yaba_asin": "N", "price": 24.03, "click_share": 16.66, "average_organic_rank": 2.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 7.0, "estimated_clicks": 10137.323448}, {"week_date": "2025-52", "asin": "B0CNRX8G5S", "product_title": "Ceremonial Matcha - Reines Matcha Pulver aus Japan...", "real_brand": "NORITUAL LAB", "is_yaba_asin": "N", "price": 24.648571429, "click_share": 18.77, "average_organic_rank": 2.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 7.0, "estimated_clicks": 8960.19736}, {"week_date": "2026-01", "asin": "B0CNRX8G5S", "product_title": "Ceremonial Matcha - Reines Matcha Pulver aus Japan...", "real_brand": "NORITUAL LAB", "is_yaba_asin": "N", "price": 23.91, "click_share": 19.34, "average_organic_rank": 2.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 4.0, "estimated_clicks": 5211.085639999999}, {"week_date": "2025-52", "asin": "B06XQ69YCQ", "product_title": "NaturaleBio Matcha Tee Pulver Bio - Premium-Qualit...", "real_brand": "NaturaleBio", "is_yaba_asin": "Y", "price": 10.538571429, "click_share": 3.75, "average_organic_rank": 4.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 1790.13}, {"week_date": "2026-01", "asin": "B06XQ69YCQ", "product_title": "NaturaleBio Matcha Tee Pulver Bio - Premium-Qualit...", "real_brand": "NaturaleBio", "is_yaba_asin": "Y", "price": 10.2225, "click_share": 3.35, "average_organic_rank": 5.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 902.6441}, {"week_date": "2025-52", "asin": "B079VQ52MK", "product_title": "NaturaleBio Matcha Tee Pulver Bio - Premium-Qualit...", "real_brand": "NaturaleBio", "is_yaba_asin": "Y", "price": 24.855714286, "click_share": 3.49, "average_organic_rank": 5.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 1666.0143200000002}, {"week_date": "2026-01", "asin": "B079VQ52MK", "product_title": "NaturaleBio Matcha Tee Pulver Bio - Premium-Qualit...", "real_brand": "NaturaleBio", "is_yaba_asin": "Y", "price": 24.5275, "click_share": 3.66, "average_organic_rank": 5.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 986.1723599999999}, {"week_date": "2025-51", "asin": "B079VQ52MK", "product_title": "NaturaleBio Matcha Tee Pulver Bio - Premium-Qualit...", "real_brand": "NaturaleBio", "is_yaba_asin": "Y", "price": 23.075714286, "click_share": 3.69, "average_organic_rank": 5.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 2245.301532}, {"week_date": "2025-51", "asin": "B06XQ69YCQ", "product_title": "NaturaleBio Matcha Tee Pulver Bio - Premium-Qualit...", "real_brand": "NaturaleBio", "is_yaba_asin": "Y", "price": 9.2, "click_share": 3.85, "average_organic_rank": 5.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 2342.6587799999998}, {"week_date": "2025-51", "asin": "B0FSL3C3Z8", "product_title": "Ceremonial Matcha Ryoku - Reines Gr\u00fcntee-Pulver au...", "real_brand": "Ceremonial", "is_yaba_asin": "N", "price": 15.635714286, "click_share": 8.85, "average_organic_rank": 5.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 5385.0727799999995}, {"week_date": "2025-51", "asin": "B0FSL3C3Z8", "product_title": "Ceremonial Matcha Ryoku - Reines Gr\u00fcntee-Pulver au...", "real_brand": "NORITUAL LAB", "is_yaba_asin": "N", "price": 15.635714286, "click_share": 8.85, "average_organic_rank": 5.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 5385.0727799999995}, {"week_date": "2026-01", "asin": "B0FSL3C3Z8", "product_title": "Ceremonial Matcha Ryoku - Reines Gr\u00fcntee-Pulver au...", "real_brand": "NORITUAL LAB", "is_yaba_asin": "N", "price": 15.5575, "click_share": 7.38, "average_organic_rank": 6.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 1988.5114800000001}, {"week_date": "2026-01", "asin": "B0FSL3C3Z8", "product_title": "Ceremonial Matcha Ryoku - Reines Gr\u00fcntee-Pulver au...", "real_brand": "Ceremonial", "is_yaba_asin": "N", "price": 15.5575, "click_share": 7.38, "average_organic_rank": 6.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 1988.5114800000001}, {"week_date": "2025-52", "asin": "B0FSL3C3Z8", "product_title": "Ceremonial Matcha Ryoku - Reines Gr\u00fcntee-Pulver au...", "real_brand": "Ceremonial", "is_yaba_asin": "N", "price": 16.037142857, "click_share": 8.42, "average_organic_rank": 6.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 4019.43856}, {"week_date": "2025-52", "asin": "B0FSL3C3Z8", "product_title": "Ceremonial Matcha Ryoku - Reines Gr\u00fcntee-Pulver au...", "real_brand": "NORITUAL LAB", "is_yaba_asin": "N", "price": 16.037142857, "click_share": 8.42, "average_organic_rank": 6.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 4019.43856}, {"week_date": "2025-52", "asin": "B07MD4LB49", "product_title": "VAHDAM, Matcha Gr\u00fcntee Pulver (100g, 50+ Tassen) A...", "real_brand": "VAHDAM", "is_yaba_asin": "N", "price": 9.895714286, "click_share": 4.19, "average_organic_rank": 7.0, "weekly_number_of_days_with_deal": 3.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 2000.1719200000005}, {"week_date": "2025-51", "asin": "B07MD4LB49", "product_title": "VAHDAM, Matcha Gr\u00fcntee Pulver (100g, 50+ Tassen) A...", "real_brand": "VAHDAM", "is_yaba_asin": "N", "price": 9.005714286, "click_share": 3.49, "average_organic_rank": 8.0, "weekly_number_of_days_with_deal": 5.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 2123.604972}, {"week_date": "2026-01", "asin": "B07MD4LB49", "product_title": "VAHDAM, Matcha Gr\u00fcntee Pulver (100g, 50+ Tassen) A...", "real_brand": "VAHDAM", "is_yaba_asin": "N", "price": 10.43, "click_share": 3.15, "average_organic_rank": 9.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 848.7548999999999}, {"week_date": "2026-01", "asin": "B08XVX8V1T", "product_title": "Bio Matcha Pulver 100 g \u2013 Japan Matcha Tee, 100% n...", "real_brand": "Bio", "is_yaba_asin": "N", "price": 11.9975, "click_share": 2.39, "average_organic_rank": 10.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 643.97594}, {"week_date": "2026-01", "asin": "B08XVX8V1T", "product_title": "Bio Matcha Pulver 100 g \u2013 Japan Matcha Tee, 100% n...", "real_brand": "bioKontor", "is_yaba_asin": "N", "price": 11.9975, "click_share": 2.39, "average_organic_rank": 10.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 643.97594}, {"week_date": "2025-52", "asin": "B08XVX8V1T", "product_title": "Bio Matcha Pulver 100 g \u2013 Japan Matcha Tee, 100% n...", "real_brand": "Bio", "is_yaba_asin": "N", "price": 12.367142857, "click_share": 2.44, "average_organic_rank": 10.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 1164.77792}, {"week_date": "2025-52", "asin": "B08XVX8V1T", "product_title": "Bio Matcha Pulver 100 g \u2013 Japan Matcha Tee, 100% n...", "real_brand": "bioKontor", "is_yaba_asin": "N", "price": 12.367142857, "click_share": 2.44, "average_organic_rank": 10.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 1164.77792}, {"week_date": "2025-51", "asin": "B0F5BVFRC1", "product_title": "Jean & Len Handcreme I Love You So Matcha, f\u00fcr nor...", "real_brand": "Jean", "is_yaba_asin": "N", "price": 3.095714286, "click_share": 1.92, "average_organic_rank": 12.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 1168.2869759999999}, {"week_date": "2025-51", "asin": "B0G1T7N675", "product_title": "Ceremonial Matcha Pulver BIO-Qualit\u00e4t 50g ideal zu...", "real_brand": "Ceremonial", "is_yaba_asin": "N", "price": 8.898571429, "click_share": 2.56, "average_organic_rank": 12.0, "weekly_number_of_days_with_deal": 7.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 1557.715968}, {"week_date": "2025-52", "asin": "B0DRP6Y6XC", "product_title": "Matcha Pulver - 90g - 100% Nat\u00fcrlich & Fein Gemahl...", "real_brand": "Special Leaves", "is_yaba_asin": "N", "price": 10.71, "click_share": 3.4, "average_organic_rank": 13.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 7.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 1623.0512}, {"week_date": "2025-52", "asin": "B0DRP6Y6XC", "product_title": "Matcha Pulver - 90g - 100% Nat\u00fcrlich & Fein Gemahl...", "real_brand": "Matcha", "is_yaba_asin": "N", "price": 10.71, "click_share": 3.4, "average_organic_rank": 13.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 7.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 1623.0512}, {"week_date": "2025-51", "asin": "B0DRP6Y6XC", "product_title": "Matcha Pulver - 90g - 100% Nat\u00fcrlich & Fein Gemahl...", "real_brand": "Matcha", "is_yaba_asin": "N", "price": 10.44, "click_share": 3.48, "average_organic_rank": 14.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 7.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 2117.5201439999996}, {"week_date": "2025-51", "asin": "B0DRP6Y6XC", "product_title": "Matcha Pulver - 90g - 100% Nat\u00fcrlich & Fein Gemahl...", "real_brand": "Special Leaves", "is_yaba_asin": "N", "price": 10.44, "click_share": 3.48, "average_organic_rank": 14.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 7.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 2117.5201439999996}, {"week_date": "2026-01", "asin": "B0DRP6Y6XC", "product_title": "Matcha Pulver - 90g - 100% Nat\u00fcrlich & Fein Gemahl...", "real_brand": "Special Leaves", "is_yaba_asin": "N", "price": 10.39, "click_share": 3.0, "average_organic_rank": 16.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 4.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 808.338}, {"week_date": "2026-01", "asin": "B0DRP6Y6XC", "product_title": "Matcha Pulver - 90g - 100% Nat\u00fcrlich & Fein Gemahl...", "real_brand": "Matcha", "is_yaba_asin": "N", "price": 10.39, "click_share": 3.0, "average_organic_rank": 16.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 4.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 808.338}, {"week_date": "2026-01", "asin": "B0F9B1LWQQ", "product_title": "UNREAL\u00ae 100g Ceremonial Bio Matcha \u2013 100% Japanisc...", "real_brand": "UNREAL\u00ae", "is_yaba_asin": "N", "price": 31.2725, "click_share": 1.57, "average_organic_rank": 19.0, "weekly_number_of_days_with_deal": 0.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 423.03022000000004}, {"week_date": "2025-52", "asin": "B07K1WBH4K", "product_title": "VAHDAM, Vanille Matcha Gr\u00fcner Tee Pulver (100g, 50...", "real_brand": "VAHDAM", "is_yaba_asin": "N", "price": 9.895714286, "click_share": 1.47, "average_organic_rank": 20.0, "weekly_number_of_days_with_deal": 3.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 701.73096}, {"week_date": "2025-51", "asin": "B07SZFD3P9", "product_title": "NaturaleBio Matcha Ceremonial Grade 100g. Original...", "real_brand": "NaturaleBio", "is_yaba_asin": "Y", "price": 26.748571429, "click_share": 2.95, "average_organic_rank": 22.0, "weekly_number_of_days_with_deal": 7.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 1795.0242600000001}, {"week_date": "2025-52", "asin": "B07SZFD3P9", "product_title": "NaturaleBio Matcha Ceremonial Grade 100g. Original...", "real_brand": "NaturaleBio", "is_yaba_asin": "Y", "price": 30.704285714, "click_share": 2.93, "average_organic_rank": 23.0, "weekly_number_of_days_with_deal": 1.0, "weekly_number_of_days_with_coupon": 0.0, "weekly_number_of_days_with_best_seller_badge": 0.0, "weekly_number_of_days_with_amazon_choice_badge": 0.0, "estimated_clicks": 1398.6882400000002}], "insights": ["La tendencia de clicks para nuestra marca es decreciente (6087 vs 10421).", "El competidor principal 'NORITUAL LAB' captur\u00f3 un 26.7% de click share esta semana.", "En precio, somos m\u00e1s caros que la media del mercado (19.91 vs 15.72).", "Alta eficiencia en top ranks."], "weeks": ["2025-51", "2025-52", "2026-01"]};

        // --- COMPONENTS ---

        const { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, AreaChart, Area, ScatterChart, Scatter, ZAxis } = Recharts;
        const { TrendingUp, TrendingDown, Info, ShoppingCart, Award, Search, DollarSign } = lucide;

        // Custom Tooltip
        const CustomTooltip = ({ active, payload, label }) => {
            if (active && payload && payload.length) {
                return (
                    <div className="bg-white p-3 border border-slate-200 shadow-lg rounded-lg">
                        <p className="font-bold text-slate-700 mb-2">{label}</p>
                        {payload.map((entry, index) => (
                            <p key={index} style={{ color: entry.color }} className="text-sm">
                                {entry.name}: {typeof entry.value === 'number' ? entry.value.toLocaleString(undefined, {maximumFractionDigits: 1}) : entry.value}
                                {entry.unit || ''}
                            </p>
                        ))}
                    </div>
                );
            }
            return null;
        };

        const MetricCard = ({ title, value, subtext, icon: Icon, trend }) => (
            <div className="card p-6 flex items-start justify-between">
                <div>
                    <p className="text-slate-500 text-sm font-medium mb-1">{title}</p>
                    <h3 className="text-2xl font-bold text-slate-800">{value}</h3>
                    {subtext && <p className={`text-xs mt-2 ${trend === 'up' ? 'text-green-600' : trend === 'down' ? 'text-red-600' : 'text-slate-400'}`}>{subtext}</p>}
                </div>
                <div className="p-3 bg-blue-50 rounded-lg">
                    <Icon className="w-6 h-6 text-blue-600" />
                </div>
            </div>
        );

        const Dashboard = () => {
            // Aggregations for cards
            const lastWeek = marketData.trendData[marketData.trendData.length - 1];
            const prevWeek = marketData.trendData[marketData.trendData.length - 2];
            const clicksTrend = lastWeek.clicks_us > prevWeek.clicks_us ? 'up' : 'down';
            const shareTrend = lastWeek.share_us > prevWeek.share_us ? 'up' : 'down';

            // Filter Top Competitors for Share Chart to avoid clutter
            const displayBrands = ["Us", ...marketData.topCompetitors, "Rest of Market"];
            
            // Scatter Data: Us vs Them
            const scatterData = marketData.rawLastWeek.map(item => ({
                ...item,
                type: item.is_yaba_asin === 'Y' ? 'Nuestra Marca' : 'Competencia',
                z: 100 // Bubble size
            }));

            return (
                <div className="space-y-8 animate-fade-in">
                    {/* Header */}
                    <div className="flex flex-col md:flex-row md:items-center justify-between gap-4">
                        <div>
                            <h1 className="text-3xl font-bold text-slate-900">Inteligencia de Mercado: {marketData.ourBrand}</h1>
                            <p className="text-slate-500">An√°lisis semanal del Parent ASIN (4-5 semanas)</p>
                        </div>
                        <div className="bg-white px-4 py-2 rounded-full border border-slate-200 text-sm font-medium text-slate-600 shadow-sm">
                            Semana Actual: {lastWeek.week}
                        </div>
                    </div>

                    {/* KPI Cards */}
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <MetricCard 
                            title="Total Clicks Estimados (Nuestros)" 
                            value={Math.round(lastWeek.clicks_us).toLocaleString()}
                            subtext={`${clicksTrend === 'up' ? '‚ñ≤' : '‚ñº'} vs semana anterior`}
                            trend={clicksTrend}
                            icon={Search}
                        />
                        <MetricCard 
                            title="Click Share Total (Marca)" 
                            value={`${lastWeek.share_us.toFixed(1)}%`}
                            subtext={`${shareTrend === 'up' ? '‚ñ≤' : '‚ñº'} vs semana anterior`}
                            trend={shareTrend}
                            icon={Award}
                        />
                         <MetricCard 
                            title="Posici√≥n de Marca vs Competencia" 
                            value={lastWeek.share_us > lastWeek.share_competitor ? "L√≠der" : "Retador"}
                            subtext={`Competencia: ${lastWeek.share_competitor.toFixed(1)}% Share`}
                            trend="neutral"
                            icon={TrendingUp}
                        />
                    </div>

                    {/* Section 1: Global Trend */}
                    <div className="card p-6">
                        <h2 className="text-xl font-bold text-slate-800 mb-6 flex items-center gap-2">
                            <TrendingUp className="w-5 h-5 text-blue-600" /> 1. Tendencia Global del Parent (Clicks & Share)
                        </h2>
                        <div className="h-80 w-full">
                            <ResponsiveContainer width="100%" height="100%">
                                <LineChart data={marketData.trendData}>
                                    <CartesianGrid strokeDasharray="3 3" vertical={false} stroke="#e2e8f0" />
                                    <XAxis dataKey="week" axisLine={false} tickLine={false} tick={{fill: '#64748b'}} />
                                    <YAxis yAxisId="left" orientation="left" stroke="#2563eb" axisLine={false} tickLine={false} />
                                    <YAxis yAxisId="right" orientation="right" stroke="#ef4444" axisLine={false} tickLine={false} />
                                    <Tooltip content={<CustomTooltip />} />
                                    <Legend wrapperStyle={{paddingTop: '20px'}} />
                                    <Line yAxisId="left" type="monotone" dataKey="clicks_us" name="Nuestros Clicks" stroke="#2563eb" strokeWidth={3} dot={{r: 4}} activeDot={{r: 6}} />
                                    <Line yAxisId="right" type="monotone" dataKey="clicks_competitor" name="Clicks Competencia" stroke="#94a3b8" strokeWidth={2} strokeDasharray="5 5" dot={{r: 4}} />
                                </LineChart>
                            </ResponsiveContainer>
                        </div>
                        <p className="mt-4 text-sm text-slate-500 italic border-l-4 border-blue-500 pl-3">
                            {marketData.insights[0]}
                        </p>
                    </div>

                    {/* Section 2: Brand Competitiveness */}
                    <div className="card p-6">
                        <h2 className="text-xl font-bold text-slate-800 mb-6 flex items-center gap-2">
                            <Award className="w-5 h-5 text-blue-600" /> 2. Competitividad de Marca (Share %)
                        </h2>
                        <div className="h-80 w-full">
                            <ResponsiveContainer width="100%" height="100%">
                                <AreaChart data={marketData.brandShareData}>
                                    <CartesianGrid strokeDasharray="3 3" vertical={false} stroke="#e2e8f0" />
                                    <XAxis dataKey="week_date" axisLine={false} tickLine={false} tick={{fill: '#64748b'}} />
                                    <YAxis axisLine={false} tickLine={false} unit="%" />
                                    <Tooltip content={<CustomTooltip />} />
                                    <Legend wrapperStyle={{paddingTop: '20px'}} />
                                    <Area type="monotone" dataKey="Us" name={marketData.ourBrand} stackId="1" stroke="#2563eb" fill="#3b82f6" fillOpacity={0.8} />
                                    {marketData.topCompetitors.map((comp, idx) => (
                                        <Area key={comp} type="monotone" dataKey={comp} name={comp} stackId="1" stroke={['#ef4444', '#f59e0b', '#10b981'][idx]} fill={['#ef4444', '#f59e0b', '#10b981'][idx]} fillOpacity={0.6} />
                                    ))}
                                    <Area type="monotone" dataKey="Rest of Market" name="Resto" stackId="1" stroke="#cbd5e1" fill="#e2e8f0" fillOpacity={0.4} />
                                </AreaChart>
                            </ResponsiveContainer>
                        </div>
                        <p className="mt-4 text-sm text-slate-500 italic border-l-4 border-red-500 pl-3">
                            {marketData.insights[1]}
                        </p>
                    </div>

                    {/* Section 4: Efficiency (Rank vs Share) */}
                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div className="card p-6">
                             <h2 className="text-xl font-bold text-slate-800 mb-6 flex items-center gap-2">
                                <Search className="w-5 h-5 text-blue-600" /> 4. Eficiencia: Organic Rank vs Click Share
                            </h2>
                            <div className="h-80 w-full">
                                <ResponsiveContainer width="100%" height="100%">
                                    <ScatterChart margin={{ top: 20, right: 20, bottom: 20, left: 0 }}>
                                        <CartesianGrid strokeDasharray="3 3" />
                                        <XAxis type="number" dataKey="average_organic_rank" name="Rank" label={{ value: 'Organic Rank (Menor es mejor)', position: 'bottom', offset: 0 }} reversed={true} domain={[30, 1]} />
                                        <YAxis type="number" dataKey="click_share" name="Share" unit="%" label={{ value: 'Click Share %', angle: -90, position: 'insideLeft' }} />
                                        <Tooltip cursor={{ strokeDasharray: '3 3' }} content={<CustomTooltip />} />
                                        <Legend wrapperStyle={{paddingTop: '10px'}}/>
                                        <Scatter name="Nuestra Marca" data={scatterData.filter(d => d.type === 'Nuestra Marca')} fill="#2563eb" shape="circle" />
                                        <Scatter name="Competencia" data={scatterData.filter(d => d.type === 'Competencia')} fill="#94a3b8" shape="triangle" />
                                    </ScatterChart>
                                </ResponsiveContainer>
                            </div>
                        </div>

                        {/* Section 5: Key Insights */}
                        <div className="card p-6 bg-slate-800 text-white">
                            <h2 className="text-xl font-bold mb-6 flex items-center gap-2 text-blue-400">
                                <Info className="w-5 h-5" /> 5. Conclusiones y Recomendaciones
                            </h2>
                            <div className="space-y-4">
                                <div>
                                    <h3 className="font-bold text-blue-200 mb-2">Insights Clave</h3>
                                    <ul className="list-disc pl-5 text-sm space-y-2 text-slate-300">
                                        {marketData.insights.map((insight, idx) => (
                                            <li key={idx}>{insight}</li>
                                        ))}
                                        <li>Se observa una correlaci√≥n positiva entre Deals y Click Share en competidores.</li>
                                    </ul>
                                </div>
                                <div className="pt-4 border-t border-slate-600">
                                    <h3 className="font-bold text-green-400 mb-2">Acciones Recomendadas</h3>
                                    <ul className="list-none space-y-3 text-sm">
                                        <li className="flex items-start gap-2">
                                            <span className="bg-green-500/20 text-green-400 p-1 rounded">üöÄ</span>
                                            <span>Revisar competitividad de precio en ASINs principales para recuperar cuota perdida.</span>
                                        </li>
                                        <li className="flex items-start gap-2">
                                            <span className="bg-green-500/20 text-green-400 p-1 rounded">üè∑Ô∏è</span>
                                            <span>Activar cupones agresivos (5-10%) en variantes con Rank Top 5 para defender posici√≥n.</span>
                                        </li>
                                        <li className="flex items-start gap-2">
                                            <span className="bg-green-500/20 text-green-400 p-1 rounded">üñºÔ∏è</span>
                                            <span>Optimizar Main Image en ASINs "Underperformers" (buen rank, bajo click) para subir CTR.</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const Comparator = () => {
            const [selectedWeek, setSelectedWeek] = React.useState(marketData.weeks[marketData.weeks.length - 1]);
            
            // Get data for selected week
            const weeklyData = marketData.fullRawData.filter(d => d.week_date === selectedWeek);
            
            // Get our main ASIN (highest share for selected week)
            const ourMainASIN = weeklyData.filter(d => d.is_yaba_asin === 'Y').sort((a, b) => b.click_share - a.click_share)[0] || {};
            
            // Get list of competitors for dropdown
            const competitors = weeklyData.filter(d => d.is_yaba_asin === 'N').map(d => ({asin: d.asin, label: `${d.real_brand} - ${d.asin}`}));
            const [selectedCompAsin, setSelectedCompAsin] = React.useState(competitors[0]?.asin);
            
            const compASIN = weeklyData.find(d => d.asin === selectedCompAsin) || {};

            const StatRow = ({ label, valUs, valComp, unit = '' }) => {
                const isUsBetter = label === 'Precio' ? valUs < valComp : valUs > valComp;
                const highlight = isUsBetter ? 'text-green-600' : 'text-red-500';
                
                return (
                    <div className="flex justify-between items-center py-3 border-b border-slate-100 last:border-0">
                        <div className={`flex-1 text-center font-bold ${label === 'Precio' ? (valUs < valComp ? 'text-green-600' : 'text-red-600') : (valUs > valComp ? 'text-green-600' : 'text-red-600')}`}>
                            {typeof valUs === 'number' ? valUs.toFixed(2) : valUs}{unit}
                        </div>
                        <div className="flex-1 text-center text-sm text-slate-500 font-medium px-2">{label}</div>
                        <div className="flex-1 text-center font-bold text-slate-700">
                             {typeof valComp === 'number' ? valComp.toFixed(2) : valComp}{unit}
                        </div>
                    </div>
                );
            };

            return (
                <div className="space-y-6 animate-fade-in max-w-4xl mx-auto">
                    <div className="card p-6">
                        <h2 className="text-2xl font-bold text-slate-800 mb-6 text-center">Comparador "Cara a Cara"</h2>
                        
                        <div className="flex flex-col sm:flex-row gap-4 justify-center mb-8">
                            <select 
                                value={selectedWeek} 
                                onChange={(e) => setSelectedWeek(e.target.value)}
                                className="p-2 border border-slate-300 rounded-lg bg-white"
                            >
                                {marketData.weeks.map(w => <option key={w} value={w}>{w}</option>)}
                            </select>
                            
                            <select 
                                value={selectedCompAsin} 
                                onChange={(e) => setSelectedCompAsin(e.target.value)}
                                className="p-2 border border-slate-300 rounded-lg bg-white max-w-xs"
                            >
                                {competitors.map(c => <option key={c.asin} value={c.asin}>{c.label}</option>)}
                            </select>
                        </div>

                        <div className="flex justify-between items-center mb-4 px-10">
                            <div className="text-center w-1/3">
                                <div className="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-2">
                                    <span className="text-blue-600 font-bold text-xs">NOSOTROS</span>
                                </div>
                                <h3 className="font-bold text-slate-800 text-sm truncate">{ourMainASIN.real_brand}</h3>
                                <p className="text-xs text-slate-500">{ourMainASIN.asin}</p>
                            </div>
                            <div className="text-center w-1/3 text-slate-400 font-bold">VS</div>
                            <div className="text-center w-1/3">
                                 <div className="w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-2">
                                    <span className="text-slate-600 font-bold text-xs">RIVAL</span>
                                </div>
                                <h3 className="font-bold text-slate-800 text-sm truncate">{compASIN.real_brand}</h3>
                                <p className="text-xs text-slate-500">{compASIN.asin}</p>
                            </div>
                        </div>

                        <div className="bg-slate-50 rounded-xl p-4">
                            <StatRow label="Click Share" valUs={ourMainASIN.click_share || 0} valComp={compASIN.click_share || 0} unit="%" />
                            <StatRow label="Precio" valUs={ourMainASIN.price || 0} valComp={compASIN.price || 0} unit="‚Ç¨" />
                            <StatRow label="Organic Rank" valUs={ourMainASIN.average_organic_rank || 0} valComp={compASIN.average_organic_rank || 0} />
                            <StatRow label="D√≠as con Deal" valUs={ourMainASIN.weekly_number_of_days_with_deal || 0} valComp={compASIN.weekly_number_of_days_with_deal || 0} />
                             <StatRow label="D√≠as con Cupon" valUs={ourMainASIN.weekly_number_of_days_with_coupon || 0} valComp={compASIN.weekly_number_of_days_with_coupon || 0} />
                        </div>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [activeTab, setActiveTab] = React.useState('dashboard');

            return (
                <div className="min-h-screen pb-12">
                    {/* Navigation */}
                    <nav className="bg-white border-b border-slate-200 sticky top-0 z-10">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <div className="flex justify-between h-16">
                                <div className="flex items-center gap-8">
                                    <span className="font-bold text-xl text-slate-900 tracking-tight">Market<span className="text-blue-600">Intel</span></span>
                                    <div className="hidden md:flex gap-4">
                                        <button 
                                            onClick={() => setActiveTab('dashboard')}
                                            className={`px-3 py-2 rounded-md text-sm font-medium transition-colors ${activeTab === 'dashboard' ? 'bg-blue-50 text-blue-700' : 'text-slate-500 hover:text-slate-700'}`}
                                        >
                                            Reporte General
                                        </button>
                                        <button 
                                            onClick={() => setActiveTab('comparator')}
                                            className={`px-3 py-2 rounded-md text-sm font-medium transition-colors ${activeTab === 'comparator' ? 'bg-blue-50 text-blue-700' : 'text-slate-500 hover:text-slate-700'}`}
                                        >
                                            Comparador ASIN
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </nav>

                    {/* Main Content */}
                    <main className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                        {activeTab === 'dashboard' ? <Dashboard /> : <Comparator />}
                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>