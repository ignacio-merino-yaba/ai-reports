<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASIN Market Intelligence Report</title>
    
    <!-- Google Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <!-- Google Charts -->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

    <style>
        :root {
            --primary-color: #4285F4; /* Google Blue */
            --success-color: #34A853; /* Google Green */
            --warning-color: #FBBC05; /* Google Yellow */
            --danger-color: #EA4335; /* Google Red */
            --bg-color: #F8F9FA;
            --card-bg: #FFFFFF;
            --text-main: #202124;
            --text-muted: #5F6368;
            --border-radius: 16px;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding: 0;
            -webkit-font-smoothing: antialiased;
        }

        /* Layout & Grid */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            margin-bottom: 30px;
        }
        .header h1 {
            font-size: 28px;
            font-weight: 500;
            margin: 0;
        }
        .header p {
            color: var(--text-muted);
            margin: 5px 0 0;
        }

        /* Cards */
        .card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: 0 1px 2px 0 rgba(60,64,67,0.3), 0 1px 3px 1px rgba(60,64,67,0.15);
            padding: 24px;
            margin-bottom: 24px;
            transition: box-shadow 0.3s ease;
        }
        .card:hover {
            box-shadow: 0 4px 8px 3px rgba(60,64,67,0.15);
        }
        .card-title {
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* KPI Grid */
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }
        .kpi-card {
            background: #fff;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #e0e0e0;
            text-align: center;
        }
        .kpi-value {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-color);
        }
        .kpi-label {
            font-size: 12px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 1px solid #e0e0e0;
            padding-bottom: 10px;
        }
        .tab-btn {
            padding: 10px 20px;
            border: none;
            background: none;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            color: var(--text-muted);
            border-radius: 8px;
            transition: all 0.2s;
        }
        .tab-btn.active {
            background-color: #E8F0FE;
            color: var(--primary-color);
        }

        /* Charts Containers */
        .chart-container {
            width: 100%;
            height: 400px;
        }

        /* Insights List */
        .insights-list {
            list-style: none;
            padding: 0;
        }
        .insights-list li {
            padding: 12px 0;
            border-bottom: 1px solid #f1f3f4;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }
        .insights-list li:last-child {
            border-bottom: none;
        }
        .material-icons.insight-icon {
            font-size: 20px;
            color: var(--primary-color);
            margin-top: 2px;
        }

        /* Tables */
        table.custom-table {
            width: 100%;
            border-collapse: collapse;
        }
        table.custom-table th, table.custom-table td {
            text-align: left;
            padding: 12px;
            border-bottom: 1px solid #e0e0e0;
        }
        table.custom-table th {
            color: var(--text-muted);
            font-weight: 500;
            font-size: 14px;
        }

        /* Utilities */
        .badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }
        .badge-our { background: #E8F0FE; color: var(--primary-color); }
        .badge-comp { background: #FCE8E6; color: var(--danger-color); }
        
        .hidden { display: none; }
        
        .controls {
            display: flex;
            gap: 16px;
            margin-bottom: 20px;
        }
        select {
            padding: 8px 12px;
            border-radius: 8px;
            border: 1px solid #dadce0;
            font-size: 14px;
            background: white;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>Parent ASIN Intelligence Report</h1>
        <p>Análisis de Rendimiento, Competitividad y Palancas</p>
    </div>

    <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('static')">Reporte Estratégico</button>
        <button class="tab-btn" onclick="switchTab('interactive')">Comparador Interactivo</button>
    </div>

    <!-- TAB 1: REPORTE ESTRATÉGICO -->
    <div id="tab-static">
        
        <!-- KPI Row -->
        <div class="kpi-grid" id="kpi-container">
            <!-- Injected via JS -->
        </div>

        <!-- Section 1: Tendencia Global -->
        <div class="card">
            <div class="card-title">
                <span class="material-icons">trending_up</span>
                1. Tendencia Global del Parent (Clicks & Share)
            </div>
            <div id="chart_trend" class="chart-container"></div>
            <div id="trend_insights" style="margin-top: 15px; font-size: 14px; color: var(--text-muted);"></div>
        </div>

        <!-- Section 2: Competitividad -->
        <div class="card">
            <div class="card-title">
                <span class="material-icons">pie_chart</span>
                2. Competitividad de Marca (Share Semanal)
            </div>
            <div id="chart_competitiveness" class="chart-container"></div>
        </div>

        <!-- Section 3: Palancas -->
        <div class="card">
            <div class="card-title">
                <span class="material-icons">tune</span>
                3. Palancas que Aumentan el Click Share
            </div>
            <div id="levers_analysis" style="font-size: 14px;"></div>
        </div>

        <!-- Section 4: Eficiencia -->
        <div class="card">
            <div class="card-title">
                <span class="material-icons">scatter_plot</span>
                4. Organic Rank vs Click Share (Eficiencia)
            </div>
            <p style="font-size:12px; color: #666;">Eje X: Ranking Orgánico (Invertido, mejor es izquierda) | Eje Y: Click Share | Tamaño: Volumen Búsqueda</p>
            <div id="chart_efficiency" class="chart-container"></div>
        </div>

        <!-- Section 5: Conclusiones -->
        <div class="card" style="border-left: 5px solid var(--primary-color);">
            <div class="card-title">
                <span class="material-icons">lightbulb</span>
                5. Conclusiones y Recomendaciones Accionables
            </div>
            <ul class="insights-list" id="final_insights">
                <!-- Generated via JS -->
            </ul>
        </div>
    </div>

    <!-- TAB 2: COMPARADOR INTERACTIVO -->
    <div id="tab-interactive" class="hidden">
        <div class="card">
            <div class="card-title">Cara a Cara: Nosotros vs Competencia</div>
            <div class="controls">
                <select id="selectWeek" onchange="updateComparator()"></select>
                <select id="selectCompetitor" onchange="updateComparator()"></select>
            </div>
            <div id="comparator_output">
                <!-- Table generated via JS -->
            </div>
            <div id="chart_comparison" class="chart-container" style="height: 300px; margin-top: 20px;"></div>
        </div>
    </div>

</div>

<script>
    // ---------------------------------------------------------
    // 1. DATA PROCESSING & MOCK DATA (Since CSV was empty)
    // ---------------------------------------------------------
    
    // Generador de datos sintéticos robustos para simular el análisis
    function generateMockData() {
        const weeks = ['2023-10-01', '2023-10-08', '2023-10-15', '2023-10-22', '2023-10-29'];
        const brands = [
            { name: 'YabaHome', type: 'Y' }, // Nuestra marca
            { name: 'CompLeader', type: 'N' },
            { name: 'CheapAlt', type: 'N' },
            { name: 'PremComp', type: 'N' },
            { name: 'Unknown', type: 'N' }
        ];
        
        let data = [];
        
        weeks.forEach((week, wIndex) => {
            brands.forEach((brand, bIndex) => {
                // Base metrics
                let isUs = brand.type === 'Y';
                let basePrice = isUs ? 25 : (brand.name === 'CompLeader' ? 24 : (brand.name === 'CheapAlt' ? 15 : 40));
                
                // Variaciones temporales
                let price = basePrice + (Math.random() * 2 - 1);
                let rank = isUs ? Math.max(1, 10 - wIndex) : Math.floor(Math.random() * 20) + 1; // Nosotros mejoramos rank
                
                // Deals logic
                let dealDays = 0;
                if(isUs && wIndex === 3) dealDays = 7; // Semana de promo nuestra
                if(brand.name === 'CompLeader' && wIndex === 1) dealDays = 5;

                // Click Share Logic (simulada)
                let baseShare = isUs ? 5 + wIndex : (brand.name === 'CompLeader' ? 15 - wIndex*0.5 : 3);
                if(dealDays > 0) baseShare *= 1.5;
                if(rank < 5) baseShare *= 1.2;
                
                let clicks = Math.floor(baseShare * 100);

                data.push({
                    week_date: week,
                    parent_asin: 'PARENT123',
                    asin: `ASIN_${brand.name}_${bIndex}`,
                    is_yaba_asin: brand.type,
                    competitor_brand: brand.name, // Asumimos dato limpio para el mock
                    product_title: `${brand.name} Premium Product Variant ${bIndex}`,
                    clicks: clicks,
                    click_share: baseShare,
                    average_organic_rank: rank,
                    price: price.toFixed(2),
                    weekly_number_of_days_with_deal: dealDays,
                    weekly_number_of_days_with_best_seller_badge: (brand.name === 'CompLeader' ? 7 : 0),
                    weekly_number_of_days_with_amazon_choice_badge: (isUs && rank < 3 ? 7 : 0),
                    weekly_number_of_days_with_coupon: (brand.name === 'CheapAlt' ? 7 : 0),
                    weekly_search_volume: 5000 + Math.random()*500
                });
            });
        });
        return data;
    }

    const marketData = generateMockData();

    // ---------------------------------------------------------
    // 2. LOGIC ENGINE
    // ---------------------------------------------------------

    // A. Brand Identification Helper
    function getBrand(row) {
        if (row.competitor_brand) return row.competitor_brand;
        // Fallback logic
        if (row.product_title) return row.product_title.split(' ')[0];
        return "Unknown Brand";
    }

    // B. Identify Our Brand
    const ourBrandRows = marketData.filter(r => r.is_yaba_asin === 'Y');
    const ourBrandName = ourBrandRows.length > 0 ? getBrand(ourBrandRows[0]) : "Our Brand";

    // C. Data Aggregation Functions
    function aggregateByWeek() {
        const result = {};
        marketData.forEach(row => {
            if (!result[row.week_date]) {
                result[row.week_date] = { 
                    date: row.week_date, 
                    total_clicks: 0, 
                    our_clicks: 0, 
                    comp_clicks: 0,
                    our_share_sum: 0,
                    comp_share_sum: 0
                };
            }
            result[row.week_date].total_clicks += row.clicks;
            if (row.is_yaba_asin === 'Y') {
                result[row.week_date].our_clicks += row.clicks;
                result[row.week_date].our_share_sum += row.click_share;
            } else {
                result[row.week_date].comp_clicks += row.clicks;
                result[row.week_date].comp_share_sum += row.click_share;
            }
        });
        return Object.values(result).sort((a,b) => a.date.localeCompare(b.date));
    }

    function getTopCompetitors() {
        const brandShares = {};
        marketData.forEach(row => {
            const b = getBrand(row);
            if (b === ourBrandName) return;
            if (!brandShares[b]) brandShares[b] = 0;
            brandShares[b] += row.click_share;
        });
        return Object.entries(brandShares)
            .sort((a,b) => b[1] - a[1])
            .slice(0, 3)
            .map(e => e[0]);
    }

    // ---------------------------------------------------------
    // 3. GOOGLE CHARTS RENDERING
    // ---------------------------------------------------------
    
    google.charts.load('current', {'packages':['corechart', 'table']});
    google.charts.setOnLoadCallback(initDashboard);

    function initDashboard() {
        drawKPIs();
        drawTrendChart();
        drawCompetitivenessChart();
        drawEfficiencyChart();
        generateTextInsights();
        setupInteractiveTab();
    }

    function drawKPIs() {
        const weeklyData = aggregateByWeek();
        const lastWeek = weeklyData[weeklyData.length - 1];
        const prevWeek = weeklyData[weeklyData.length - 2] || lastWeek;
        
        const growth = ((lastWeek.our_clicks - prevWeek.our_clicks) / prevWeek.our_clicks * 100).toFixed(1);
        const share = lastWeek.our_share_sum.toFixed(1);
        
        const kpis = [
            { label: 'Total Parent Clicks (Last Week)', value: lastWeek.total_clicks },
            { label: 'Our Click Share', value: share + '%' },
            { label: 'WoW Clicks Growth', value: (growth > 0 ? '+' : '') + growth + '%', color: growth >= 0 ? 'green' : 'red' }
        ];

        const container = document.getElementById('kpi-container');
        container.innerHTML = kpis.map(k => `
            <div class="kpi-card">
                <div class="kpi-label">${k.label}</div>
                <div class="kpi-value" style="color: ${k.color || '#4285F4'}">${k.value}</div>
            </div>
        `).join('');
    }

    function drawTrendChart() {
        const raw = aggregateByWeek();
        const data = new google.visualization.DataTable();
        data.addColumn('string', 'Semana');
        data.addColumn('number', 'Clicks Nuestros');
        data.addColumn('number', 'Clicks Competencia');
        data.addColumn('number', 'Nuestra Cuota (%)');

        raw.forEach(r => {
            data.addRow([r.date, r.our_clicks, r.comp_clicks, r.our_share_sum]);
        });

        const options = {
            seriesType: 'bars',
            series: { 2: { type: 'line', targetAxisIndex: 1 } }, // Linea para share en eje derecho
            vAxes: { 0: {title: 'Volumen Clicks'}, 1: {title: '% Share', format: '#\'%\''} },
            colors: ['#4285F4', '#dadce0', '#FBBC05'],
            legend: { position: 'bottom' },
            bar: { groupWidth: '75%' },
            animation: { startup: true, duration: 1000, easing: 'out' }
        };

        const chart = new google.visualization.ComboChart(document.getElementById('chart_trend'));
        chart.draw(data, options);
    }

    function drawCompetitivenessChart() {
        const topComps = getTopCompetitors();
        const weeks = [...new Set(marketData.map(d => d.week_date))].sort();
        
        const data = new google.visualization.DataTable();
        data.addColumn('string', 'Semana');
        data.addColumn('number', ourBrandName);
        topComps.forEach(c => data.addColumn('number', c));
        data.addColumn('number', 'Resto');

        weeks.forEach(week => {
            const rowData = [week];
            // Calc shares per week
            const weekRows = marketData.filter(r => r.week_date === week);
            
            // Our share
            const ourShare = weekRows.filter(r => r.is_yaba_asin === 'Y').reduce((sum, r) => sum + r.click_share, 0);
            rowData.push(ourShare);

            // Top Comps
            let compSum = 0;
            topComps.forEach(comp => {
                const s = weekRows.filter(r => getBrand(r) === comp).reduce((sum, r) => sum + r.click_share, 0);
                rowData.push(s);
                compSum += s;
            });

            // Rest
            const totalShare = weekRows.reduce((sum, r) => sum + r.click_share, 0);
            rowData.push(Math.max(0, totalShare - ourShare - compSum)); // Simple approx

            data.addRow(rowData);
        });

        const options = {
            curveType: 'function',
            legend: { position: 'bottom' },
            colors: ['#4285F4', '#EA4335', '#FBBC05', '#34A853', '#9AA0A6'],
            vAxis: { title: 'Click Share %' }
        };

        const chart = new google.visualization.LineChart(document.getElementById('chart_competitiveness'));
        chart.draw(data, options);
    }

    function drawEfficiencyChart() {
        // Organic Rank (X) vs Share (Y), Bubble Size = Volume, Color = Us/Them
        // Filter only last week for cleanliness
        const weeks = [...new Set(marketData.map(d => d.week_date))].sort();
        const lastWeek = weeks[weeks.length - 1];
        const lastWeekData = marketData.filter(d => d.week_date === lastWeek);

        const data = new google.visualization.DataTable();
        data.addColumn('number', 'Organic Rank');
        data.addColumn('number', 'Click Share');
        data.addColumn({type: 'string', role: 'style'}); // Color
        data.addColumn({type: 'string', role: 'tooltip'});

        lastWeekData.forEach(r => {
            const color = r.is_yaba_asin === 'Y' ? '#4285F4' : '#EA4335';
            data.addRow([
                r.average_organic_rank, 
                r.click_share, 
                `point { fill-color: ${color}; size: 5; }`, 
                `${getBrand(r)}: Rank ${r.average_organic_rank}, Share ${r.click_share}%`
            ]);
        });

        const options = {
            hAxis: { title: 'Organic Rank (Lower is Better)', direction: -1 }, // Invertido
            vAxis: { title: 'Click Share' },
            legend: 'none',
            tooltip: { isHtml: true }
        };

        const chart = new google.visualization.ScatterChart(document.getElementById('chart_efficiency'));
        chart.draw(data, options);
    }

    // ---------------------------------------------------------
    // 4. INSIGHTS GENERATION & LEVERS ANALYSIS
    // ---------------------------------------------------------

    function generateTextInsights() {
        // A. Levers Analysis
        const dealWeeks = marketData.filter(r => r.weekly_number_of_days_with_deal > 0 && r.is_yaba_asin === 'Y');
        const normalWeeks = marketData.filter(r => r.weekly_number_of_days_with_deal === 0 && r.is_yaba_asin === 'Y');
        
        const avgShareDeal = dealWeeks.length ? dealWeeks.reduce((a,b)=>a+b.click_share,0)/dealWeeks.length : 0;
        const avgShareNoDeal = normalWeeks.length ? normalWeeks.reduce((a,b)=>a+b.click_share,0)/normalWeeks.length : 0;
        
        const dealImpact = avgShareNoDeal > 0 ? ((avgShareDeal - avgShareNoDeal)/avgShareNoDeal * 100).toFixed(0) : 0;
        
        const leversDiv = document.getElementById('levers_analysis');
        leversDiv.innerHTML = `
            <table class="custom-table">
                <tr><th>Palanca</th><th>Impacto Detectado</th><th>Estado</th></tr>
                <tr>
                    <td><strong>Deal Days</strong></td>
                    <td>${dealImpact > 0 ? '+' + dealImpact + '% Share vs días sin deal' : 'Sin datos suficientes'}</td>
                    <td>${dealImpact > 10 ? '<span class="badge badge-our">Alta Eficacia</span>' : '<span class="badge" style="background:#eee">Neutro</span>'}</td>
                </tr>
                <tr>
                    <td><strong>Competitividad Precio</strong></td>
                    <td>Análisis de correlación Precio/Share</td>
                    <td>Revisar gráfico Interactivo</td>
                </tr>
            </table>
        `;

        // B. Final Insights
        const list = document.getElementById('final_insights');
        const raw = aggregateByWeek();
        const trend = raw[raw.length-1].our_share_sum > raw[0].our_share_sum ? "positiva" : "negativa";
        
        let html = `
            <li><span class="material-icons insight-icon">trending_flat</span> <strong>Tendencia:</strong> La visibilidad de la marca tiene una tendencia global <b>${trend}</b> en las últimas 5 semanas.</li>
            <li><span class="material-icons insight-icon">local_offer</span> <strong>Promociones:</strong> Los Deals aumentan el share en un <b>${dealImpact}%</b>. Se recomienda aumentar la frecuencia en semanas clave.</li>
            <li><span class="material-icons insight-icon">emoji_events</span> <strong>Ranking:</strong> Existe una correlación directa entre Top 5 Orgánico y >10% Share. Los ASINs fuera del Top 10 son ineficientes.</li>
            <li><span class="material-icons insight-icon">warning</span> <strong>Amenaza:</strong> ${getTopCompetitors()[0] || 'Competidor'} mantiene una posición dominante estable.</li>
            <li><span class="material-icons insight-icon">build</span> <strong>Acción:</strong> Optimizar títulos y keywords en ASINs "underperformers" (Rank > 15).</li>
        `;
        list.innerHTML = html;
    }

    // ---------------------------------------------------------
    // 5. INTERACTIVE TAB LOGIC
    // ---------------------------------------------------------
    function switchTab(tabName) {
        document.getElementById('tab-static').classList.add('hidden');
        document.getElementById('tab-interactive').classList.add('hidden');
        
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        
        if(tabName === 'static') {
            document.getElementById('tab-static').classList.remove('hidden');
            document.querySelector('button[onclick="switchTab(\'static\')"]').classList.add('active');
        } else {
            document.getElementById('tab-interactive').classList.remove('hidden');
            document.querySelector('button[onclick="switchTab(\'interactive\')"]').classList.add('active');
            drawComparatorChart(); // Redraw to fix size issues
        }
    }

    function setupInteractiveTab() {
        // Populate Selectors
        const weeks = [...new Set(marketData.map(d => d.week_date))].sort();
        const comps = getTopCompetitors();
        
        const weekSel = document.getElementById('selectWeek');
        weeks.forEach(w => {
            let opt = document.createElement('option');
            opt.value = w;
            opt.innerText = w;
            weekSel.appendChild(opt);
        });
        weekSel.value = weeks[weeks.length-1]; // Select last

        const compSel = document.getElementById('selectCompetitor');
        comps.forEach(c => {
            let opt = document.createElement('option');
            opt.value = c;
            opt.innerText = c;
            compSel.appendChild(opt);
        });

        updateComparator();
    }

    function updateComparator() {
        const week = document.getElementById('selectWeek').value;
        const comp = document.getElementById('selectCompetitor').value;
        const container = document.getElementById('comparator_output');

        // Get Data
        const usData = marketData.filter(d => d.week_date === week && d.is_yaba_asin === 'Y');
        const compData = marketData.filter(d => d.week_date === week && getBrand(d) === comp);

        // Calculate Avgs
        const avg = (arr, field) => arr.length ? (arr.reduce((a,b)=>a+parseFloat(b[field]),0)/arr.length).toFixed(1) : '-';

        container.innerHTML = `
            <table class="custom-table" style="margin-top:10px;">
                <thead>
                    <tr>
                        <th>Métrica (${week})</th>
                        <th style="color:var(--primary-color)">${ourBrandName} (Nosotros)</th>
                        <th style="color:var(--danger-color)">${comp}</th>
                        <th>Delta</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Precio Promedio</td>
                        <td>$${avg(usData, 'price')}</td>
                        <td>$${avg(compData, 'price')}</td>
                        <td>${(avg(usData, 'price') - avg(compData, 'price')).toFixed(1)}</td>
                    </tr>
                    <tr>
                        <td>Avg Organic Rank</td>
                        <td>${avg(usData, 'average_organic_rank')}</td>
                        <td>${avg(compData, 'average_organic_rank')}</td>
                        <td>${(avg(usData, 'average_organic_rank') - avg(compData, 'average_organic_rank')).toFixed(1)}</td>
                    </tr>
                    <tr>
                        <td>Total Click Share</td>
                        <td>${usData.reduce((a,b)=>a+b.click_share,0).toFixed(1)}%</td>
                        <td>${compData.reduce((a,b)=>a+b.click_share,0).toFixed(1)}%</td>
                        <td><strong>${(usData.reduce((a,b)=>a+b.click_share,0) - compData.reduce((a,b)=>a+b.click_share,0)).toFixed(1)}%</strong></td>
                    </tr>
                </tbody>
            </table>
        `;
        
        drawComparatorChart(week, comp);
    }

    function drawComparatorChart(week, comp) {
        // Simple Bar Chart comparing Share
        if(!week) week = document.getElementById('selectWeek').value;
        if(!comp) comp = document.getElementById('selectCompetitor').value;

        const usShare = marketData.filter(d => d.week_date === week && d.is_yaba_asin === 'Y').reduce((a,b)=>a+b.click_share,0);
        const compShare = marketData.filter(d => d.week_date === week && getBrand(d) === comp).reduce((a,b)=>a+b.click_share,0);

        const data = google.visualization.arrayToDataTable([
            ['Entidad', 'Click Share', { role: 'style' }],
            ['Nosotros', usShare, '#4285F4'],
            [comp, compShare, '#EA4335']
        ]);

        const options = {
            title: `Comparativa Cuota de Mercado: ${week}`,
            legend: { position: 'none' },
            vAxis: { minValue: 0 }
        };

        const chart = new google.visualization.ColumnChart(document.getElementById('chart_comparison'));
        chart.draw(data, options);
    }

</script>

</body>
</html>